"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[694],{91694:(e,t,a)=>{a.r(t),a.d(t,{InvoiceForm:()=>X});var r=a(95155),s=a(85339),n=a(40646),l=a(69074),i=a(54861),o=a(49103),d=a(51154),u=a(17759),c=a(6711),m=a(40714),p=a(32944),g=a(9282),h=a(43163),f=a(55551),x=a(26681),v=a(7038),y=a(98449);function S(e,t){return Number(Math.round(Number(e+"e"+t))+"e-"+t)}var j=a(62177),b=a(12115),D=a(20547),N=a(59434);function w(e){let{...t}=e;return(0,r.jsx)(D.bL,{"data-slot":"popover",...t})}function I(e){let{...t}=e;return(0,r.jsx)(D.l9,{"data-slot":"popover-trigger",...t})}function F(e){let{className:t,align:a="center",sideOffset:s=4,...n}=e;return(0,r.jsx)(D.ZL,{children:(0,r.jsx)(D.UC,{"data-slot":"popover-content",align:a,sideOffset:s,className:(0,N.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})})}var A=a(59409),E=a(62713),P=a(83039),C=a(28738),M=a(23068),k=a(30285),V=a(42355),z=a(13052),T=a(42507);function _(e){var t,a;let{className:s,classNames:n,showOutsideDays:l=!0,locale:i,...o}=e;return(0,r.jsx)(T.h,{showOutsideDays:l,className:(0,N.cn)("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,N.cn)((0,k.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",month_grid:"w-full border-collapse space-y-1",weekdays:"flex",weekday:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",week:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,N.cn)((0,k.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...n},components:{Chevron:e=>{let{className:t,orientation:a,...s}=e;return"left"===a?(0,r.jsx)(V.A,{className:(0,N.cn)(t,"h-4 w-4"),...s}):(0,r.jsx)(z.A,{className:(0,N.cn)(t,"h-4 w-4"),...s})}},locale:i,weekStartsOn:null!=(a=null==i||null==(t=i.options)?void 0:t.weekStartsOn)?a:1,...o})}_.displayName="Calendar";var B=a(62523),J=a(4884);function O(e){let{className:t,...a}=e;return(0,r.jsx)(J.bL,{"data-slot":"switch",className:(0,N.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 cursor-pointer",t),...a,children:(0,r.jsx)(J.zi,{"data-slot":"switch-thumb",className:(0,N.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var q=a(45964),Y=a.n(q),G=a(91218),R=a(55594),L=a(90221);let U="yyyy-MM-dd",$="dd.MM.yyyy",W=[U,$,"MM/dd/yyyy","dd.MM.yy","MM/dd/yy","dd-MM-yyyy"],Q=e=>{if(!e)return null;let t=e.trim();if(!/[\.\-\/]/.test(t)||!/^(\d{4}-\d{2}-\d{2}|\d{2}\.\d{2}\.\d{4}|\d{2}\/\d{2}\/\d{4}|\d{2}-\d{2}-\d{4})$/.test(t))return null;for(let e of W){let a=(0,C.qg)(t,e,new Date);if((0,M.f)(a))return(0,c.o)(a)}return null},H=e=>R.z.object({startDateString:R.z.string().optional(),endDateString:R.z.string().optional(),includeEndDate:R.z.boolean(),splitPeriod:R.z.enum(["yearly","quarterly","monthly"]),amounts:R.z.array(R.z.object({value:R.z.string().min(1,{message:e("InvoiceForm.errorAmountValueRequired")}).refine(e=>!isNaN(parseFloat(e))&&parseFloat(e)>0,{message:e("InvoiceForm.errorAmountPositive")})})).min(1,e("InvoiceForm.errorAmountRequired"))}).refine(e=>!!Q(e.startDateString||""),{message:e("InvoiceForm.errorStartDateRequired"),path:["startDateString"]}).refine(e=>!!Q(e.endDateString||""),{message:e("InvoiceForm.errorEndDateRequired"),path:["endDateString"]}).refine(e=>{let t=Q(e.startDateString||""),a=Q(e.endDateString||"");return!t||!a||a>=t},{message:e("InvoiceForm.errorEndDateBeforeStart"),path:["endDateString"]}),Z=e=>{let{children:t,...a}=e;return(0,r.jsx)(u.lR,{...a,style:{color:"var(--foreground)",fontWeight:500},children:t})},K=e=>{let{className:t,...a}=e;return a.children&&"string"==typeof a.children&&a.children.length>0?(0,r.jsxs)(u.C5,{className:(0,N.cn)("pl-3 flex items-center","py-1 px-2 rounded text-destructive font-medium",t),...a,children:[(0,r.jsx)(s.A,{className:"h-3 w-3 mr-1 flex-shrink-0"}),(0,r.jsx)("span",{children:a.children})]}):null};function X(e){var t,a;let{onCalculateAction:D,demoData:C}=e,{t:M,i18n:V}=(0,G.Bd)(),[z,T]=(0,b.useState)(!1),[J,q]=(0,b.useState)(!1),[R,W]=(0,b.useState)(""),[X,ee]=(0,b.useState)(!1),et=V.language.startsWith("de")?E.de:P.c,ea=V.language.startsWith("de")?$:U,er=V.language.startsWith("de")?"z.B. 31.12.2023":"e.g. 2023-12-31",es="invoiceFormDataCache",en=H(M),el=(0,j.mN)({resolver:(0,L.u)(en),defaultValues:{startDateString:"",endDateString:"",includeEndDate:!0,splitPeriod:"yearly",amounts:[{value:""}]},mode:"onBlur"}),{fields:ei,append:eo,remove:ed}=(0,j.jz)({control:el.control,name:"amounts"}),eu=(0,b.useCallback)(e=>{q(!0),W(M("InvoiceForm.calculatingButton"));let t=Q(e.startDateString||""),a=Q(e.endDateString||"");if(!t||!a){D(null,null,M("Errors.unexpectedError")),q(!1),W(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"}));return}let r=e.amounts.map(e=>Number(e.value)),s=e.splitPeriod||"yearly",n={startDate:t,endDate:a,includeEndDate:e.includeEndDate,splitPeriod:s,amounts:r};D(n,null,void 0);let l={startDate:t,endDate:a,includeEndDate:e.includeEndDate,amounts:r,splitPeriod:s};try{let e=function(e){let t=e.splitPeriod||"yearly",a={totalDuration:{days:0,start:"",end:"",included:e.includeEndDate},periodSegments:[],amountCalculations:[]};if(!e.amounts||0===e.amounts.length)return{totalDays:0,originalTotalAmount:0,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...a,error:"At least one amount is required."},splitPeriodUsed:t};if(e.amounts.some(e=>isNaN(e)||null===e))return{totalDays:0,originalTotalAmount:0,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...a,error:"Invalid non-numeric amount provided."},splitPeriodUsed:t};let r=S(e.amounts.reduce((e,t)=>e+t,0),2),s=(0,c.o)(e.startDate),n=(0,c.o)(e.endDate);if(e.includeEndDate&&(n=(0,m.f)(n,1)),a.totalDuration.start=(0,x.GP)(s,"yyyy-MM-dd"),a.totalDuration.end=(0,x.GP)(e.includeEndDate?e.endDate:(0,m.f)(n,-1),"yyyy-MM-dd"),s>=n)return{totalDays:0,originalTotalAmount:r,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...a,error:"Start date must be before the effective end date."},splitPeriodUsed:t};let l=(0,y.c)(n,s);if(a.totalDuration.days=l,l<=0)return{totalDays:0,originalTotalAmount:r,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...a,error:"Calculated duration is zero or negative."},splitPeriodUsed:t};let i={},o=s;for(;o<n;){let e=function(e,t){let a=(0,f.C)(e);switch(t){case"monthly":return(0,x.GP)(e,"yyyy-MM");case"quarterly":let r=(0,v.F)(e);return"".concat(a,"-Q").concat(r);default:return a.toString()}}(o,t),a=function(e,t){switch(t){case"monthly":return(0,c.o)((0,m.f)((0,p.p)(e),1));case"quarterly":return(0,c.o)((0,m.f)((0,g.j)(e),1));default:return(0,c.o)((0,m.f)((0,h.Q)(e),1))}}(o,t),r=n<a?n:a,s=(0,y.c)(r,o);if(s>0){let t=s/l;i[e]||(i[e]={days:0,proportion:0}),i[e].days+=s,i[e].proportion+=t}o=r}a.periodSegments=Object.entries(i).map(e=>{let[t,a]=e;return{periodIdentifier:t,days:a.days,proportion:a.proportion}}).sort((e,t)=>e.periodIdentifier.localeCompare(t.periodIdentifier));let d=[];for(let t of e.amounts){let e={originalAmount:t,periodSplits:[],discrepancy:0,finalSum:0},r=[];for(let a in i){let s=t*i[a].proportion;r.push({periodIdentifier:a,rawSplit:s}),e.periodSplits.push({periodIdentifier:a,rawSplit:s,roundedSplit:0,adjustment:0})}let s=r.map(e=>({...e,roundedSplit:S(e.rawSplit,2)}));s.forEach(t=>{let a=e.periodSplits.find(e=>e.periodIdentifier===t.periodIdentifier);a&&(a.roundedSplit=t.roundedSplit)});let n=S(s.reduce((e,t)=>e+t.roundedSplit,0),2),l=S(t-n,2);if(e.discrepancy=l,0!==l&&s.length>0){let t=r.reduce((e,t)=>Math.abs(t.rawSplit)>Math.abs(e.rawSplit)?t:e).periodIdentifier,a=s.find(e=>e.periodIdentifier===t);if(a){a.roundedSplit=S(a.roundedSplit+l,2);let r=e.periodSplits.find(e=>e.periodIdentifier===t);r&&(r.roundedSplit=a.roundedSplit,r.adjustment=l),e.adjustmentAppliedToPeriod=t}else console.warn("Could not find period to apply adjustment, discrepancy unapplied for this amount.")}let o={};s.forEach(e=>{o[e.periodIdentifier]={splitAmount:e.roundedSplit}});let u=S(s.reduce((e,t)=>e+t.roundedSplit,0),2);e.finalSum=u,d.push({originalAmount:t,adjustedTotalAmount:u,splits:o}),a.amountCalculations.push(e)}let u=Object.entries(i).map(e=>{let[t,a]=e,r=0;return d.forEach(e=>{var a;r+=(null==(a=e.splits[t])?void 0:a.splitAmount)||0}),{periodIdentifier:t,daysInPeriod:a.days,proportion:a.proportion,totalSplitAmount:S(r,2)}}).sort((e,t)=>e.periodIdentifier.localeCompare(t.periodIdentifier)),j=S(u.reduce((e,t)=>e+t.totalSplitAmount,0),2),b=S(r-j,2);return Math.abs(b)>.01*e.amounts.length&&console.warn("Potential rounding discrepancy: Original ".concat(r,", Adjusted ").concat(j,", Diff ").concat(b)),{totalDays:l,originalTotalAmount:r,adjustedTotalAmount:j,resultsPerAmount:d,aggregatedSplits:u,calculationSteps:a,splitPeriodUsed:t}}(l);setTimeout(()=>{var t;(null==(t=e.calculationSteps)?void 0:t.error)?D(n,null,e.calculationSteps.error):e.aggregatedSplits&&0!==e.aggregatedSplits.length?(D(n,e),W(M("InvoiceForm.calculationComplete",{defaultValue:"Split completed successfully!"})),ee(!0),setTimeout(()=>{W(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"})),ee(!1)},2e3)):D(n,null,"Calculation completed but resulted in no splits."),q(!1)},300)}catch(e){D(n,null,e instanceof Error?e.message:"An unexpected error occurred during calculation."),setTimeout(()=>{q(!1),W(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"}))},300)}},[M,D,q,W,ee]);(0,b.useEffect)(()=>{if(z)return;let e=!1;if(C&&C.isDemo)try{let t={startDateString:C.startDateString?(0,x.GP)(Q(C.startDateString)||new Date,ea):void 0,endDateString:C.endDateString?(0,x.GP)(Q(C.endDateString)||new Date,ea):void 0,includeEndDate:void 0===C.includeEndDate||C.includeEndDate,splitPeriod:C.splitPeriod||"yearly",amounts:C.amount?[{value:C.amount}]:[{value:""}]},a={startDateString:t.startDateString||"",endDateString:t.endDateString||"",includeEndDate:void 0===t.includeEndDate||t.includeEndDate,splitPeriod:t.splitPeriod||"yearly",amounts:t.amounts||[{value:""}]};el.reset(a),sessionStorage.removeItem("billSplitterDemoData"),e=!0,el.trigger().then(e=>{e&&setTimeout(()=>{el.formState.isValid&&el.handleSubmit(eu)()},500)})}catch(e){console.error("Error processing demo data:",e)}else{let t=sessionStorage.getItem("billSplitterDemoData");if(t)try{let a=JSON.parse(t);if(a.isDemo){let t={startDateString:a.startDateString?(0,x.GP)(Q(a.startDateString)||new Date,ea):void 0,endDateString:a.endDateString?(0,x.GP)(Q(a.endDateString)||new Date,ea):void 0,includeEndDate:void 0===a.includeEndDate||a.includeEndDate,splitPeriod:a.splitPeriod||"yearly",amounts:a.amount?[{value:a.amount}]:[{value:""}]},r={startDateString:t.startDateString||"",endDateString:t.endDateString||"",includeEndDate:void 0===t.includeEndDate||t.includeEndDate,splitPeriod:t.splitPeriod||"yearly",amounts:t.amounts||[{value:""}]};el.reset(r),sessionStorage.removeItem("billSplitterDemoData"),e=!0,el.trigger().then(e=>{e&&setTimeout(()=>{el.formState.isValid&&el.handleSubmit(eu)()},500)})}}catch(e){console.error("Error parsing demo data from session storage:",e),sessionStorage.removeItem("billSplitterDemoData")}}if(!e){let e=sessionStorage.getItem(es);if(e)try{let t=JSON.parse(e);el.reset(t)}catch(e){console.error("Failed to parse cached form data:",e),sessionStorage.removeItem(es)}}T(!0),W(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"}))},[el,ea,eu,M,es,z,C]);let ec=(0,b.useMemo)(()=>Y()(e=>{if(z)try{sessionStorage.setItem(es,JSON.stringify(e))}catch(e){console.error("Failed to save form data to cache:",e)}},500),[z,es]),em=(0,j.FH)({control:el.control});(0,b.useEffect)(()=>{z&&ec(el.getValues())},[em,ec,el,z]);let[ep,eg]=(0,b.useState)(!1),[eh,ef]=(0,b.useState)(!1),ex=()=>V.language.startsWith("de")?M("InvoiceForm.supportedDateFormats",{defaultValue:"Unterst\xfctzte Formate: TT.MM.JJJJ, JJJJ-MM-TT"}):M("InvoiceForm.supportedDateFormats",{defaultValue:"Supported formats: YYYY-MM-DD, DD.MM.YYYY"}),ev=e=>{if(e){let t=(0,x.GP)(e,ea);el.setValue("startDateString",t,{shouldValidate:!0})}eg(!1)},ey=e=>{if(e){let t=(0,x.GP)(e,ea);el.setValue("endDateString",t,{shouldValidate:!0})}ef(!1)},eS=e=>{let t=e.target.value;el.setValue("startDateString",t,{shouldValidate:!0}),el.trigger("startDateString").then(()=>{let e=Q(t);t&&!e&&el.setError("startDateString",{type:"manual",message:ex()})})},ej=e=>{let t=e.target.value;el.setValue("endDateString",t,{shouldValidate:!1});let a=Q(t),r=Q(el.getValues("startDateString")||"");el.clearErrors("endDateString"),t&&!a?el.setError("endDateString",{type:"manual",message:ex()}):a&&r&&a<r&&el.setError("endDateString",{type:"manual",message:M("InvoiceForm.errorEndDateBeforeStart")}),el.trigger("endDateString")};return z?(0,r.jsx)(j.Op,{...el,children:(0,r.jsxs)("form",{onSubmit:el.handleSubmit(eu),className:(0,N.cn)("space-y-6",z&&"opacity-100 transition-opacity duration-500 ease-in-out",!z&&"opacity-0"),children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(u.zB,{control:el.control,name:"startDateString",render:e=>{var t,a;let{field:i}=e;return(0,r.jsxs)(u.eI,{className:"flex flex-col",children:[(0,r.jsx)(Z,{children:M("InvoiceForm.startDateLabel")}),(0,r.jsxs)(w,{open:ep,onOpenChange:eg,children:[(0,r.jsx)(u.MJ,{children:(0,r.jsxs)("div",{className:"w-full relative",children:[(0,r.jsx)(B.p,{value:i.value,onChange:e=>{i.onChange(e),eS(e)},onBlur:()=>el.trigger("startDateString"),placeholder:er,className:"w-full pr-10 ".concat(el.formState.errors.startDateString?"border-destructive focus:border-destructive focus:ring-2 focus:ring-destructive/20":""),autoFocus:!0}),i.value&&!el.formState.errors.startDateString&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-10 flex items-center",children:(0,r.jsx)(n.A,{className:"h-4 w-4 text-green-500"})}),el.formState.errors.startDateString&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-10 flex items-center",children:(0,r.jsx)(s.A,{className:"h-4 w-4 text-destructive"})}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,r.jsx)(I,{asChild:!0,children:(0,r.jsx)(k.$,{type:"button",variant:"ghost",className:"h-7 w-7 p-0","aria-label":"Pick a date",children:(0,r.jsx)(l.A,{className:"h-4 w-4 text-muted-foreground"})})})})]})}),(0,r.jsx)(F,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(_,{mode:"single",selected:Q(null!=(a=el.watch("startDateString"))?a:"")||void 0,onSelect:ev,initialFocus:!0,locale:et})})]}),(0,r.jsx)(K,{className:"text-xs mt-1",children:null==(t=el.formState.errors.startDateString)?void 0:t.message})]})}}),(0,r.jsx)(u.zB,{control:el.control,name:"endDateString",render:e=>{var t,a;let{field:i}=e;return(0,r.jsxs)(u.eI,{className:"flex flex-col",children:[(0,r.jsx)(Z,{children:M("InvoiceForm.endDateLabel")}),(0,r.jsxs)(w,{open:eh,onOpenChange:ef,children:[(0,r.jsx)(u.MJ,{children:(0,r.jsxs)("div",{className:"w-full relative",children:[(0,r.jsx)(B.p,{value:i.value,onChange:e=>{i.onChange(e),ej(e)},onBlur:()=>el.trigger("endDateString"),placeholder:er,className:"w-full pr-10 ".concat(el.formState.errors.endDateString?"border-destructive focus:border-destructive focus:ring-2 focus:ring-destructive/20":"")}),i.value&&!el.formState.errors.endDateString&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-10 flex items-center",children:(0,r.jsx)(n.A,{className:"h-4 w-4 text-green-500"})}),el.formState.errors.endDateString&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-10 flex items-center",children:(0,r.jsx)(s.A,{className:"h-4 w-4 text-destructive"})}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,r.jsx)(I,{asChild:!0,children:(0,r.jsx)(k.$,{type:"button",variant:"ghost",className:"h-7 w-7 p-0","aria-label":"Pick a date",children:(0,r.jsx)(l.A,{className:"h-4 w-4 text-muted-foreground"})})})})]})}),(0,r.jsx)(F,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(_,{mode:"single",selected:Q(null!=(a=el.watch("endDateString"))?a:"")||void 0,onSelect:ey,initialFocus:!0,locale:et,disabled:e=>{var t;let a=Q(null!=(t=el.watch("startDateString"))?t:"");return!!a&&e<a}})})]}),(0,r.jsx)(K,{className:"text-xs mt-1",children:null==(t=el.formState.errors.endDateString)?void 0:t.message})]})}})]}),(0,r.jsx)(u.zB,{control:el.control,name:"includeEndDate",render:e=>{let{field:t}=e;return(0,r.jsxs)(u.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(Z,{className:"text-base",children:M("InvoiceForm.includeEndDateLabel")}),(0,r.jsx)(u.Rr,{children:M("InvoiceForm.includeEndDateDescription")})]}),(0,r.jsx)(u.MJ,{children:(0,r.jsx)(O,{checked:t.value,onCheckedChange:t.onChange})})]})}}),(0,r.jsx)(u.zB,{control:el.control,name:"splitPeriod",render:e=>{let{field:t}=e;return(0,r.jsxs)(u.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"space-y-0.5 pr-4",children:[(0,r.jsx)(Z,{className:"text-base",children:M("InvoiceForm.splitPeriodLabel",{defaultValue:"Split Period"})}),(0,r.jsx)(u.Rr,{children:M("InvoiceForm.splitPeriodDescription",{defaultValue:"Choose how to split the invoice amounts."})})]}),(0,r.jsxs)("div",{className:"min-w-[120px]",children:[(0,r.jsxs)(A.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,r.jsx)(u.MJ,{children:(0,r.jsx)(A.bq,{className:"w-full",children:(0,r.jsx)(A.yv,{placeholder:M("InvoiceForm.selectPeriodPlaceholder",{defaultValue:"Select..."})})})}),(0,r.jsxs)(A.gC,{children:[(0,r.jsx)(A.eb,{value:"yearly",children:M("InvoiceForm.periodYearly",{defaultValue:"Yearly"})}),(0,r.jsx)(A.eb,{value:"quarterly",children:M("InvoiceForm.periodQuarterly",{defaultValue:"Quarterly"})}),(0,r.jsx)(A.eb,{value:"monthly",children:M("InvoiceForm.periodMonthly",{defaultValue:"Monthly"})})]})]}),(0,r.jsx)(K,{})]})]})}}),(0,r.jsxs)("div",{className:"space-y-5 rounded-lg border p-6 shadow-xs",children:[(0,r.jsx)(Z,{className:"text-base",children:M("InvoiceForm.amountsLabel")}),(0,r.jsx)(u.Rr,{children:M("InvoiceForm.amountsDescription")}),ei.map((e,t)=>(0,r.jsx)(u.zB,{control:el.control,name:"amounts.".concat(t,".value"),render:e=>{var a,l;let{field:o}=e;return(0,r.jsxs)(u.eI,{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)(Z,{className:"text-sm font-medium",children:["#",t+1]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(u.MJ,{children:(0,r.jsx)(B.p,{type:"number",step:"any",className:"focus:border-primary focus:ring-2 focus:ring-primary/20 transition-transform duration-150 pr-8",...o})}),(0,r.jsxs)("div",{className:"absolute right-2 top-0 h-full flex items-center justify-center",children:[o.value&&!isNaN(parseFloat(o.value))&&parseFloat(o.value)>0&&(0,r.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,r.jsx)(n.A,{className:"h-4 w-4 text-green-500"})}),(null==(l=el.formState.errors.amounts)||null==(a=l[t])?void 0:a.value)&&(0,r.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,r.jsx)(s.A,{className:"h-4 w-4 text-destructive"})})]})]}),ei.length>1&&(0,r.jsx)(k.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>ed(t),className:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 transition-all duration-200 shrink-0","aria-label":"Remove amount",children:(0,r.jsx)(i.A,{className:"h-4 w-4 transition-transform duration-150 hover:scale-95"})})]})]}),(0,r.jsx)(K,{})]})}},e.id)),(0,r.jsxs)(k.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{eo({value:""}),setTimeout(()=>{let e=document.querySelectorAll('input[type="number"]');e.length>0&&e[e.length-1].focus()},10)},className:"mt-4",children:[(0,r.jsx)(o.A,{className:"mr-2 h-4 w-4"})," ",M("InvoiceForm.addAmountButton")]}),el.formState.errors.amounts&&!el.formState.errors.amounts.root&&el.formState.errors.amounts.message&&(0,r.jsx)("p",{className:"text-sm font-medium text-destructive",children:el.formState.errors.amounts.message}),(null==(a=el.formState.errors.amounts)||null==(t=a.root)?void 0:t.message)&&(0,r.jsx)("p",{className:"text-sm font-medium text-destructive",children:el.formState.errors.amounts.root.message})]}),(0,r.jsx)(k.$,{type:"submit",disabled:el.formState.isSubmitting||J,className:"w-full bg-primary text-white hover:bg-primary/90 hover:scale-[1.02] px-6 py-2 h-11 font-medium rounded-md shadow-sm transition-all duration-200 hover:shadow-lg hover:shadow-primary/20 ".concat(X?"animate-success-glow":""),children:J?(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}),R]}):R})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-2/5"}),(0,r.jsx)("div",{className:"h-10 bg-muted/60 rounded-md animate-pulse w-full"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-2/5"}),(0,r.jsx)("div",{className:"h-10 bg-muted/60 rounded-md animate-pulse w-full"})]})]}),(0,r.jsxs)("div",{className:"h-20 bg-muted/40 rounded-lg animate-pulse border border-muted/30 p-4 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-40"}),(0,r.jsx)("div",{className:"h-3 bg-muted/60 rounded-sm animate-pulse w-56"})]}),(0,r.jsx)("div",{className:"h-6 w-12 bg-muted/60 rounded-full animate-pulse"})]}),(0,r.jsxs)("div",{className:"h-20 bg-muted/40 rounded-lg animate-pulse border border-muted/30 p-4 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-32"}),(0,r.jsx)("div",{className:"h-3 bg-muted/60 rounded-sm animate-pulse w-64"})]}),(0,r.jsx)("div",{className:"h-10 w-28 bg-muted/60 rounded-md animate-pulse"})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-muted/30 p-6 shadow-xs space-y-4 bg-muted/10",children:[(0,r.jsx)("div",{className:"h-5 bg-muted/60 rounded-sm animate-pulse w-1/4"}),(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-3/5 mb-4"}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-3 bg-muted/60 rounded-sm animate-pulse w-8"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("div",{className:"h-10 bg-muted/60 rounded-md animate-pulse flex-grow"}),(0,r.jsx)("div",{className:"h-10 w-10 bg-muted/60 rounded-md animate-pulse opacity-0"})]})]})}),(0,r.jsx)("div",{className:"h-8 bg-muted/60 rounded-md animate-pulse w-40 mt-6"})]}),(0,r.jsx)("div",{className:"h-11 bg-primary/40 rounded-md animate-pulse w-full"})]})}}}]);