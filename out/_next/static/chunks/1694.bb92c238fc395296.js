"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1694],{91694:(e,t,a)=>{a.r(t),a.d(t,{InvoiceForm:()=>Z});var r=a(95155),s=a(40646),n=a(85339),o=a(69074),l=a(54861),i=a(49103),d=a(51154),c=a(6711),u=a(40714),m=a(32944),p=a(9282),g=a(43163),h=a(55551),f=a(26681),v=a(7038),x=a(98449);function y(e,t){return Number(Math.round(Number(e+"e"+t))+"e-"+t)}var S=a(17759),j=a(62177),b=a(20547),D=a(12115),N=a(59434);function w(e){let{...t}=e;return(0,r.jsx)(b.bL,{"data-slot":"popover",...t})}function I(e){let{...t}=e;return(0,r.jsx)(b.l9,{"data-slot":"popover-trigger",...t})}function F(e){let{className:t,align:a="center",sideOffset:s=4,...n}=e,[o,l]=D.useState(!1),i=D.useRef(!0);return(D.useEffect(()=>{i.current=!0;let e=setTimeout(()=>{i.current&&l(!0)},10);return()=>{i.current=!1,clearTimeout(e),l(!1),"undefined"!=typeof document&&setTimeout(()=>{document.querySelectorAll("[data-radix-popover-content]").forEach(e=>{try{e&&e.parentNode&&e.parentNode.removeChild(e)}catch(e){}})},0)}},[]),o)?(0,r.jsx)(b.ZL,{children:(0,r.jsx)(b.UC,{"data-slot":"popover-content",align:a,sideOffset:s,className:(0,N.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})}):null}var C=a(59409),A=a(62713),E=a(83039),P=a(28738),M=a(23068),z=a(30285),k=a(42355),V=a(13052),T=a(42507);function _(e){var t,a;let{className:s,classNames:n,showOutsideDays:o=!0,locale:l,...i}=e;return(0,r.jsx)(T.h,{showOutsideDays:o,className:(0,N.cn)("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,N.cn)((0,z.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",month_grid:"w-full border-collapse space-y-1",weekdays:"flex",weekday:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",week:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,N.cn)((0,z.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...n},components:{Chevron:e=>{let{className:t,orientation:a,...s}=e;return"left"===a?(0,r.jsx)(k.A,{className:(0,N.cn)(t,"h-4 w-4"),...s}):(0,r.jsx)(V.A,{className:(0,N.cn)(t,"h-4 w-4"),...s})}},locale:l,weekStartsOn:null!=(a=null==l||null==(t=l.options)?void 0:t.weekStartsOn)?a:1,...i})}_.displayName="Calendar";var B=a(62523),R=a(4884);function J(e){let{className:t,...a}=e;return(0,r.jsx)(R.bL,{"data-slot":"switch",className:(0,N.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 cursor-pointer",t),...a,children:(0,r.jsx)(R.zi,{"data-slot":"switch-thumb",className:(0,N.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var q=a(45964),O=a.n(q),L=a(16781),U=a(55594),Y=a(90221);let G="yyyy-MM-dd",$="dd.MM.yyyy",Q=[G,$,"MM/dd/yyyy","dd.MM.yy","MM/dd/yy","dd-MM-yyyy"],W=e=>{if(!e)return null;let t=e.trim();if(!/[\.\-\/]/.test(t)||!/^(\d{4}-\d{2}-\d{2}|\d{2}\.\d{2}\.\d{4}|\d{2}\/\d{2}\/\d{4}|\d{2}-\d{2}-\d{4})$/.test(t))return null;for(let e of Q){let a=(0,P.qg)(t,e,new Date);if((0,M.f)(a))return(0,c.o)(a)}return null},H=e=>U.z.object({startDateString:U.z.string().optional(),endDateString:U.z.string().optional(),includeEndDate:U.z.boolean(),splitPeriod:U.z.enum(["yearly","quarterly","monthly"]),amounts:U.z.array(U.z.object({value:U.z.string().min(1,{message:e("InvoiceForm.errorAmountValueRequired")}).refine(e=>!isNaN(parseFloat(e))&&parseFloat(e)>0,{message:e("InvoiceForm.errorAmountPositive")})})).min(1,e("InvoiceForm.errorAmountRequired"))}).refine(e=>!!W(e.startDateString||""),{message:e("InvoiceForm.errorStartDateRequired"),path:["startDateString"]}).refine(e=>!!W(e.endDateString||""),{message:e("InvoiceForm.errorEndDateRequired"),path:["endDateString"]}).refine(e=>{let t=W(e.startDateString||""),a=W(e.endDateString||"");return!t||!a||a>=t},{message:e("InvoiceForm.errorEndDateBeforeStart"),path:["endDateString"]});function Z(e){var t,a;let{onCalculateAction:b,demoData:P}=e,{t:M,i18n:k}=(0,L.Bd)(),[V,T]=(0,D.useState)(!1),[R,q]=(0,D.useState)(!1),[U,Q]=(0,D.useState)(""),[Z,K]=(0,D.useState)(!1),[X,ee]=(0,D.useState)(!1),et=k.language.startsWith("de")?A.de:E.c,ea=k.language.startsWith("de")?$:G,er=k.language.startsWith("de")?"z.B. 31.12.2023":"e.g. 2023-12-31",es="invoiceFormDataCache",en=H(M),eo=(0,j.mN)({resolver:(0,Y.u)(en),defaultValues:{startDateString:"",endDateString:"",includeEndDate:!0,splitPeriod:"yearly",amounts:[{value:""}]},mode:"onBlur"}),{fields:el,append:ei,remove:ed}=(0,j.jz)({control:eo.control,name:"amounts"}),ec=(0,D.useCallback)(e=>{q(!0),Q(M("InvoiceForm.calculatingButton"));let t=W(e.startDateString||""),a=W(e.endDateString||"");if(!t||!a){b(null,null,M("Errors.unexpectedError")),q(!1),Q(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"}));return}let r=e.amounts.map(e=>Number(e.value)),s=e.splitPeriod||"yearly",n={startDate:t,endDate:a,includeEndDate:e.includeEndDate,splitPeriod:s,amounts:r};b(n,null,void 0);let o={startDate:t,endDate:a,includeEndDate:e.includeEndDate,amounts:r,splitPeriod:s};try{let e=function(e){let t=e.splitPeriod||"yearly",a={totalDuration:{days:0,start:"",end:"",included:e.includeEndDate},periodSegments:[],amountCalculations:[]};if(!e.amounts||0===e.amounts.length)return{totalDays:0,originalTotalAmount:0,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...a,error:"At least one amount is required."},splitPeriodUsed:t};if(e.amounts.some(e=>isNaN(e)||null===e))return{totalDays:0,originalTotalAmount:0,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...a,error:"Invalid non-numeric amount provided."},splitPeriodUsed:t};let r=y(e.amounts.reduce((e,t)=>e+t,0),2),s=(0,c.o)(e.startDate),n=(0,c.o)(e.endDate);if(e.includeEndDate&&(n=(0,u.f)(n,1)),a.totalDuration.start=(0,f.GP)(s,"yyyy-MM-dd"),a.totalDuration.end=(0,f.GP)(e.includeEndDate?e.endDate:(0,u.f)(n,-1),"yyyy-MM-dd"),s>=n)return{totalDays:0,originalTotalAmount:r,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...a,error:"Start date must be before the effective end date."},splitPeriodUsed:t};let o=(0,x.c)(n,s);if(a.totalDuration.days=o,o<=0)return{totalDays:0,originalTotalAmount:r,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...a,error:"Calculated duration is zero or negative."},splitPeriodUsed:t};let l={},i=s;for(;i<n;){let e=function(e,t){let a=(0,h.C)(e);switch(t){case"monthly":return(0,f.GP)(e,"yyyy-MM");case"quarterly":let r=(0,v.F)(e);return"".concat(a,"-Q").concat(r);default:return a.toString()}}(i,t),a=function(e,t){switch(t){case"monthly":return(0,c.o)((0,u.f)((0,m.p)(e),1));case"quarterly":return(0,c.o)((0,u.f)((0,p.j)(e),1));default:return(0,c.o)((0,u.f)((0,g.Q)(e),1))}}(i,t),r=n<a?n:a,s=(0,x.c)(r,i);if(s>0){let t=s/o;l[e]||(l[e]={days:0,proportion:0}),l[e].days+=s,l[e].proportion+=t}i=r}a.periodSegments=Object.entries(l).map(e=>{let[t,a]=e;return{periodIdentifier:t,days:a.days,proportion:a.proportion}}).sort((e,t)=>e.periodIdentifier.localeCompare(t.periodIdentifier));let d=[];for(let t of e.amounts){let e={originalAmount:t,periodSplits:[],discrepancy:0,finalSum:0},r=[];for(let a in l){let s=t*l[a].proportion;r.push({periodIdentifier:a,rawSplit:s}),e.periodSplits.push({periodIdentifier:a,rawSplit:s,roundedSplit:0,adjustment:0})}let s=r.map(e=>({...e,roundedSplit:y(e.rawSplit,2)}));s.forEach(t=>{let a=e.periodSplits.find(e=>e.periodIdentifier===t.periodIdentifier);a&&(a.roundedSplit=t.roundedSplit)});let n=y(s.reduce((e,t)=>e+t.roundedSplit,0),2),o=y(t-n,2);if(e.discrepancy=o,0!==o&&s.length>0){let t=r.reduce((e,t)=>Math.abs(t.rawSplit)>Math.abs(e.rawSplit)?t:e).periodIdentifier,a=s.find(e=>e.periodIdentifier===t);if(a){a.roundedSplit=y(a.roundedSplit+o,2);let r=e.periodSplits.find(e=>e.periodIdentifier===t);r&&(r.roundedSplit=a.roundedSplit,r.adjustment=o),e.adjustmentAppliedToPeriod=t}else console.warn("Could not find period to apply adjustment, discrepancy unapplied for this amount.")}let i={};s.forEach(e=>{i[e.periodIdentifier]={splitAmount:e.roundedSplit}});let c=y(s.reduce((e,t)=>e+t.roundedSplit,0),2);e.finalSum=c,d.push({originalAmount:t,adjustedTotalAmount:c,splits:i}),a.amountCalculations.push(e)}let S=Object.entries(l).map(e=>{let[t,a]=e,r=0;return d.forEach(e=>{var a;r+=(null==(a=e.splits[t])?void 0:a.splitAmount)||0}),{periodIdentifier:t,daysInPeriod:a.days,proportion:a.proportion,totalSplitAmount:y(r,2)}}).sort((e,t)=>e.periodIdentifier.localeCompare(t.periodIdentifier)),j=y(S.reduce((e,t)=>e+t.totalSplitAmount,0),2),b=y(r-j,2);return Math.abs(b)>.01*e.amounts.length&&console.warn("Potential rounding discrepancy: Original ".concat(r,", Adjusted ").concat(j,", Diff ").concat(b)),{totalDays:o,originalTotalAmount:r,adjustedTotalAmount:j,resultsPerAmount:d,aggregatedSplits:S,calculationSteps:a,splitPeriodUsed:t}}(o);setTimeout(()=>{var t;(null==(t=e.calculationSteps)?void 0:t.error)?b(n,null,e.calculationSteps.error):e.aggregatedSplits&&0!==e.aggregatedSplits.length?(b(n,e),Q(M("InvoiceForm.calculationComplete",{defaultValue:"Split completed successfully!"})),K(!0),setTimeout(()=>{Q(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"})),K(!1)},2e3)):b(n,null,"Calculation completed but resulted in no splits."),q(!1)},300)}catch(t){let e;b(n,null,t instanceof Error||"string"==typeof t||t&&"object"==typeof t?t:M("Errors.unexpectedError")),setTimeout(()=>{q(!1),Q(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"}))},300)}},[M,b,q,Q,K]);(0,D.useEffect)(()=>{if(V)return void Q(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"}));console.log("[InvoiceForm] Initializing form data...");let e=!1,t=!1;if(P&&P.isDemo){console.log("[InvoiceForm] Applying demo data from prop:",P);try{let a={startDateString:P.startDateString?(0,f.GP)(W(P.startDateString)||new Date,ea):void 0,endDateString:P.endDateString?(0,f.GP)(W(P.endDateString)||new Date,ea):void 0,includeEndDate:void 0===P.includeEndDate||P.includeEndDate,splitPeriod:P.splitPeriod||"yearly",amounts:P.amount?[{value:P.amount}]:[{value:""}]};eo.reset(a),e=!0,t=!0,sessionStorage.removeItem("billSplitterDemoData"),console.log("[InvoiceForm] Cleared billSplitterDemoData from sessionStorage after processing from prop.")}catch(e){console.error("[InvoiceForm] Error processing demoData prop:",e),sessionStorage.removeItem("billSplitterDemoData")}}let a="true"===new URLSearchParams(window.location.search).get("clean");if(a&&(console.log("[InvoiceForm] Detected clean=true URL param. Clearing cached form data."),sessionStorage.removeItem(es)),!e&&!a){let t=sessionStorage.getItem(es);if(t){console.log("[InvoiceForm] Applying cached form data from 'invoiceFormDataCache':",t);try{let a=JSON.parse(t);a.amounts&&0!==a.amounts.length||(a.amounts=[{value:""}]),eo.reset(a),e=!0}catch(e){console.error("[InvoiceForm] Error parsing cached form data from 'invoiceFormDataCache':",e),sessionStorage.removeItem(es)}}}e||(console.log("[InvoiceForm] No data loaded (no demo prop, no cache, or cache was cleared/invalid). Using default empty form."),eo.reset({startDateString:"",endDateString:"",includeEndDate:!0,splitPeriod:"yearly",amounts:[{value:""}]})),ee(!a),Q(M("InvoiceForm.calculateButton",{defaultValue:"Calculate Split"})),t&&(console.log("[InvoiceForm] Scheduling auto-submit for demo data from prop."),setTimeout(()=>{eo.trigger().then(e=>{e?(console.log("[InvoiceForm] Auto-submitting form with demo data from prop."),eo.handleSubmit(ec)()):(console.warn("[InvoiceForm] Auto-submit for demo data from prop skipped due to form validation errors."),sessionStorage.removeItem("billSplitterDemoData"),console.log("[InvoiceForm] Ensured billSplitterDemoData is cleared after failed auto-submit validation."))})},150)),T(!0),console.log("[InvoiceForm] Initial setup complete. Mounted: true, Caching enabled: "+!a)},[P,eo,M,ea,ec,es,V]);let eu=(0,D.useMemo)(()=>O()(e=>{if(V&&X)try{console.log("[InvoiceForm] Saving form data to cache:",e),sessionStorage.setItem(es,JSON.stringify(e))}catch(e){console.error("Failed to save form data to cache:",e)}},500),[V,es,X]),em=(0,j.FH)({control:eo.control});(0,D.useEffect)(()=>{V&&eu(eo.getValues())},[em,eu,eo,V]),(0,D.useEffect)(()=>()=>{eu.cancel(),eg(!1),ef(!1),document.querySelectorAll('[role="dialog"]').forEach(e=>{try{e&&e.parentNode&&e.parentNode.removeChild(e)}catch(e){console.warn("[InvoiceForm] Error cleaning up calendar element:",e)}}),console.log("[InvoiceForm] Component unmounting, cancelled pending operations and closed popovers")},[eu]);let[ep,eg]=(0,D.useState)(!1),[eh,ef]=(0,D.useState)(!1),ev=()=>k.language.startsWith("de")?M("InvoiceForm.supportedDateFormats",{defaultValue:"Unterst\xfctzte Formate: TT.MM.JJJJ, JJJJ-MM-TT"}):M("InvoiceForm.supportedDateFormats",{defaultValue:"Supported formats: YYYY-MM-DD, DD.MM.YYYY"}),ex=e=>{if(e){let t=(0,f.GP)(e,ea);eo.setValue("startDateString",t,{shouldValidate:!0})}eg(!1)},ey=e=>{if(e){let t=(0,f.GP)(e,ea);eo.setValue("endDateString",t,{shouldValidate:!0})}ef(!1)},eS=e=>{let t=e.target.value;eo.setValue("startDateString",t,{shouldValidate:!0}),eo.trigger("startDateString").then(()=>{let e=W(t);t&&!e&&eo.setError("startDateString",{type:"manual",message:ev()})})},ej=e=>{let t=e.target.value;eo.setValue("endDateString",t,{shouldValidate:!1});let a=W(t),r=W(eo.getValues("startDateString")||"");eo.clearErrors("endDateString"),t&&!a?eo.setError("endDateString",{type:"manual",message:ev()}):a&&r&&a<r&&eo.setError("endDateString",{type:"manual",message:M("InvoiceForm.errorEndDateBeforeStart")}),eo.trigger("endDateString")};return V?(0,r.jsx)(j.Op,{...eo,children:(0,r.jsxs)("form",{onSubmit:eo.handleSubmit(ec),className:(0,N.cn)("space-y-6",V&&"opacity-100 transition-opacity duration-500 ease-in-out",!V&&"opacity-0"),children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(S.zB,{control:eo.control,name:"startDateString",render:e=>{var t,a;let{field:l}=e;return(0,r.jsxs)(S.eI,{className:"flex flex-col",children:[(0,r.jsx)(S.lR,{htmlFor:"startDateString",children:M("InvoiceForm.startDateLabel")}),(0,r.jsxs)(w,{open:ep,onOpenChange:eg,children:[(0,r.jsx)(S.MJ,{children:(0,r.jsxs)("div",{className:"w-full relative",children:[(0,r.jsx)(B.p,{value:l.value,onChange:e=>{l.onChange(e),eS(e)},onBlur:()=>eo.trigger("startDateString"),placeholder:er,className:"w-full pr-10 ".concat(eo.formState.errors.startDateString?"border-destructive focus:border-destructive focus:ring-2 focus:ring-destructive/20":""),autoFocus:!0,id:"startDateString",name:"startDateString"}),l.value&&!eo.formState.errors.startDateString&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-10 flex items-center z-[1]",children:(0,r.jsx)(s.A,{className:"h-4 w-4 text-green-500"})}),eo.formState.errors.startDateString&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-10 flex items-center z-[1]",children:(0,r.jsx)(n.A,{className:"h-4 w-4 text-destructive"})}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center z-[1]",children:(0,r.jsx)(I,{asChild:!0,children:(0,r.jsx)(z.$,{type:"button",variant:"ghost",className:"h-7 w-7 p-0","aria-label":"Pick a date",children:(0,r.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})})})})]})}),(0,r.jsx)(F,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(_,{mode:"single",selected:W(null!=(a=eo.watch("startDateString"))?a:"")||void 0,onSelect:ex,initialFocus:!0,locale:et})})]}),(0,r.jsx)(S.C5,{className:"text-xs mt-1",children:null==(t=eo.formState.errors.startDateString)?void 0:t.message})]})}}),(0,r.jsx)(S.zB,{control:eo.control,name:"endDateString",render:e=>{var t,a;let{field:l}=e;return(0,r.jsxs)(S.eI,{className:"flex flex-col",children:[(0,r.jsx)(S.lR,{htmlFor:"endDateString",children:M("InvoiceForm.endDateLabel")}),(0,r.jsxs)(w,{open:eh,onOpenChange:ef,children:[(0,r.jsx)(S.MJ,{children:(0,r.jsxs)("div",{className:"w-full relative",children:[(0,r.jsx)(B.p,{value:l.value,onChange:e=>{l.onChange(e),ej(e)},onBlur:()=>eo.trigger("endDateString"),placeholder:er,className:"w-full pr-10 ".concat(eo.formState.errors.endDateString?"border-destructive focus:border-destructive focus:ring-2 focus:ring-destructive/20":""),id:"endDateString",name:"endDateString"}),l.value&&!eo.formState.errors.endDateString&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-10 flex items-center z-[1]",children:(0,r.jsx)(s.A,{className:"h-4 w-4 text-green-500"})}),eo.formState.errors.endDateString&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-10 flex items-center z-[1]",children:(0,r.jsx)(n.A,{className:"h-4 w-4 text-destructive"})}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center z-[1]",children:(0,r.jsx)(I,{asChild:!0,children:(0,r.jsx)(z.$,{type:"button",variant:"ghost",className:"h-7 w-7 p-0","aria-label":"Pick a date",children:(0,r.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})})})})]})}),(0,r.jsx)(F,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(_,{mode:"single",selected:W(null!=(a=eo.watch("endDateString"))?a:"")||void 0,onSelect:ey,initialFocus:!0,locale:et,disabled:e=>{var t;let a=W(null!=(t=eo.watch("startDateString"))?t:"");return!!a&&e<a}})})]}),(0,r.jsx)(S.C5,{className:"text-xs mt-1",children:null==(t=eo.formState.errors.endDateString)?void 0:t.message})]})}})]}),(0,r.jsx)(S.zB,{control:eo.control,name:"includeEndDate",render:e=>{let{field:t}=e;return(0,r.jsxs)(S.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(S.lR,{htmlFor:"includeEndDate",className:"text-base",children:M("InvoiceForm.includeEndDateLabel")}),(0,r.jsx)(S.Rr,{children:M("InvoiceForm.includeEndDateDescription")})]}),(0,r.jsx)(S.MJ,{children:(0,r.jsx)(J,{checked:t.value,onCheckedChange:t.onChange,id:"includeEndDate",name:"includeEndDate"})})]})}}),(0,r.jsx)(S.zB,{control:eo.control,name:"splitPeriod",render:e=>{let{field:t}=e;return(0,r.jsxs)(S.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"space-y-0.5 pr-4",children:[(0,r.jsx)(S.lR,{htmlFor:"splitPeriod",className:"text-base",children:M("InvoiceForm.splitPeriodLabel",{defaultValue:"Split Period"})}),(0,r.jsx)(S.Rr,{children:M("InvoiceForm.splitPeriodDescription",{defaultValue:"Choose how to split the invoice amounts."})})]}),(0,r.jsxs)("div",{className:"min-w-[120px]",children:[(0,r.jsxs)(C.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,r.jsx)(S.MJ,{children:(0,r.jsx)(C.bq,{className:"w-full",id:"splitPeriod",name:"splitPeriod",children:(0,r.jsx)(C.yv,{placeholder:M("InvoiceForm.selectPeriodPlaceholder",{defaultValue:"Select..."})})})}),(0,r.jsxs)(C.gC,{children:[(0,r.jsx)(C.eb,{value:"yearly",children:M("InvoiceForm.periodYearly",{defaultValue:"Yearly"})}),(0,r.jsx)(C.eb,{value:"quarterly",children:M("InvoiceForm.periodQuarterly",{defaultValue:"Quarterly"})}),(0,r.jsx)(C.eb,{value:"monthly",children:M("InvoiceForm.periodMonthly",{defaultValue:"Monthly"})})]})]}),(0,r.jsx)(S.C5,{})]})]})}}),(0,r.jsxs)("div",{className:"space-y-5 rounded-lg border p-6 shadow-xs",children:[(0,r.jsx)(S.lR,{className:"text-base",children:M("InvoiceForm.amountsLabel")}),(0,r.jsx)(S.Rr,{children:M("InvoiceForm.amountsDescription")}),el.map((e,t)=>(0,r.jsx)(S.zB,{control:eo.control,name:"amounts.".concat(t,".value"),render:e=>{var a,o;let{field:i}=e;return(0,r.jsxs)(S.eI,{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)(S.lR,{htmlFor:"amount-".concat(t),className:"text-sm font-medium",children:["#",t+1]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(S.MJ,{children:(0,r.jsx)(B.p,{type:"number",step:"any",className:"focus:border-primary focus:ring-2 focus:ring-primary/20 transition-transform duration-150 pr-8",...i,id:"amount-".concat(t),name:"amounts.".concat(t,".value")})}),(0,r.jsxs)("div",{className:"absolute right-2 top-0 h-full flex items-center justify-center z-[1]",children:[i.value&&!isNaN(parseFloat(i.value))&&parseFloat(i.value)>0&&(0,r.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,r.jsx)(s.A,{className:"h-4 w-4 text-green-500"})}),(null==(o=eo.formState.errors.amounts)||null==(a=o[t])?void 0:a.value)&&(0,r.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,r.jsx)(n.A,{className:"h-4 w-4 text-destructive"})})]})]}),el.length>1&&(0,r.jsx)(z.$,{type:"button",variant:"ghost",size:"icon",onClick:()=>ed(t),className:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 transition-all duration-200 shrink-0","aria-label":"Remove amount",children:(0,r.jsx)(l.A,{className:"h-4 w-4 transition-transform duration-150 hover:scale-95"})})]})]}),(0,r.jsx)(S.C5,{})]})}},e.id)),(0,r.jsxs)(z.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{ei({value:""}),setTimeout(()=>{let e=document.querySelectorAll('input[type="number"]');e.length>0&&e[e.length-1].focus()},10)},className:"mt-4",children:[(0,r.jsx)(i.A,{className:"mr-2 h-4 w-4"})," ",M("InvoiceForm.addAmountButton")]}),eo.formState.errors.amounts&&!eo.formState.errors.amounts.root&&eo.formState.errors.amounts.message&&(0,r.jsx)("p",{className:"text-sm font-medium text-destructive",children:eo.formState.errors.amounts.message}),(null==(a=eo.formState.errors.amounts)||null==(t=a.root)?void 0:t.message)&&(0,r.jsx)("p",{className:"text-sm font-medium text-destructive",children:eo.formState.errors.amounts.root.message})]}),(0,r.jsx)(z.$,{type:"submit",disabled:eo.formState.isSubmitting||R,className:"w-full bg-primary text-white hover:bg-primary/90 hover:scale-[1.02] px-6 py-2 h-11 font-medium rounded-md shadow-sm transition-all duration-200 hover:shadow-lg hover:shadow-primary/20 ".concat(Z?"animate-success-glow":""),children:R?(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}),U]}):U})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-2/5"}),(0,r.jsx)("div",{className:"h-10 bg-muted/60 rounded-md animate-pulse w-full"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-2/5"}),(0,r.jsx)("div",{className:"h-10 bg-muted/60 rounded-md animate-pulse w-full"})]})]}),(0,r.jsxs)("div",{className:"h-20 bg-muted/40 rounded-lg animate-pulse border border-muted/30 p-4 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-40"}),(0,r.jsx)("div",{className:"h-3 bg-muted/60 rounded-sm animate-pulse w-56"})]}),(0,r.jsx)("div",{className:"h-6 w-12 bg-muted/60 rounded-full animate-pulse"})]}),(0,r.jsxs)("div",{className:"h-20 bg-muted/40 rounded-lg animate-pulse border border-muted/30 p-4 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-32"}),(0,r.jsx)("div",{className:"h-3 bg-muted/60 rounded-sm animate-pulse w-64"})]}),(0,r.jsx)("div",{className:"h-10 w-28 bg-muted/60 rounded-md animate-pulse"})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-muted/30 p-6 shadow-xs space-y-4 bg-muted/10",children:[(0,r.jsx)("div",{className:"h-5 bg-muted/60 rounded-sm animate-pulse w-1/4"}),(0,r.jsx)("div",{className:"h-4 bg-muted/60 rounded-sm animate-pulse w-3/5 mb-4"}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-3 bg-muted/60 rounded-sm animate-pulse w-8"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("div",{className:"h-10 bg-muted/60 rounded-md animate-pulse flex-grow"}),(0,r.jsx)("div",{className:"h-10 w-10 bg-muted/60 rounded-md animate-pulse opacity-0"})]})]})}),(0,r.jsx)("div",{className:"h-8 bg-muted/60 rounded-md animate-pulse w-40 mt-6"})]}),(0,r.jsx)("div",{className:"h-11 bg-primary/40 rounded-md animate-pulse w-full"})]})}}}]);
//# sourceMappingURL=1694.bb92c238fc395296.js.map