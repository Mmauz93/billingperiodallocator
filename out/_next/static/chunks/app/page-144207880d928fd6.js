(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{424:(e,t,a)=>{"use strict";a.d(t,{SettingsProvider:()=>i,t:()=>o});var s=a(95155),r=a(12115);let l={decimalPlaces:2,roundingPrecision:.01,thousandsSeparator:"comma-period"},n=(0,r.createContext)(void 0),i=e=>{let{children:t}=e,[a,i]=(0,r.useState)(()=>{let e=localStorage.getItem("appSettings"),t=e?JSON.parse(e):{};return"locale"in t&&delete t.locale,{...l,...t}}),[o,d]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!o){try{let e=localStorage.getItem("appSettings");if(e){let t=JSON.parse(e);"locale"in t&&delete t.locale,"number"==typeof t.decimalPlaces&&"number"==typeof t.roundingPrecision&&t.roundingPrecision>0&&("comma-period"===t.thousandsSeparator||"apostrophe"===t.thousandsSeparator)?i(e=>({...l,...e,...t})):(console.warn("Loaded settings from localStorage are invalid or incomplete (excluding locale). Using defaults."),i(l),localStorage.removeItem("appSettings"))}else i(l)}catch(e){console.error("Failed to load settings from localStorage:",e),i(l)}d(!0)}},[o]),(0,s.jsx)(n.Provider,{value:{settings:a,saveSettings:e=>{try{let t={...void 0!==e.decimalPlaces&&{decimalPlaces:e.decimalPlaces},...void 0!==e.roundingPrecision&&{roundingPrecision:e.roundingPrecision},...void 0!==e.thousandsSeparator&&{thousandsSeparator:e.thousandsSeparator}},s={...a,...t};i(s),localStorage.setItem("appSettings",JSON.stringify(s))}catch(e){console.error("Failed to save settings to localStorage:",e)}}},children:t})},o=()=>{let e=(0,r.useContext)(n);if(!e)throw Error("useSettings must be used within a SettingsProvider");return e}},32383:()=>{},46102:(e,t,a)=>{"use strict";a.d(t,{TooltipProvider:()=>n,ZI:()=>d,k$:()=>o,m_:()=>i});var s=a(95155);a(12115);var r=a(83921),l=a(59434);function n(e){let{delayDuration:t=0,...a}=e;return(0,s.jsx)(r.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...a})}function i(e){let{...t}=e;return(0,s.jsx)(n,{children:(0,s.jsx)(r.bL,{"data-slot":"tooltip",...t})})}function o(e){let{...t}=e;return(0,s.jsx)(r.l9,{"data-slot":"tooltip-trigger",...t})}function d(e){let{className:t,sideOffset:a=0,children:n,...i}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{"data-slot":"tooltip-content",sideOffset:a,className:(0,l.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...i,children:[n,(0,s.jsx)(r.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}},57722:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ta});var s=a(95155),r=a(12115),l=a(74466),n=a(59434);let i=(0,l.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,n.cn)(i({variant:a}),t),...r})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-title",className:(0,n.cn)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-description",className:(0,n.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}var u=a(99708);let m=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function p(e){let{className:t,variant:a,size:r,asChild:l=!1,...i}=e,o=l?u.DX:"button";return(0,s.jsx)(o,{"data-slot":"button",className:(0,n.cn)(m({variant:a,size:r,className:t})),...i})}var x=a(15452),h=a(54416);function g(e){let{...t}=e;return(0,s.jsx)(x.bL,{"data-slot":"dialog",...t})}function f(e){let{...t}=e;return(0,s.jsx)(x.ZL,{"data-slot":"dialog-portal",...t})}function v(e){let{...t}=e;return(0,s.jsx)(x.bm,{"data-slot":"dialog-close",...t})}function b(e){let{className:t,...a}=e;return(0,s.jsx)(x.hJ,{"data-slot":"dialog-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function j(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(f,{"data-slot":"dialog-portal",children:[(0,s.jsx)(b,{}),(0,s.jsxs)(x.UC,{"data-slot":"dialog-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r,children:[a,(0,s.jsxs)(x.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(h.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function y(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,n.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function N(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:(0,n.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function D(e){let{className:t,...a}=e;return(0,s.jsx)(x.hE,{"data-slot":"dialog-title",className:(0,n.cn)("text-lg leading-none font-semibold",t),...a})}function w(e){let{className:t,...a}=e;return(0,s.jsx)(x.VY,{"data-slot":"dialog-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}var S=a(40968);function k(e){let{className:t,...a}=e;return(0,s.jsx)(S.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var C=a(81497);function F(e){let{className:t,...a}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,n.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}var R=a(91218);function A(){let{t:e}=(0,R.Bd)(),[t,a]=(0,r.useState)(!1),[l,n]=(0,r.useState)("");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p,{variant:"outline",size:"sm",onClick:()=>a(!0),children:[(0,s.jsx)(C.A,{className:"mr-2 h-4 w-4"})," ",e("FeedbackDialog.sendFeedbackButton")," "]}),(0,s.jsx)(g,{open:t,onOpenChange:a,children:(0,s.jsxs)(j,{className:"sm:max-w-[480px]",children:[(0,s.jsxs)(y,{children:[(0,s.jsx)(D,{children:e("FeedbackDialog.dialogTitle")}),(0,s.jsx)(w,{children:e("Accessibility.feedbackDescription")})]}),(0,s.jsx)("div",{className:"grid gap-4 py-4",children:(0,s.jsxs)("div",{className:"grid w-full gap-1.5",children:[(0,s.jsx)(k,{htmlFor:"message",children:e("FeedbackDialog.messageLabel")}),(0,s.jsx)(F,{placeholder:e("FeedbackDialog.messagePlaceholder"),id:"message",value:l,onChange:e=>n(e.target.value)})]})}),(0,s.jsxs)(N,{children:[(0,s.jsx)(v,{asChild:!0,children:(0,s.jsx)(p,{type:"button",variant:"outline",children:e("FeedbackDialog.cancelButton")})}),(0,s.jsx)(p,{type:"button",onClick:()=>{let t=encodeURIComponent(e("FeedbackDialog.dialogTitle")),s=encodeURIComponent(l);window.location.href="mailto:".concat("siempi@siempi.ch","?subject=").concat(t,"&body=").concat(s),a(!1),n("")},children:e("FeedbackDialog.openEmailButton")})]})]})})]})}var P=a(15448),_=a(80644),z=a(70831),E=a(24386),T=a(20908),L=a(94376),I=a(66389);function V(e,t){return Number(Math.round(Number(e+"e"+t))+"e-"+t)}var O=a(69074),M=a(81284),B=a(54861),G=a(49103),Y=a(62177);let W=r.createContext({}),q=e=>{let{...t}=e;return(0,s.jsx)(W.Provider,{value:{name:t.name},children:(0,s.jsx)(Y.xI,{...t})})},H=()=>{let e=r.useContext(W),t=r.useContext(U),{getFieldState:a}=(0,Y.xW)(),s=(0,Y.lN)({name:e.name}),l=a(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:n}=t;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...l}},U=r.createContext({});function Z(e){let{className:t,...a}=e,l=r.useId();return(0,s.jsx)(U.Provider,{value:{id:l},children:(0,s.jsx)("div",{"data-slot":"form-item",className:(0,n.cn)("grid gap-2",t),...a})})}function $(e){let{className:t,...a}=e,{error:r,formItemId:l}=H();return(0,s.jsx)(k,{"data-slot":"form-label","data-error":!!r,className:(0,n.cn)("data-[error=true]:text-destructive",t),htmlFor:l,...a})}function J(e){let{...t}=e,{error:a,formItemId:r,formDescriptionId:l,formMessageId:n}=H();return(0,s.jsx)(u.DX,{"data-slot":"form-control",id:r,"aria-describedby":a?"".concat(l," ").concat(n):"".concat(l),"aria-invalid":!!a,...t})}function Q(e){let{className:t,...a}=e,{formDescriptionId:r}=H();return(0,s.jsx)("p",{"data-slot":"form-description",id:r,className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}function X(e){var t;let{className:a,...r}=e,{error:l,formMessageId:i}=H(),o=l?String(null!=(t=null==l?void 0:l.message)?t:""):r.children;return o?(0,s.jsx)("p",{"data-slot":"form-message",id:i,className:(0,n.cn)("text-destructive text-sm",a),...r,children:o}):null}var K=a(20547);function ee(e){let{...t}=e;return(0,s.jsx)(K.bL,{"data-slot":"popover",...t})}function et(e){let{...t}=e;return(0,s.jsx)(K.l9,{"data-slot":"popover-trigger",...t})}function ea(e){let{className:t,align:a="center",sideOffset:r=4,...l}=e;return(0,s.jsx)(K.ZL,{children:(0,s.jsx)(K.UC,{"data-slot":"popover-content",align:a,sideOffset:r,className:(0,n.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...l})})}var es=a(46102),er=a(64047),el=a(1306),en=a(389),ei=a(3784),eo=a(42355),ed=a(13052),ec=a(75914);function eu(e){var t,a;let{className:r,classNames:l,showOutsideDays:i=!0,locale:o,...d}=e;return(0,s.jsx)(ec.h,{showOutsideDays:i,className:(0,n.cn)("p-3",r),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,n.cn)(m({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",month_grid:"w-full border-collapse space-y-1",weekdays:"flex",weekday:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",week:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,n.cn)(m({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...l},components:{Chevron:e=>{let{className:t,orientation:a,...r}=e;return"left"===a?(0,s.jsx)(eo.A,{className:(0,n.cn)(t,"h-4 w-4"),...r}):(0,s.jsx)(ed.A,{className:(0,n.cn)(t,"h-4 w-4"),...r})}},locale:o,weekStartsOn:null!=(a=null==o||null==(t=o.options)?void 0:t.weekStartsOn)?a:1,...d})}function em(e){let{className:t,type:a,...r}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:(0,n.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}eu.displayName="Calendar";var ep=a(4884);function ex(e){let{className:t,...a}=e;return(0,s.jsx)(ep.bL,{"data-slot":"switch",className:(0,n.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(ep.zi,{"data-slot":"switch-thumb",className:(0,n.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var eh=a(55594),eg=a(90221);let ef="yyyy-MM-dd",ev="dd.MM.yyyy",eb=e=>eh.z.object({startDate:eh.z.date({invalid_type_error:e("InvoiceForm.errorDateFormat")}).optional(),endDate:eh.z.date({invalid_type_error:e("InvoiceForm.errorDateFormat")}).optional(),includeEndDate:eh.z.boolean(),amounts:eh.z.array(eh.z.object({value:eh.z.string().min(1,{message:e("InvoiceForm.errorAmountValueRequired")}).refine(e=>!isNaN(parseFloat(e))&&parseFloat(e)>0,{message:e("InvoiceForm.errorAmountPositive")})})).min(1,e("InvoiceForm.errorAmountRequired"))}).refine(e=>!e.startDate||!e.endDate||e.endDate>=e.startDate,{message:e("InvoiceForm.errorEndDateBeforeStart"),path:["endDate"]}).refine(e=>void 0!==e.startDate,{message:e("InvoiceForm.errorStartDateRequired"),path:["startDate"]}).refine(e=>void 0!==e.endDate,{message:e("InvoiceForm.errorEndDateRequired"),path:["endDate"]});function ej(e){var t,a;let{onCalculate:l}=e,{t:n,i18n:i}=(0,R.Bd)(),[o,d]=(0,r.useState)(!1),c=eb(n),u=i.language.startsWith("de")?er.de:el.c,m=i.language.startsWith("de")?ev:ef,x=(0,Y.mN)({resolver:(0,eg.u)(c),defaultValues:{startDate:void 0,endDate:void 0,includeEndDate:!1,amounts:[{value:""}]},mode:"onChange"}),{fields:h,append:g,remove:f}=(0,Y.jz)({control:x.control,name:"amounts"}),[v,b]=(0,r.useState)(x.getValues("startDate")?(0,I.GP)(x.getValues("startDate"),ef):""),[j,y]=(0,r.useState)(x.getValues("endDate")?(0,I.GP)(x.getValues("endDate"),ef):""),[N,D]=(0,r.useState)(!1),[w,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{d(!0)},[]),(0,r.useEffect)(()=>{let e=i.language.startsWith("de")?ev:ef,t=x.getValues("startDate"),a=x.getValues("endDate");if(t)try{b((0,I.GP)(t,e))}catch(e){console.error("Error formatting start date on lang change:",e)}else b("");if(a)try{y((0,I.GP)(a,e))}catch(e){console.error("Error formatting end date on lang change:",e)}else y("")},[i.language,x,o]);let k=(e,t)=>{let a=e.target.value;"startDate"===t&&b(a),"endDate"===t&&y(a);let s=(0,en.qg)(a,m,new Date);(0,ei.f)(s)||(s=(0,en.qg)(a,ef,new Date)),(0,ei.f)(s)?x.setValue(t,(0,_.o)(s),{shouldValidate:!0}):x.setValue(t,void 0,{shouldValidate:!0})},C=e=>{if(e){let t=(0,_.o)(e);x.setValue("startDate",t,{shouldValidate:!0}),b((0,I.GP)(t,m))}else x.setValue("startDate",void 0,{shouldValidate:!0}),b("");D(!1)},F=e=>{if(e){let t=(0,_.o)(e);x.setValue("endDate",t,{shouldValidate:!0}),y((0,I.GP)(t,m))}else x.setValue("endDate",void 0,{shouldValidate:!0}),y("");S(!1)};return o?(0,s.jsx)(es.TooltipProvider,{children:(0,s.jsx)(Y.Op,{...x,children:(0,s.jsxs)("form",{onSubmit:x.handleSubmit(function(e){if(void 0===e.startDate||void 0===e.endDate)return void console.error("Form submitted with undefined dates despite validation");let t=e.amounts.map(e=>Number(e.value)),a={startDate:e.startDate,endDate:e.endDate,includeEndDate:e.includeEndDate,amounts:t};l(a,null);let s={startDate:e.startDate,endDate:e.endDate,includeEndDate:e.includeEndDate,amounts:t};console.log("Calculating with input:",s);try{var r;let e=function(e){let t={totalDuration:{days:0,start:"",end:"",included:e.includeEndDate},yearSegments:[],amountCalculations:[]};if(!e.amounts||0===e.amounts.length)return{totalDays:0,originalTotalAmount:0,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...t,error:"At least one amount is required."}};if(e.amounts.some(e=>isNaN(e)||null===e))return{totalDays:0,originalTotalAmount:0,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...t,error:"Invalid non-numeric amount provided."}};let a=V(e.amounts.reduce((e,t)=>e+t,0),2),s=(0,_.o)(e.startDate),r=(0,_.o)(e.endDate);if(e.includeEndDate&&(r=(0,z.f)(r,1)),t.totalDuration.start=(0,I.GP)(s,"yyyy-MM-dd"),t.totalDuration.end=(0,I.GP)(r,"yyyy-MM-dd"),s>=r)return{totalDays:0,originalTotalAmount:a,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...t,error:"Start date must be before the effective end date."}};let l=(0,E.c)(r,s);if(t.totalDuration.days=l,l<=0)return{totalDays:0,originalTotalAmount:a,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...t,error:"Calculated duration is zero or negative."}};let n={},i=s;for(;i<r;){let e=(0,T.C)(i),t=(0,L.Q)(i),a=(0,_.o)((0,z.f)(t,1)),s=r<a?r:a,o=(0,E.c)(s,i);if(o>0){let t=o/l;n[e]||(n[e]={days:0,proportion:0}),n[e].days+=o,n[e].proportion+=t}i=s}t.yearSegments=Object.entries(n).map(e=>{let[t,a]=e;return{year:Number(t),days:a.days,proportion:a.proportion}}).sort((e,t)=>e.year-t.year);let o=[];for(let a of e.amounts){let e={originalAmount:a,yearSplits:[],discrepancy:0,finalSum:0},s=[];for(let t in n){let r=Number(t),l=a*n[r].proportion;s.push({year:r,rawSplit:l}),e.yearSplits.push({year:r,rawSplit:l,roundedSplit:0,adjustment:0})}let r=s.map(e=>({...e,roundedSplit:V(e.rawSplit,2)}));r.forEach(t=>{let a=e.yearSplits.find(e=>e.year===t.year);a&&(a.roundedSplit=t.roundedSplit)});let l=V(r.reduce((e,t)=>e+t.roundedSplit,0),2),i=V(a-l,2);if(e.discrepancy=i,0!==i&&r.length>0){r.sort((e,t)=>e.year-t.year),r[0].roundedSplit=V(r[0].roundedSplit+i,2);let t=e.yearSplits.find(e=>e.year===r[0].year);t&&(t.adjustment=i),e.adjustmentAppliedToYear=r[0].year}let d={};r.forEach(e=>{d[e.year]={splitAmount:e.roundedSplit}});let c=V(r.reduce((e,t)=>e+t.roundedSplit,0),2);e.finalSum=c,o.push({originalAmount:a,adjustedTotalAmount:c,splits:d}),t.amountCalculations.push(e)}let d=Object.entries(n).map(e=>{let[t,a]=e,s=Number(t),r=0;return o.forEach(e=>{var t;r+=(null==(t=e.splits[s])?void 0:t.splitAmount)||0}),{year:s,daysInYear:a.days,proportion:a.proportion,totalSplitAmount:V(r,2)}}).sort((e,t)=>e.year-t.year);return{totalDays:l,originalTotalAmount:a,adjustedTotalAmount:V(d.reduce((e,t)=>e+t.totalSplitAmount,0),2),resultsPerAmount:o,aggregatedSplits:d,calculationSteps:t}}(s);console.log("Calculation Results:",e),(null==(r=e.calculationSteps)?void 0:r.error)?l(a,null,e.calculationSteps.error):e.aggregatedSplits&&0!==e.aggregatedSplits.length?l(a,e):l(a,null,"Calculation completed but resulted in no splits.")}catch(e){console.error("Calculation Error:",e),l(a,null,e instanceof Error?e.message:"An unexpected error occurred during calculation.")}}),className:"space-y-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)(q,{control:x.control,name:"startDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(Z,{className:"flex flex-col",children:[(0,s.jsx)($,{children:n("InvoiceForm.startDateLabel")}),(0,s.jsxs)(ee,{open:N,onOpenChange:D,children:[(0,s.jsx)(J,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(em,{placeholder:m,value:v,onChange:e=>k(e,"startDate"),className:"pr-10"}),(0,s.jsx)(et,{asChild:!0,children:(0,s.jsx)(p,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 text-muted-foreground","aria-label":"Open start date calendar",children:(0,s.jsx)(O.A,{className:"h-4 w-4"})})})]})}),(0,s.jsx)(ea,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(eu,{mode:"single",selected:t.value,onSelect:C,locale:u,initialFocus:!0,disabled:t.disabled})})]}),(0,s.jsx)(X,{})]})}}),(0,s.jsx)(q,{control:x.control,name:"endDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(Z,{className:"flex flex-col",children:[(0,s.jsx)($,{children:n("InvoiceForm.endDateLabel")}),(0,s.jsxs)(ee,{open:w,onOpenChange:S,children:[(0,s.jsx)(J,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(em,{placeholder:m,value:j,onChange:e=>k(e,"endDate"),className:"pr-10"}),(0,s.jsx)(et,{asChild:!0,children:(0,s.jsx)(p,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 text-muted-foreground","aria-label":"Open end date calendar",children:(0,s.jsx)(O.A,{className:"h-4 w-4"})})})]})}),(0,s.jsx)(ea,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(eu,{mode:"single",selected:t.value,onSelect:F,locale:u,initialFocus:!0,disabled:t.disabled})})]}),(0,s.jsx)(X,{})]})}})]}),(0,s.jsx)(q,{control:x.control,name:"includeEndDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(Z,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)($,{className:"text-base flex items-center",children:[n("InvoiceForm.includeEndDateLabel"),(0,s.jsxs)(es.m_,{delayDuration:300,children:[(0,s.jsx)(es.k$,{asChild:!0,children:(0,s.jsx)(M.A,{className:"h-4 w-4 ml-2 cursor-help"})}),(0,s.jsx)(es.ZI,{children:(0,s.jsx)("p",{children:n("InvoiceForm.includeEndDateTooltip")})})]})]}),(0,s.jsx)(Q,{children:n("InvoiceForm.includeEndDateDescription")})]}),(0,s.jsx)(J,{children:(0,s.jsx)(ex,{checked:t.value,onCheckedChange:t.onChange})})]})}}),(0,s.jsxs)("div",{className:"space-y-4 rounded-lg border p-4",children:[(0,s.jsx)($,{className:"text-base",children:n("InvoiceForm.amountsLabel")}),(0,s.jsx)(Q,{children:n("InvoiceForm.amountsDescription")}),h.map((e,t)=>(0,s.jsx)(q,{control:x.control,name:"amounts.".concat(t,".value"),render:e=>{let{field:a}=e;return(0,s.jsxs)(Z,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(J,{children:(0,s.jsx)(em,{type:"number",step:"any",placeholder:n("InvoiceForm.amountPlaceholder",{index:t+1}),...a})}),h.length>1&&(0,s.jsx)(p,{type:"button",variant:"ghost",size:"icon",onClick:()=>f(t),className:"text-destructive hover:text-destructive shrink-0","aria-label":"Remove amount",children:(0,s.jsx)(B.A,{className:"h-4 w-4"})})]}),(0,s.jsx)(X,{})]})}},e.id)),(0,s.jsxs)(p,{type:"button",variant:"outline",size:"sm",onClick:()=>g({value:""}),className:"mt-2",children:[(0,s.jsx)(G.A,{className:"mr-2 h-4 w-4"})," ",n("InvoiceForm.addAmountButton")]}),x.formState.errors.amounts&&!x.formState.errors.amounts.root&&x.formState.errors.amounts.message&&(0,s.jsx)("p",{className:"text-sm font-medium text-destructive",children:x.formState.errors.amounts.message}),(null==(a=x.formState.errors.amounts)||null==(t=a.root)?void 0:t.message)&&(0,s.jsx)("p",{className:"text-sm font-medium text-destructive",children:x.formState.errors.amounts.root.message})]}),(0,s.jsx)(p,{type:"submit",disabled:x.formState.isSubmitting,children:x.formState.isSubmitting?n("InvoiceForm.calculatingButton"):n("InvoiceForm.calculateButton")})]})})}):(0,s.jsx)("div",{className:"space-y-8 h-[400px]"})}var ey=a(9449);function eN(e){let{...t}=e;return(0,s.jsx)(ey.bL,{"data-slot":"dropdown-menu",...t})}function eD(e){let{...t}=e;return(0,s.jsx)(ey.l9,{"data-slot":"dropdown-menu-trigger",...t})}function ew(e){let{className:t,sideOffset:a=4,...r}=e;return(0,s.jsx)(ey.ZL,{children:(0,s.jsx)(ey.UC,{"data-slot":"dropdown-menu-content",sideOffset:a,className:(0,n.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...r})})}function eS(e){let{className:t,inset:a,variant:r="default",...l}=e;return(0,s.jsx)(ey.q7,{"data-slot":"dropdown-menu-item","data-inset":a,"data-variant":r,className:(0,n.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l})}var ek=a(47835);function eC(){let{i18n:e}=(0,R.Bd)(),[t,a]=r.useState(!1);r.useEffect(()=>{a(!0)},[]);let l=t=>{e.changeLanguage(t)};return t?(0,s.jsxs)(eN,{children:[(0,s.jsx)(eD,{asChild:!0,children:(0,s.jsxs)(p,{variant:"ghost",size:"icon","aria-label":"Change language",children:[" ",(0,s.jsx)(ek.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Change language"})]})}),(0,s.jsxs)(ew,{align:"end",children:[(0,s.jsx)(eS,{onClick:()=>l("en"),disabled:e.language.startsWith("en"),children:"English"}),(0,s.jsx)(eS,{onClick:()=>l("de"),disabled:e.language.startsWith("de"),children:"Deutsch"})]})]}):(0,s.jsx)(p,{variant:"ghost",size:"icon",disabled:!0,children:(0,s.jsx)(ek.A,{className:"h-5 w-5"})})}var eF=a(90792);function eR(e){let{isOpen:t,onOpenChange:a,title:r,content:l}=e,{t:n}=(0,R.Bd)();return(0,s.jsx)(g,{open:t,onOpenChange:a,children:(0,s.jsxs)(j,{className:"max-w-3xl max-h-[80vh] overflow-hidden flex flex-col",children:[(0,s.jsx)(y,{children:(0,s.jsx)(D,{className:"text-xl font-semibold",children:r})}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground mb-2",children:n("General.lastUpdated",{date:"April 25, 2025"})}),(0,s.jsx)("div",{className:"overflow-y-auto pr-6 -mr-6 pb-4 text-sm",children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)(eF.oz,{components:{h1:e=>{let{...t}=e;return(0,s.jsx)("h1",{className:"text-2xl font-bold my-4",...t})},h2:e=>{let{...t}=e;return(0,s.jsx)("h2",{className:"text-xl font-bold my-3",...t})},h3:e=>{let{...t}=e;return(0,s.jsx)("h3",{className:"text-lg font-bold my-2",...t})},p:e=>{let{...t}=e;return(0,s.jsx)("p",{className:"mb-3 leading-relaxed",...t})},ul:e=>{let{...t}=e;return(0,s.jsx)("ul",{className:"list-disc pl-6 mb-3",...t})},ol:e=>{let{...t}=e;return(0,s.jsx)("ol",{className:"list-decimal pl-6 mb-3",...t})},li:e=>{let{...t}=e;return(0,s.jsx)("li",{className:"mb-1",...t})},a:e=>{let{...t}=e;return(0,s.jsx)("a",{className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",...t})}},children:l||""})})}),(0,s.jsx)("div",{className:"flex justify-end mt-4",children:(0,s.jsx)(p,{onClick:()=>a(!1),children:n("SettingsModal.closeButton")})})]})})}var eA=a(3925),eP=a(23478),e_=a(66474);function ez(e){let{...t}=e;return(0,s.jsx)(eP.bL,{"data-slot":"accordion",...t})}function eE(e){let{className:t,...a}=e;return(0,s.jsx)(eP.q7,{"data-slot":"accordion-item",className:(0,n.cn)("border-b last:border-b-0",t),...a})}function eT(e){let{className:t,children:a,...r}=e;return(0,s.jsx)(eP.Y9,{className:"flex",children:(0,s.jsxs)(eP.l9,{"data-slot":"accordion-trigger",className:(0,n.cn)("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",t),...r,children:[a,(0,s.jsx)(e_.A,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function eL(e){let{className:t,children:a,...r}=e;return(0,s.jsx)(eP.UC,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...r,children:(0,s.jsx)("div",{className:(0,n.cn)("pt-0 pb-4",t),children:a})})}function eI(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function eV(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function eO(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...a})}function eM(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...a})}function eB(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-footer",className:(0,n.cn)("flex items-center px-6 [.border-t]:pt-6",t),...a})}function eG(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,n.cn)("w-full caption-bottom text-sm",t),...a})})}function eY(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,n.cn)("[&_tr]:border-b",t),...a})}function eW(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,n.cn)("[&_tr:last-child]:border-0",t),...a})}function eq(e){let{className:t,...a}=e;return(0,s.jsx)("tfoot",{"data-slot":"table-footer",className:(0,n.cn)("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",t),...a})}function eH(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,n.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function eU(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,n.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function eZ(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,n.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}var e$=a(91788),eJ=a(76118),eQ=a(26597),eX=a(424);function eK(e,t,a){if(null==e||isNaN(e))return"";let s=new Intl.NumberFormat(t,{minimumFractionDigits:a.decimalPlaces,maximumFractionDigits:a.decimalPlaces,useGrouping:!0}).format(e);if("apostrophe"===a.thousandsSeparator)if("de"==(t.startsWith("de")?"de":"en")){let e=s.split(",");e[0]=e[0].replace(/\./g,"'"),s=e.join(",")}else s=s.replace(/,/g,"'");return s}function e0(e,t){if(!e)return"";try{let a=new Date(e+"T00:00:00Z");if(isNaN(a.getTime()))return e;return new Intl.DateTimeFormat(t,{year:"numeric",month:"numeric",day:"numeric"}).format(a)}catch(t){return console.error("Error formatting date:",t),e}}let e1=e=>{let{steps:t,settings:a}=e,{t:r,i18n:l}=(0,R.Bd)(),n=l.language;if(t.error)return(0,s.jsx)("p",{className:"text-destructive",children:t.error});let{totalDuration:i,yearSegments:o,amountCalculations:d}=t,c=e=>e0(e,n),u=e=>eK(e,n,a);return(0,s.jsxs)("div",{className:"text-sm space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("h4",{className:"font-semibold mb-2",children:["1. ",r("ResultsDisplay.totalDuration")]}),(0,s.jsxs)("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-1 text-muted-foreground",children:[(0,s.jsx)("span",{className:"font-medium text-foreground",children:r("ResultsDisplay.periodLabel")}),(0,s.jsxs)("span",{children:[c(i.start)," to ",c(i.end)," (",i.included?r("ResultsDisplay.inclusiveLabel"):r("ResultsDisplay.exclusiveLabel"),")"]}),(0,s.jsxs)("span",{className:"font-medium text-foreground",children:[r("ResultsDisplay.totalDays"),":"]}),(0,s.jsx)("span",{children:i.days})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("h4",{className:"font-semibold mb-2",children:["2. ",r("ResultsDisplay.proportionCalculation")]}),o.map(e=>(0,s.jsxs)("p",{className:"text-muted-foreground",children:[(0,s.jsxs)("span",{className:"font-medium text-foreground",children:[e.year,":"]})," ",e.days," ",r("ResultsDisplay.daysLabel")," / ",i.days," ",r("ResultsDisplay.totalDays")," = ",(0,s.jsx)("span",{className:"font-medium text-foreground",children:e.proportion.toFixed(6)})," (",r("ResultsDisplay.proportionLabel"),")"]},e.year))]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h4",{className:"font-semibold mb-2",children:["3. ",r("ResultsDisplay.splitCalculation")]}),d.map((e,t)=>(0,s.jsxs)("div",{className:"border rounded-md p-3 space-y-2 bg-muted/30",children:[(0,s.jsxs)("p",{className:"font-medium",children:[r("ResultsDisplay.inputAmountLabel")," #",t+1,": ",u(e.originalAmount)]}),(0,s.jsx)("div",{className:"space-y-1",children:e.yearSplits.map(t=>{var a;return(0,s.jsxs)("div",{className:"pl-2 text-xs flex flex-wrap gap-x-2",children:[(0,s.jsxs)("span",{className:"font-medium shrink-0",children:[t.year,":"]}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:[u(e.originalAmount)," * ",null==(a=o.find(e=>e.year===t.year))?void 0:a.proportion.toFixed(6)," =",r("ResultsDisplay.rawLabel"),": ",t.rawSplit.toFixed(6)]}),(0,s.jsx)("span",{children:"â†’"}),(0,s.jsxs)("span",{className:"font-medium",children:[r("ResultsDisplay.roundedLabel"),": ",u(t.roundedSplit)]}),0!==t.adjustment&&(0,s.jsxs)("span",{className:"text-muted-foreground",children:["(",r("ResultsDisplay.adjustmentLabel"),": ",u(t.adjustment),")"]})]},t.year)})}),(0,s.jsxs)("div",{className:"border-t pt-2 mt-2 space-y-1 text-xs",children:[(0,s.jsxs)("p",{children:[(0,s.jsxs)("span",{className:"font-medium",children:[r("ResultsDisplay.discrepancyLabel"),":"]}),(0,s.jsxs)("span",{className:Math.abs(e.discrepancy)>.001?"text-amber-600 dark:text-amber-500":"",children:[" ",u(e.discrepancy)]}),e.adjustmentAppliedToYear&&(0,s.jsxs)("span",{className:"text-muted-foreground",children:["(",r("ResultsDisplay.adjustedInYearLabel")," ",e.adjustmentAppliedToYear,")"]})]}),(0,s.jsxs)("p",{className:"font-medium",children:[r("ResultsDisplay.finalSumLabel"),": ",u(e.finalSum)]})]})]},t))]})]})};function e2(e){let{results:t,inputData:a}=e,{settings:r}=(0,eX.t)(),{t:l,i18n:n}=(0,R.Bd)(),i=n.language,{totalDays:o,originalTotalAmount:d,adjustedTotalAmount:c,resultsPerAmount:u,aggregatedSplits:m,calculationSteps:x}=t,h=e=>{var t;return eK((t=r.roundingPrecision)&&!(t<=0)?Math.round(e/t)*t:e,i,r)},g=e=>null==e||isNaN(e)?"":new Intl.NumberFormat(i,{minimumFractionDigits:2,maximumFractionDigits:2}).format(100*e)+"%",f=e=>(0,I.GP)(e,"yyyy-MM-dd"),v=e=>e0((0,I.GP)(e,"yyyy-MM-dd"),i),b=Math.abs(d-c)>r.roundingPrecision/2+1e-5,j=[l("ResultsDisplay.yearHeader"),l("ResultsDisplay.daysHeader"),l("ResultsDisplay.proportionHeader"),l("ResultsDisplay.totalSplitAmountHeader")],y=m.map(e=>[e.year,e.daysInYear,g(e.proportion),h(e.totalSplitAmount)]),N=[l("ResultsDisplay.totalHeader"),o,g(1),h(c)],D=m.map(e=>e.year),w=[l("ResultsDisplay.yearHeader")];a.amounts.forEach((e,t)=>{w.push(l("ResultsDisplay.amountSplitHeader",{index:t+1}))}),w.push(l("ResultsDisplay.yearTotalHeader"));let S=D.map(e=>{let t=[e],a=0;return u.forEach(s=>{var r;let l=(null==(r=s.splits[e])?void 0:r.splitAmount)||0;t.push(h(l)),a+=l}),t.push(h(a)),t}),k=[l("ResultsDisplay.totalHeader")];return u.forEach(e=>{k.push(h(e.adjustedTotalAmount))}),k.push(h(c)),(0,s.jsxs)(eI,{className:"mt-8 w-full max-w-4xl",children:[(0,s.jsx)(eV,{children:(0,s.jsx)(eO,{children:l("ResultsDisplay.resultsTitle")})}),(0,s.jsxs)(eM,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-sm space-y-1",children:[" ",(0,s.jsxs)("p",{children:[" ",l("ResultsDisplay.periodLabel")," ",v(a.startDate)," bis ",v(a.endDate),(0,s.jsxs)("span",{className:"ml-1 text-muted-foreground",children:["(",a.includeEndDate?l("ResultsDisplay.inclusiveLabel"):l("ResultsDisplay.exclusiveLabel"),", ",o," ",l("ResultsDisplay.daysLabel"),")"]})]}),(0,s.jsxs)("p",{children:[" ",l("ResultsDisplay.originalTotalLabel")," ",h(d),(0,s.jsxs)("span",{className:"ml-1 text-muted-foreground",children:["(",a.amounts.length," ",1===a.amounts.length?l("ResultsDisplay.amountLabel"):l("ResultsDisplay.amountsLabel")," ",l("ResultsDisplay.enteredLabel"),")"]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:l("ResultsDisplay.aggregatedTitle")}),(0,s.jsxs)(eG,{children:[(0,s.jsx)(eY,{children:(0,s.jsx)(eH,{children:j.map(e=>(0,s.jsx)(eU,{className:e!==l("ResultsDisplay.yearHeader")?"text-right":"",children:e},e))})}),(0,s.jsx)(eW,{children:m.map(e=>(0,s.jsxs)(eH,{children:[(0,s.jsx)(eZ,{className:"font-medium",children:e.year}),(0,s.jsx)(eZ,{className:"text-right",children:e.daysInYear}),(0,s.jsx)(eZ,{className:"text-right",children:g(e.proportion)}),(0,s.jsx)(eZ,{className:"text-right",children:h(e.totalSplitAmount)})]},e.year))}),(0,s.jsx)(eq,{children:(0,s.jsxs)(eH,{className:b?"bg-warning/10":"",children:[(0,s.jsx)(eZ,{colSpan:2,className:"font-bold",children:l("ResultsDisplay.totalHeader")}),(0,s.jsx)(eZ,{className:"text-right font-bold",children:g(1)}),(0,s.jsx)(eZ,{className:"text-right font-bold",children:h(c)})]})})]}),b&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-2 text-amber-700 dark:text-amber-500",children:l("ResultsDisplay.roundingNote")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:l("ResultsDisplay.detailedTitle")}),(0,s.jsxs)(eG,{children:[(0,s.jsx)(eY,{children:(0,s.jsx)(eH,{children:w.map((e,t)=>(0,s.jsx)(eU,{className:t>0?"text-right":"",children:e},"".concat(e,"-").concat(t)))})}),(0,s.jsx)(eW,{children:S.map((e,t)=>(0,s.jsx)(eH,{children:e.map((e,t)=>(0,s.jsx)(eZ,{className:t>0?"text-right":"font-medium",children:e},t))},t))}),(0,s.jsx)(eq,{children:(0,s.jsxs)(eH,{className:b?"bg-warning/10":"",children:[(0,s.jsx)(eZ,{className:"font-bold",children:l("ResultsDisplay.totalHeader")}),u.map((e,t)=>(0,s.jsx)(eZ,{className:"text-right font-bold",children:h(e.adjustedTotalAmount)},t)),(0,s.jsx)(eZ,{className:"text-right font-bold",children:h(c)})]})})]})]}),(0,s.jsx)(ez,{type:"single",collapsible:!0,className:"w-full mt-6",children:(0,s.jsxs)(eE,{value:"item-1",children:[(0,s.jsx)(eT,{children:l("ResultsDisplay.calculationStepsTitle")}),(0,s.jsx)(eL,{children:(0,s.jsx)(e1,{steps:x,settings:r})})]})})]}),(0,s.jsxs)(eB,{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsxs)(p,{variant:"outline",size:"sm",onClick:()=>{let e=eA.Wp.book_new(),t=a.amounts.map(e=>h(e)).join(", "),s=[[l("ResultsDisplay.inputSummary",{defaultValue:"Input Summary"})],[],[l("InvoiceForm.startDateLabel"),v(a.startDate)],[l("InvoiceForm.endDateLabel"),v(a.endDate)],[l("InvoiceForm.includeEndDateLabel"),a.includeEndDate?l("ResultsDisplay.yesLabel",{defaultValue:"Yes"}):l("ResultsDisplay.noLabel",{defaultValue:"No"})],[l("ResultsDisplay.totalDurationLabel",{defaultValue:"Total Duration (days)"}),o],[l("InvoiceForm.amountsLabel"),t],[l("ResultsDisplay.originalTotalAmountLabel",{defaultValue:"Original Total Amount"}),h(d)]],r=eA.Wp.aoa_to_sheet(s);r["!cols"]=[{wch:25},{wch:20}],eA.Wp.book_append_sheet(e,r,l("ResultsDisplay.inputSummarySheetName",{defaultValue:"Input Summary"}));let n=[[l("ResultsDisplay.aggregatedTitle")],[],j,...y,[],N],i=eA.Wp.aoa_to_sheet(n);i["!cols"]=[{wch:10},{wch:10},{wch:15},{wch:20}],eA.Wp.book_append_sheet(e,i,l("ResultsDisplay.aggregatedSheetName",{defaultValue:"Aggregated Results"}));let c=[[l("ResultsDisplay.detailedTitle")],[],w,...S,[],k],u=eA.Wp.aoa_to_sheet(c),m=[{wch:10},...a.amounts.map(()=>({wch:15})),{wch:15}];u["!cols"]=m,eA.Wp.book_append_sheet(e,u,l("ResultsDisplay.detailedSheetName",{defaultValue:"Detailed Breakdown"})),eA._h(e,"invoice_split_".concat(f(new Date),".xlsx"))},children:[(0,s.jsx)(e$.A,{className:"mr-2 h-4 w-4"})," ",l("ResultsDisplay.exportExcelButton")]}),(0,s.jsxs)(p,{variant:"outline",size:"sm",onClick:()=>{var e,t;let s=new eQ.Ay,r=l("ResultsDisplay.pdfTitle",{defaultValue:"Invoice Split Calculation"}),n="".concat(l("ResultsDisplay.periodLabel")," ").concat(v(a.startDate)," to ").concat(v(a.endDate)," (").concat(a.includeEndDate?l("ResultsDisplay.inclusiveLabel"):l("ResultsDisplay.exclusiveLabel"),", ").concat(o," ").concat(l("ResultsDisplay.daysLabel"),")"),i="".concat(l("ResultsDisplay.originalTotalLabel")," ").concat(h(d));s.setFontSize(16),s.text(r,14,20),s.setFontSize(10),s.text(n,14,26),s.text(i,14,30),s.setFontSize(12),s.text(l("ResultsDisplay.aggregatedTitle"),14,40),(0,eJ.Ay)(s,{startY:42,head:[j],body:y,foot:[N],theme:"grid",headStyles:{fillColor:[41,128,185],textColor:255},footStyles:{fillColor:[220,220,220],textColor:0,fontStyle:"bold"},styles:{fontSize:9,cellPadding:1.5},columnStyles:{3:{halign:"right"}}});let c=(null!=(t=null==(e=s.lastAutoTable)?void 0:e.finalY)?t:40)+10;s.setFontSize(12),s.text(l("ResultsDisplay.detailedTitle"),14,c),(0,eJ.Ay)(s,{startY:c+2,head:[w],body:S,foot:[k],theme:"grid",headStyles:{fillColor:[41,128,185],textColor:255},footStyles:{fillColor:[220,220,220],textColor:0,fontStyle:"bold"},styles:{fontSize:8,cellPadding:1.5},columnStyles:{...w.reduce((e,t,a)=>(a>0&&(e[a]={halign:"right"}),e),{})}}),s.save("invoice_split_".concat(f(new Date),".pdf"))},children:[(0,s.jsx)(e$.A,{className:"mr-2 h-4 w-4"})," ",l("ResultsDisplay.exportPdfButton")]})]})]})}var e4=a(76981),e5=a(5196);function e3(e){let{className:t,...a}=e;return(0,s.jsx)(e4.bL,{"data-slot":"checkbox",className:(0,n.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(e4.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,s.jsx)(e5.A,{className:"size-3.5"})})})}function e6(e){var t,a;let{isOpen:l,onOpenChange:n}=e,{settings:i,saveSettings:o}=(0,eX.t)(),{t:d,i18n:c}=(0,R.Bd)(),[u,m]=(0,r.useState)({...i,locale:c.language});return(0,r.useEffect)(()=>{m({...i,locale:c.language})},[i,c.language]),(0,s.jsx)(g,{open:l,onOpenChange:n,children:(0,s.jsxs)(j,{className:"sm:max-w-[360px] p-5",children:[(0,s.jsxs)(y,{className:"pb-2",children:[(0,s.jsx)(D,{className:"text-center",children:d("SettingsModal.title")}),(0,s.jsx)(w,{className:"text-center",children:d("Accessibility.settingsDescription")})]}),(0,s.jsxs)("div",{className:"space-y-5 py-1",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-32 text-right pr-3",children:(0,s.jsx)(k,{htmlFor:"thousandsSeparator",className:"inline-block",children:d("SettingsModal.useApostropheSeparatorLabel")})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(e3,{id:"thousandsSeparator",checked:"apostrophe"===u.thousandsSeparator,onCheckedChange:e=>{let t=e?"apostrophe":"comma-period";m(e=>({...e,thousandsSeparator:t}))}}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:d("SettingsModal.useApostropheSeparatorDescription")})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-32 text-right pr-3",children:(0,s.jsx)(k,{htmlFor:"decimalPlaces",className:"inline-block",children:d("SettingsModal.decimalPlacesLabel")})}),(0,s.jsx)(em,{id:"decimalPlaces",type:"number",min:"0",max:"6",value:String(null!=(t=u.decimalPlaces)?t:""),onChange:e=>{let t=e.target.value;if(""===t||/^\d*$/.test(t)){let e=parseInt(t,10);""===t||!isNaN(e)&&e>=0&&e<=6?m(a=>({...a,decimalPlaces:""===t?2:e})):!isNaN(e)&&e>6&&m(e=>({...e,decimalPlaces:6}))}},className:"w-20 h-8 text-sm"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-32 text-right pr-3",children:(0,s.jsx)(k,{htmlFor:"roundingPrecision",className:"inline-block",children:d("SettingsModal.roundingPrecisionLabel")})}),(0,s.jsx)(em,{id:"roundingPrecision",type:"number",step:"any",min:"0",value:String(null!=(a=u.roundingPrecision)?a:""),onChange:e=>{let t=e.target.value;if(""===t||/^\d*\.?\d*$/.test(t)){let e=parseFloat(t);m(a=>({...a,roundingPrecision:""===t||isNaN(e)?.01:e}))}},className:"w-20 h-8 text-sm"})]})]}),(0,s.jsxs)(N,{className:"pt-3 space-x-2",children:[(0,s.jsx)(v,{asChild:!0,children:(0,s.jsx)(p,{type:"button",variant:"outline",className:"flex-1",children:d("SettingsModal.closeButton")})}),(0,s.jsx)(p,{type:"button",onClick:()=>{var e;let t,a,s=u.decimalPlaces;if("string"==typeof s&&""!==s){let e=parseInt(s,10);t=isNaN(e)||e<0||e>6?i.decimalPlaces:e}else t="number"==typeof s?s<0||s>6?i.decimalPlaces:s:i.decimalPlaces;let r=u.roundingPrecision;if("string"==typeof r&&""!==r){let e=parseFloat(r);a=isNaN(e)||e<=0?i.roundingPrecision:e}else a="number"==typeof r?r<=0?i.roundingPrecision:r:i.roundingPrecision;let l={decimalPlaces:t,roundingPrecision:a,thousandsSeparator:null!=(e=u.thousandsSeparator)?e:i.thousandsSeparator},d=u.locale;d&&c.language!==d&&c.changeLanguage(d),o(l),n(!1)},className:"flex-1",children:d("SettingsModal.saveButton")})]})]})})}var e9=a(41684),e8=a(62098),e7=a(93509),te=a(51362);function tt(){let{setTheme:e}=(0,te.D)(),{t}=(0,R.Bd)(),[a,l]=r.useState(!1);return(r.useEffect(()=>{l(!0)},[]),a)?(0,s.jsxs)(eN,{children:[(0,s.jsx)(eD,{asChild:!0,children:(0,s.jsxs)(p,{variant:"ghost",size:"icon","aria-label":t("ThemeToggle.toggleTheme"),children:[(0,s.jsx)(e8.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,s.jsx)(e7.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,s.jsx)("span",{className:"sr-only",children:t("ThemeToggle.toggleTheme")})]})}),(0,s.jsxs)(ew,{align:"end",children:[(0,s.jsx)(eS,{onClick:()=>e("light"),children:t("ThemeToggle.light")}),(0,s.jsx)(eS,{onClick:()=>e("dark"),children:t("ThemeToggle.dark")}),(0,s.jsx)(eS,{onClick:()=>e("system"),children:t("ThemeToggle.system")})]})]}):(0,s.jsxs)(p,{variant:"ghost",size:"icon",disabled:!0,"aria-label":"Toggle theme",children:[(0,s.jsx)(e8.A,{className:"h-[1.2rem] w-[1.2rem]"}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}function ta(){let{t:e,i18n:t}=(0,R.Bd)(),[a,l]=(0,r.useState)(!1),[n,i]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[x,h]=(0,r.useState)(null),[g,f]=(0,r.useState)(!1),[v,b]=(0,r.useState)(!1),[j,y]=(0,r.useState)(""),[N,D]=(0,r.useState)(null),[w,S]=(0,r.useState)(!1);(0,r.useEffect)(()=>{l(!0)},[]);let k=async t=>{try{let e=await fetch(t);if(!e.ok&&t.includes(".de.md")){let a=t.replace(".de.md",".md");console.log("Localized version not found, trying English version: ".concat(a)),e=await fetch(a)}if(!e.ok)throw Error("Failed to fetch ".concat(t,": ").concat(e.statusText));return await e.text()}catch(t){return console.error("Error fetching markdown:",t),e("Errors.unexpectedError")}},C=async a=>{S(!0),b(!0);let s="",r="",l="de"===(t.language||"en")?".de":"";"privacy"===a?(s=e("General.privacyPolicy"),r="/privacy-policy".concat(l,".md")):(s=e("General.termsOfUse"),r="/terms-of-use".concat(l,".md")),y(s),D(await k(r)),S(!1)};return(0,s.jsxs)("main",{className:"flex min-h-screen flex-col items-center p-4 md:p-12 lg:p-24",children:[(0,s.jsxs)("header",{className:"w-full max-w-4xl flex justify-end items-center space-x-2 mb-4 px-4",children:[(0,s.jsx)(eC,{}),(0,s.jsxs)(p,{variant:"ghost",size:"icon",onClick:()=>f(!0),"aria-label":a?e("SettingsModal.title"):"Number Formatting",children:[(0,s.jsx)(P.A,{className:"h-5 w-5"})," "]}),(0,s.jsx)(tt,{})]}),(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl grow",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-center mb-8",children:[a?e("InvoiceForm.title"):(0,s.jsx)(s.Fragment,{children:"\xa0"})," "]}),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(ej,{onCalculate:(t,a,s)=>{i(a),s&&s.includes("At least one amount is required")?m(e("Errors.calculationErrorTitle")+": "+e("InvoiceForm.errorAmountRequired")):s&&s.includes("Start date must be before")?m(e("Errors.calculationErrorTitle")+": "+e("InvoiceForm.errorEndDateBeforeStart")):m(s?e("Errors.calculationErrorTitle")+": "+e("Errors.unexpectedError"):null),a&&!s?h(t):h(null)}})}),(0,s.jsxs)("div",{id:"results-section",className:"mt-12 w-full flex justify-center",children:[a&&u&&(0,s.jsxs)(o,{variant:"destructive",className:"max-w-2xl",children:[(0,s.jsx)(e9.A,{className:"h-4 w-4"}),(0,s.jsx)(d,{children:e("Errors.calculationErrorTitle")}),(0,s.jsx)(c,{children:u})]}),a&&n&&x&&!u&&(0,s.jsx)(e2,{results:n,inputData:x})]})]}),a&&(0,s.jsx)(e6,{isOpen:g,onOpenChange:f}),a&&(0,s.jsx)(eR,{isOpen:v,onOpenChange:b,title:j,content:w?e("FeedbackDialog.messagePlaceholder"):N}),(0,s.jsx)("footer",{className:"w-full max-w-4xl mt-auto px-4 py-6 border-t text-sm text-muted-foreground",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-y-2 gap-x-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-center text-center sm:text-left order-2 sm:order-1 grow gap-x-3 gap-y-1",children:[(0,s.jsxs)("p",{className:"shrink-0",children:[a?e("General.allRightsReserved",{year:new Date().getFullYear()}):(0,s.jsxs)(s.Fragment,{children:["\xa9 ",new Date().getFullYear()]})," "]}),(0,s.jsxs)("div",{className:"flex gap-x-3 justify-center sm:justify-start",children:[(0,s.jsx)("button",{onClick:()=>C("privacy"),className:"underline hover:text-foreground whitespace-nowrap",children:a?e("General.privacyPolicy"):"Privacy Policy"}),(0,s.jsx)("button",{onClick:()=>C("terms"),className:"underline hover:text-foreground whitespace-nowrap",children:a?e("General.termsOfUse"):"Terms of Use"})]})]}),(0,s.jsxs)("div",{className:"order-1 sm:order-2 shrink-0",children:[a?(0,s.jsx)(A,{}):(0,s.jsx)("div",{className:"h-9 w-[130px]"})," "]})]})})]})}},59434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(52596),r=a(39688);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},72016:(e,t,a)=>{Promise.resolve().then(a.bind(a,57722))},83686:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[524,930,81,151,441,684,358],()=>t(72016)),_N_E=e.O()}]);