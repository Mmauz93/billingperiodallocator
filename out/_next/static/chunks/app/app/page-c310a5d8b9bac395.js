(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{424:(e,t,a)=>{"use strict";a.d(t,{SettingsProvider:()=>o,t:()=>i});var s=a(95155),r=a(12115);let n={decimalPlaces:2,roundingPrecision:.01,thousandsSeparator:","},l=(0,r.createContext)(void 0),o=e=>{let{children:t}=e,[a,o]=(0,r.useState)(()=>{let e=localStorage.getItem("appSettings"),t=e?JSON.parse(e):{};return"locale"in t&&delete t.locale,{...n,...t}}),[i,d]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!i){try{let e=localStorage.getItem("appSettings");if(e){let t=JSON.parse(e);"locale"in t&&delete t.locale,"number"==typeof t.decimalPlaces&&"number"==typeof t.roundingPrecision&&t.roundingPrecision>0&&"string"==typeof t.thousandsSeparator&&[",",".","'"," "].includes(t.thousandsSeparator)?o(e=>({...n,...e,...t})):(console.warn("Loaded settings from localStorage are invalid or incomplete (excluding locale). Using defaults."),o(n),localStorage.removeItem("appSettings"))}else o(n)}catch(e){console.error("Failed to load settings from localStorage:",e),o(n)}d(!0)}},[i]),(0,s.jsx)(l.Provider,{value:{settings:a,saveSettings:e=>{try{let t={...void 0!==e.decimalPlaces&&{decimalPlaces:e.decimalPlaces},...void 0!==e.roundingPrecision&&{roundingPrecision:e.roundingPrecision},...void 0!==e.thousandsSeparator&&{thousandsSeparator:e.thousandsSeparator}},s={...a,...t};o(s),localStorage.setItem("appSettings",JSON.stringify(s))}catch(e){console.error("Failed to save settings to localStorage:",e)}}},children:t})},i=()=>{let e=(0,r.useContext)(l);if(!e)throw Error("useSettings must be used within a SettingsProvider");return e}},28242:(e,t,a)=>{"use strict";a.d(t,{InvoiceCalculatorClient:()=>tS});var s=a(95155),r=a(12115),n=a(74466),l=a(52596),o=a(39688);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,o.QP)((0,l.$)(t))}let d=(0,n.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:i(d({variant:a}),t),...r})}function u(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-title",className:i("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...a})}function m(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-description",className:i("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}var x=a(99708);let p=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive cursor-pointer hover:transform hover:translate-y-[-2px] hover:scale-[1.015]",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90 hover:shadow-md",destructive:"bg-destructive text-destructive-foreground shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 hover:shadow-md",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 hover:shadow-md",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80 hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function h(e){let{className:t,variant:a,size:r,asChild:n=!1,...l}=e,o=n?x.DX:"button";return(0,s.jsx)(o,{"data-slot":"button",className:i(p({variant:a,size:r,className:t})),...l})}var g=a(57383),f=a(15452),v=a(54416);function j(e){let{...t}=e;return(0,s.jsx)(f.bL,{"data-slot":"dialog",...t})}function b(e){let{...t}=e;return(0,s.jsx)(f.ZL,{"data-slot":"dialog-portal",...t})}function y(e){let{...t}=e;return(0,s.jsx)(f.bm,{"data-slot":"dialog-close",...t})}function N(e){let{className:t,...a}=e;return(0,s.jsx)(f.hJ,{"data-slot":"dialog-overlay",className:i("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 backdrop-blur-[10px]",t),...a})}function w(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(b,{"data-slot":"dialog-portal",children:[(0,s.jsx)(N,{}),(0,s.jsxs)(f.UC,{"data-slot":"dialog-content",className:i("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r,children:[a,(0,s.jsxs)(f.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 cursor-pointer",children:[(0,s.jsx)(v.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function S(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:i("flex flex-col gap-2 text-center sm:text-left",t),...a})}function D(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-footer",className:i("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function k(e){let{className:t,...a}=e;return(0,s.jsx)(f.hE,{"data-slot":"dialog-title",className:i("text-lg leading-none font-semibold",t),...a})}function C(e){let{className:t,...a}=e;return(0,s.jsx)(f.VY,{"data-slot":"dialog-description",className:i("text-muted-foreground text-sm",t),...a})}var A=a(40968);function E(e){let{className:t,...a}=e;return(0,s.jsx)(A.b,{"data-slot":"label",className:i("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var F=a(81497);function P(e){let{className:t,...a}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:i("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}var I=a(91218);function z(e){let{variant:t="outline",size:a="sm",className:n,...l}=e,{t:o}=(0,I.Bd)(),[i,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)("");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(h,{variant:t,size:a,className:n,onClick:()=>d(!0),...l,children:[(0,s.jsx)(F.A,{className:"mr-2 h-4 w-4"})," ",o("FeedbackDialog.sendFeedbackButton")," "]}),(0,s.jsx)(j,{open:i,onOpenChange:d,children:(0,s.jsxs)(w,{className:"sm:max-w-[480px]",children:[(0,s.jsxs)(S,{children:[(0,s.jsx)(k,{children:o("FeedbackDialog.dialogTitle")}),(0,s.jsx)(C,{children:o("Accessibility.feedbackDescription")})]}),(0,s.jsx)("div",{className:"grid gap-4 py-4",children:(0,s.jsxs)("div",{className:"grid w-full gap-1.5",children:[(0,s.jsx)(E,{htmlFor:"message",children:o("FeedbackDialog.messageLabel")}),(0,s.jsx)(P,{placeholder:o("FeedbackDialog.messagePlaceholder"),id:"message",value:c,onChange:e=>u(e.target.value)})]})}),(0,s.jsxs)(D,{children:[(0,s.jsx)(y,{asChild:!0,children:(0,s.jsx)(h,{type:"button",variant:"outline",children:o("FeedbackDialog.cancelButton")})}),(0,s.jsx)(h,{type:"button",onClick:()=>{let e=encodeURIComponent(o("FeedbackDialog.dialogTitle")),t=encodeURIComponent(c);window.location.href="mailto:".concat("billsplitter@siempi.ch","?subject=").concat(e,"&body=").concat(t),d(!1),u("")},children:o("FeedbackDialog.openEmailButton")})]})]})})]})}var R=a(65125),_=a(15448),T=a(66766),L=a(40646),M=a(85339),V=a(69074),B=a(54861),O=a(49103),G=a(51154),Y=a(62177);let W=Y.Op,q=r.createContext({}),H=e=>{let{...t}=e;return(0,s.jsx)(q.Provider,{value:{name:t.name},children:(0,s.jsx)(Y.xI,{...t})})},U=()=>{let e=r.useContext(q),t=r.useContext(Z),{getFieldState:a}=(0,Y.xW)(),s=(0,Y.lN)({name:e.name}),n=a(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...n}},Z=r.createContext({});function J(e){let{className:t,...a}=e,n=r.useId();return(0,s.jsx)(Z.Provider,{value:{id:n},children:(0,s.jsx)("div",{"data-slot":"form-item",className:i("grid gap-2",t),...a})})}function K(e){let{className:t,...a}=e,{error:r,formItemId:n}=U();return(0,s.jsx)(E,{"data-slot":"form-label","data-error":!!r,className:i("data-[error=true]:text-destructive",t),htmlFor:n,...a})}function X(e){let{...t}=e,{error:a,formItemId:r,formDescriptionId:n,formMessageId:l}=U();return(0,s.jsx)(x.DX,{"data-slot":"form-control",id:r,"aria-describedby":a?"".concat(n," ").concat(l):"".concat(n),"aria-invalid":!!a,...t})}function Q(e){let{className:t,...a}=e,{formDescriptionId:r}=U();return(0,s.jsx)("p",{"data-slot":"form-description",id:r,className:i("text-muted-foreground text-sm",t),...a})}function $(e){var t;let{className:a,...r}=e,{error:n,formMessageId:l}=U(),o=n?String(null!=(t=null==n?void 0:n.message)?t:""):r.children;return o?(0,s.jsx)("p",{"data-slot":"form-message",id:l,className:i("text-destructive text-sm pl-3",a),...r,children:o}):null}var ee=a(80644),et=a(70831),ea=a(24386),es=a(20908),er=a(94376),en=a(66389);function el(e,t){return Number(Math.round(Number(e+"e"+t))+"e-"+t)}function eo(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:i("bg-card text-card-foreground flex flex-col gap-6 rounded-lg border py-6 shadow-sm",t),...a})}function ei(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:i("px-6",t),...a})}function ed(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-footer",className:i("flex items-center px-6 [.border-t]:pt-6",t),...a})}var ec=a(20547);function eu(e){let{...t}=e;return(0,s.jsx)(ec.bL,{"data-slot":"popover",...t})}function em(e){let{...t}=e;return(0,s.jsx)(ec.l9,{"data-slot":"popover-trigger",...t})}function ex(e){let{className:t,align:a="center",sideOffset:r=4,...n}=e;return(0,s.jsx)(ec.ZL,{children:(0,s.jsx)(ec.UC,{"data-slot":"popover-content",align:a,sideOffset:r,className:i("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})})}var ep=a(64047),eh=a(1306),eg=a(389),ef=a(3784),ev=a(42355),ej=a(13052),eb=a(75914);function ey(e){var t,a;let{className:r,classNames:n,showOutsideDays:l=!0,locale:o,...d}=e;return(0,s.jsx)(eb.h,{showOutsideDays:l,className:i("p-3",r),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:i(p({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",month_grid:"w-full border-collapse space-y-1",weekdays:"flex",weekday:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",week:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:i(p({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...n},components:{Chevron:e=>{let{className:t,orientation:a,...r}=e;return"left"===a?(0,s.jsx)(ev.A,{className:i(t,"h-4 w-4"),...r}):(0,s.jsx)(ej.A,{className:i(t,"h-4 w-4"),...r})}},locale:o,weekStartsOn:null!=(a=null==o||null==(t=o.options)?void 0:t.weekStartsOn)?a:1,...d})}function eN(e){let{className:t,type:a,helperText:r,...n}=e;return(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("input",{type:a,"data-slot":"input",className:i("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground border-input flex h-9 w-full min-w-0 rounded-lg border bg-transparent px-3 py-1 text-base shadow-sm transition-all outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus:border-[#2E5A8C] focus:ring-[#2E5A8C]/20 focus:ring-2","aria-invalid:border-destructive aria-invalid:ring-destructive/40 dark:aria-invalid:ring-destructive/40",t),style:{boxShadow:"0 2px 6px rgba(0,0,0,0.05)"},...n}),r&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1 mb-3 pl-3",children:r})]})}ey.displayName="Calendar";var ew=a(4884);function eS(e){let{className:t,...a}=e;return(0,s.jsx)(ew.bL,{"data-slot":"switch",className:i("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 cursor-pointer",t),...a,children:(0,s.jsx)(ew.zi,{"data-slot":"switch-thumb",className:i("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}var eD=a(55594),ek=a(90221);let eC="yyyy-MM-dd",eA="dd.MM.yyyy",eE=e=>eD.z.object({startDate:eD.z.date({invalid_type_error:e("InvoiceForm.errorDateFormat")}).optional(),endDate:eD.z.date({invalid_type_error:e("InvoiceForm.errorDateFormat")}).optional(),includeEndDate:eD.z.boolean(),amounts:eD.z.array(eD.z.object({value:eD.z.string().min(1,{message:e("InvoiceForm.errorAmountValueRequired")}).refine(e=>!isNaN(parseFloat(e))&&parseFloat(e)>0,{message:e("InvoiceForm.errorAmountPositive")})})).min(1,e("InvoiceForm.errorAmountRequired"))}).refine(e=>!e.startDate||!e.endDate||e.endDate>=e.startDate,{message:e("InvoiceForm.errorEndDateBeforeStart"),path:["endDate"]}).refine(e=>void 0!==e.startDate,{message:e("InvoiceForm.errorStartDateRequired"),path:["startDate"]}).refine(e=>void 0!==e.endDate,{message:e("InvoiceForm.errorEndDateRequired"),path:["endDate"]}),eF=e=>{let{children:t,...a}=e;return(0,s.jsx)(K,{...a,style:{color:"var(--foreground)",fontWeight:500},children:t})},eP=e=>{let{className:t,...a}=e;return(0,s.jsx)($,{className:i("pl-3",t),...a})};function eI(e){var t,a;let{onCalculateAction:n}=e,{t:l,i18n:o}=(0,I.Bd)(),[i,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),f=eE(l),v=o.language.startsWith("de")?ep.de:eh.c,j=o.language.startsWith("de")?eA:eC,b=(0,Y.mN)({resolver:(0,ek.u)(f),defaultValues:{startDate:void 0,endDate:void 0,includeEndDate:!1,amounts:[{value:""}]},mode:"onChange"}),{fields:y,append:N,remove:w}=(0,Y.jz)({control:b.control,name:"amounts"}),[S,D]=(0,r.useState)(b.getValues("startDate")?(0,en.GP)(b.getValues("startDate"),eC):""),[k,C]=(0,r.useState)(b.getValues("endDate")?(0,en.GP)(b.getValues("endDate"),eC):""),[A,E]=(0,r.useState)(!1),[F,P]=(0,r.useState)(!1);(0,r.useEffect)(()=>{d(!0),x(l("InvoiceForm.calculateButton"))},[l]),(0,r.useEffect)(()=>{let e=o.language.startsWith("de")?eA:eC,t=b.getValues("startDate"),a=b.getValues("endDate");if(t)try{D((0,en.GP)(t,e))}catch(e){console.error("Error formatting start date on lang change:",e)}else D("");if(a)try{C((0,en.GP)(a,e))}catch(e){console.error("Error formatting end date on lang change:",e)}else C("")},[o.language,b,i]);let z=(e,t)=>{let a=e.target.value;"startDate"===t&&D(a),"endDate"===t&&C(a);let s=(0,eg.qg)(a,j,new Date);(0,ef.f)(s)||(s=(0,eg.qg)(a,eC,new Date)),(0,ef.f)(s)?b.setValue(t,(0,ee.o)(s),{shouldValidate:!0}):b.setValue(t,void 0,{shouldValidate:!0})};function R(e){if(u(!0),x(l("InvoiceForm.calculatingButton")),void 0===e.startDate||void 0===e.endDate){console.error("Form submitted with undefined dates despite validation"),u(!1),x(l("InvoiceForm.calculateButton"));return}let t=e.amounts.map(e=>Number(e.value)),a={startDate:e.startDate,endDate:e.endDate,includeEndDate:e.includeEndDate,amounts:t};n(a,null);let s={startDate:e.startDate,endDate:e.endDate,includeEndDate:e.includeEndDate,amounts:t};console.log("Calculating with input:",s);try{let e=function(e){let t={totalDuration:{days:0,start:"",end:"",included:e.includeEndDate},yearSegments:[],amountCalculations:[]};if(!e.amounts||0===e.amounts.length)return{totalDays:0,originalTotalAmount:0,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...t,error:"At least one amount is required."}};if(e.amounts.some(e=>isNaN(e)||null===e))return{totalDays:0,originalTotalAmount:0,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...t,error:"Invalid non-numeric amount provided."}};let a=el(e.amounts.reduce((e,t)=>e+t,0),2),s=(0,ee.o)(e.startDate),r=(0,ee.o)(e.endDate);if(e.includeEndDate&&(r=(0,et.f)(r,1)),t.totalDuration.start=(0,en.GP)(s,"yyyy-MM-dd"),t.totalDuration.end=(0,en.GP)(r,"yyyy-MM-dd"),s>=r)return{totalDays:0,originalTotalAmount:a,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...t,error:"Start date must be before the effective end date."}};let n=(0,ea.c)(r,s);if(t.totalDuration.days=n,n<=0)return{totalDays:0,originalTotalAmount:a,adjustedTotalAmount:0,resultsPerAmount:[],aggregatedSplits:[],calculationSteps:{...t,error:"Calculated duration is zero or negative."}};let l={},o=s;for(;o<r;){let e=(0,es.C)(o),t=(0,er.Q)(o),a=(0,ee.o)((0,et.f)(t,1)),s=r<a?r:a,i=(0,ea.c)(s,o);if(i>0){let t=i/n;l[e]||(l[e]={days:0,proportion:0}),l[e].days+=i,l[e].proportion+=t}o=s}t.yearSegments=Object.entries(l).map(e=>{let[t,a]=e;return{year:Number(t),days:a.days,proportion:a.proportion}}).sort((e,t)=>e.year-t.year);let i=[];for(let a of e.amounts){let e={originalAmount:a,yearSplits:[],discrepancy:0,finalSum:0},s=[];for(let t in l){let r=Number(t),n=a*l[r].proportion;s.push({year:r,rawSplit:n}),e.yearSplits.push({year:r,rawSplit:n,roundedSplit:0,adjustment:0})}let r=s.map(e=>({...e,roundedSplit:el(e.rawSplit,2)}));r.forEach(t=>{let a=e.yearSplits.find(e=>e.year===t.year);a&&(a.roundedSplit=t.roundedSplit)});let n=el(r.reduce((e,t)=>e+t.roundedSplit,0),2);e.discrepancy=el(a-n,2);let o={};r.forEach(e=>{o[e.year]={splitAmount:e.roundedSplit}});let d=el(r.reduce((e,t)=>e+t.roundedSplit,0),2);e.finalSum=d,i.push({originalAmount:a,adjustedTotalAmount:d,splits:o}),t.amountCalculations.push(e)}let d=Object.entries(l).map(e=>{let[t,a]=e,s=Number(t),r=0;return i.forEach(e=>{var t;r+=(null==(t=e.splits[s])?void 0:t.splitAmount)||0}),{year:s,daysInYear:a.days,proportion:a.proportion,totalSplitAmount:el(r,2)}}).sort((e,t)=>e.year-t.year);return{totalDays:n,originalTotalAmount:a,adjustedTotalAmount:el(d.reduce((e,t)=>e+t.totalSplitAmount,0),2),resultsPerAmount:i,aggregatedSplits:d,calculationSteps:t}}(s);console.log("Calculation Results:",e),setTimeout(()=>{var t;(null==(t=e.calculationSteps)?void 0:t.error)?(n(a,null,e.calculationSteps.error),x(l("InvoiceForm.calculateButton"))):e.aggregatedSplits&&0!==e.aggregatedSplits.length?(n(a,e),x(l("InvoiceForm.calculationComplete",{defaultValue:"Calculation Complete ✅"})),g(!0),setTimeout(()=>{x(l("InvoiceForm.calculateButton")),g(!1)},2e3)):(n(a,null,"Calculation completed but resulted in no splits."),x(l("InvoiceForm.calculateButton"))),u(!1)},500)}catch(e){console.error("Calculation Error:",e),n(a,null,e instanceof Error?e.message:"An unexpected error occurred during calculation."),setTimeout(()=>{u(!1),x(l("InvoiceForm.calculateButton"))},500)}}let _=e=>{if(e){let t=(0,ee.o)(e);b.setValue("startDate",t,{shouldValidate:!0}),D((0,en.GP)(t,j))}else b.setValue("startDate",void 0,{shouldValidate:!0}),D("");E(!1)},T=e=>{if(e){let t=(0,ee.o)(e);b.setValue("endDate",t,{shouldValidate:!0}),C((0,en.GP)(t,j))}else b.setValue("endDate",void 0,{shouldValidate:!0}),C("");P(!1)};return i?(0,s.jsxs)(eo,{className:"w-full",children:[(0,s.jsx)(ei,{className:"pt-6 px-6",children:(0,s.jsx)(Y.Op,{...b,children:(0,s.jsxs)("form",{onSubmit:b.handleSubmit(R),className:"space-y-6",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h2",{className:"text-xl font-semibold mb-8",children:l("InvoiceForm.title")})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)(H,{control:b.control,name:"startDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(J,{className:"flex flex-col",children:[(0,s.jsx)(eF,{children:l("InvoiceForm.startDateLabel")}),(0,s.jsxs)(eu,{open:A,onOpenChange:E,children:[(0,s.jsx)(X,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(eN,{placeholder:j,value:S,onChange:e=>z(e,"startDate"),className:"pr-10 transition-transform duration-150 focus:scale-[1.01] ".concat(b.formState.errors.startDate?"border-destructive focus:border-destructive focus:ring-2 focus:ring-destructive/20":"focus:border-primary focus:ring-2 focus:ring-primary/20"),autoFocus:!0}),(0,s.jsxs)("div",{className:"absolute right-10 top-1/2 -translate-y-1/2 flex items-center justify-center",children:[t.value&&!b.formState.errors.startDate&&(0,s.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,s.jsx)(L.A,{className:"h-4 w-4 text-green-500 animate-fadeIn"})}),b.formState.errors.startDate&&(0,s.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,s.jsx)(M.A,{className:"h-4 w-4 text-destructive animate-fadeIn"})})]}),(0,s.jsx)(em,{asChild:!0,children:(0,s.jsx)(h,{type:"button",variant:"ghost",className:"absolute right-0 top-1/2 -translate-y-1/2 h-8 w-8 p-0 flex items-center justify-center",tabIndex:-1,"aria-label":"Pick a date",children:(0,s.jsx)(V.A,{className:"h-4 w-4 opacity-50"})})})]})}),(0,s.jsx)(ex,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(ey,{mode:"single",selected:t.value,onSelect:_,initialFocus:!0,locale:v})})]}),(0,s.jsx)(eP,{})]})}}),(0,s.jsx)(H,{control:b.control,name:"endDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(J,{className:"flex flex-col",children:[(0,s.jsx)(eF,{children:l("InvoiceForm.endDateLabel")}),(0,s.jsxs)(eu,{open:F,onOpenChange:P,children:[(0,s.jsx)(X,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(eN,{placeholder:j,value:k,onChange:e=>z(e,"endDate"),className:"pr-10 transition-transform duration-150 focus:scale-[1.01] ".concat(b.formState.errors.endDate?"border-destructive focus:border-destructive focus:ring-2 focus:ring-destructive/20":"focus:border-primary focus:ring-2 focus:ring-primary/20")}),(0,s.jsxs)("div",{className:"absolute right-10 top-1/2 -translate-y-1/2 flex items-center justify-center",children:[t.value&&!b.formState.errors.endDate&&(0,s.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,s.jsx)(L.A,{className:"h-4 w-4 text-green-500 animate-fadeIn"})}),b.formState.errors.endDate&&(0,s.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,s.jsx)(M.A,{className:"h-4 w-4 text-destructive animate-fadeIn"})})]}),(0,s.jsx)(em,{asChild:!0,children:(0,s.jsx)(h,{type:"button",variant:"ghost",className:"absolute right-0 top-1/2 -translate-y-1/2 h-8 w-8 p-0 flex items-center justify-center",tabIndex:-1,"aria-label":"Pick a date",children:(0,s.jsx)(V.A,{className:"h-4 w-4 opacity-50"})})})]})}),(0,s.jsx)(ex,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(ey,{mode:"single",selected:t.value,onSelect:T,initialFocus:!0,locale:v})})]}),(0,s.jsx)(eP,{})]})}})]}),(0,s.jsx)(H,{control:b.control,name:"includeEndDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(J,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(eF,{className:"text-base",children:l("InvoiceForm.includeEndDateLabel")}),(0,s.jsx)(Q,{children:l("InvoiceForm.includeEndDateDescription")})]}),(0,s.jsx)(X,{children:(0,s.jsx)(eS,{checked:t.value,onCheckedChange:t.onChange})})]})}}),(0,s.jsxs)("div",{className:"space-y-5 rounded-lg border p-6 shadow-xs",children:[(0,s.jsx)(eF,{className:"text-base",children:l("InvoiceForm.amountsLabel")}),(0,s.jsx)(Q,{children:l("InvoiceForm.amountsDescription")}),y.map((e,t)=>(0,s.jsx)(H,{control:b.control,name:"amounts.".concat(t,".value"),render:e=>{var a,r;let{field:n}=e;return(0,s.jsxs)(J,{className:"mb-3",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsxs)(eF,{className:"text-sm font-medium",children:["#",t+1]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(X,{children:(0,s.jsx)(eN,{type:"number",step:"any",className:"focus:border-primary focus:ring-2 focus:ring-primary/20 transition-transform duration-150 focus:scale-[1.01] pr-8",...n})}),(0,s.jsxs)("div",{className:"absolute right-2 top-0 h-full flex items-center justify-center",children:[n.value&&!isNaN(parseFloat(n.value))&&parseFloat(n.value)>0&&(0,s.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,s.jsx)(L.A,{className:"h-4 w-4 text-green-500 animate-fadeIn"})}),(null==(r=b.formState.errors.amounts)||null==(a=r[t])?void 0:a.value)&&(0,s.jsx)("div",{className:"flex items-center justify-center h-5 w-5",children:(0,s.jsx)(M.A,{className:"h-4 w-4 text-destructive animate-fadeIn"})})]})]}),y.length>1&&(0,s.jsx)(h,{type:"button",variant:"ghost",size:"icon",onClick:()=>w(t),className:"text-gray-400 hover:text-gray-500 hover:bg-gray-100 transition-all duration-200 shrink-0","aria-label":"Remove amount",children:(0,s.jsx)(B.A,{className:"h-4 w-4 transition-transform duration-150 hover:scale-95"})})]})]}),(0,s.jsx)(eP,{})]})}},e.id)),(0,s.jsxs)(h,{type:"button",variant:"outline",size:"sm",onClick:()=>{N({value:""}),setTimeout(()=>{let e=document.querySelectorAll('input[type="number"]');e.length>0&&e[e.length-1].focus()},10)},className:"mt-4",children:[(0,s.jsx)(O.A,{className:"mr-2 h-4 w-4"})," ",l("InvoiceForm.addAmountButton")]}),b.formState.errors.amounts&&!b.formState.errors.amounts.root&&b.formState.errors.amounts.message&&(0,s.jsx)("p",{className:"text-sm font-medium text-destructive",children:b.formState.errors.amounts.message}),(null==(a=b.formState.errors.amounts)||null==(t=a.root)?void 0:t.message)&&(0,s.jsx)("p",{className:"text-sm font-medium text-destructive",children:b.formState.errors.amounts.root.message})]})]})})}),(0,s.jsx)(ed,{className:"flex justify-start px-6 py-6",children:(0,s.jsx)(h,{type:"submit",onClick:b.handleSubmit(R),disabled:b.formState.isSubmitting||c,className:"bg-primary text-white hover:bg-primary/90 hover:scale-[1.02] px-6 py-2 h-11 font-medium rounded-md shadow-sm transition-all duration-200 hover:shadow-lg hover:shadow-primary/20 ".concat(p?"animate-success-glow":""),children:c?(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(G.A,{className:"mr-2 h-4 w-4 animate-spin"}),m]}):m})})]}):(0,s.jsx)("div",{className:"space-y-8 h-[400px]"})}var ez=a(60760),eR=a(25561),e_=a(9449);function eT(e){let{...t}=e;return(0,s.jsx)(e_.bL,{"data-slot":"dropdown-menu",...t})}function eL(e){let{...t}=e;return(0,s.jsx)(e_.l9,{"data-slot":"dropdown-menu-trigger",...t})}function eM(e){let{className:t,sideOffset:a=4,...r}=e;return(0,s.jsx)(e_.ZL,{children:(0,s.jsx)(e_.UC,{"data-slot":"dropdown-menu-content",sideOffset:a,className:i("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...r})})}function eV(e){let{className:t,inset:a,variant:r="default",...n}=e;return(0,s.jsx)(e_.q7,{"data-slot":"dropdown-menu-item","data-inset":a,"data-variant":r,className:i("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-pointer items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n})}var eB=a(34869),eO=a(71568);function eG(){let{i18n:e}=(0,I.Bd)(),[t,a]=(0,r.useState)(!1),[n,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{a(!0)},[]);let o=t=>{e.changeLanguage(t),l(!1)};if(!t)return null;let i="en"===e.language,d="de"===e.language;return(0,s.jsxs)(eT,{open:n,onOpenChange:l,children:[(0,s.jsx)(eL,{asChild:!0,children:(0,s.jsxs)(h,{variant:"ghost",size:"icon",className:"flex items-center",children:[(0,s.jsx)(eB.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle language"})]})}),(0,s.jsx)(ez.N,{children:n&&(0,s.jsx)(eM,{asChild:!0,forceMount:!0,children:(0,s.jsxs)(eR.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:[(0,s.jsxs)(eV,{onClick:()=>o("en"),children:[(0,s.jsx)(eO.A,{countryCode:"GB",svg:!0,style:{width:"1.2em",height:"1.2em",marginRight:"0.5rem"},title:"English"}),(0,s.jsx)("span",{className:i?"font-bold":"",children:"English"})]}),(0,s.jsxs)(eV,{onClick:()=>o("de"),children:[(0,s.jsx)(eO.A,{countryCode:"DE",svg:!0,style:{width:"1.2em",height:"1.2em",marginRight:"0.5rem"},title:"Deutsch"}),(0,s.jsx)("span",{className:d?"font-bold":"",children:"Deutsch"})]})]})})})]})}var eY=a(90792);function eW(e){let{isOpen:t,onOpenChange:a,title:r,content:n}=e,{t:l}=(0,I.Bd)();return(0,s.jsx)(j,{open:t,onOpenChange:a,children:(0,s.jsxs)(w,{className:"max-w-3xl max-h-[80vh] overflow-hidden flex flex-col",children:[(0,s.jsx)(S,{children:(0,s.jsx)(k,{className:"text-xl font-semibold",children:r})}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground mb-2",children:l("General.lastUpdated",{date:"April 25, 2025"})}),(0,s.jsx)("div",{className:"overflow-y-auto pr-6 -mr-6 pb-4 text-sm",children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)(eY.oz,{components:{h1:e=>{let{...t}=e;return(0,s.jsx)("h1",{className:"text-2xl font-bold my-4",...t})},h2:e=>{let{...t}=e;return(0,s.jsx)("h2",{className:"text-xl font-bold my-3",...t})},h3:e=>{let{...t}=e;return(0,s.jsx)("h3",{className:"text-lg font-bold my-2",...t})},p:e=>{let{...t}=e;return(0,s.jsx)("p",{className:"mb-3 leading-relaxed",...t})},ul:e=>{let{...t}=e;return(0,s.jsx)("ul",{className:"list-disc pl-6 mb-3",...t})},ol:e=>{let{...t}=e;return(0,s.jsx)("ol",{className:"list-decimal pl-6 mb-3",...t})},li:e=>{let{...t}=e;return(0,s.jsx)("li",{className:"mb-1",...t})},a:e=>{let{...t}=e;return(0,s.jsx)("a",{className:"text-primary hover:underline",target:"_blank",rel:"noopener noreferrer",...t})}},children:n||""})})}),(0,s.jsx)("div",{className:"flex justify-end mt-4",children:(0,s.jsx)(h,{onClick:()=>a(!1),children:l("SettingsModal.closeButton")})})]})})}var eq=a(3925),eH=a(23478),eU=a(66474);function eZ(e){let{...t}=e;return(0,s.jsx)(eH.bL,{"data-slot":"accordion",...t})}function eJ(e){let{className:t,...a}=e;return(0,s.jsx)(eH.q7,{"data-slot":"accordion-item",className:i("border-b last:border-b-0",t),...a})}function eK(e){let{className:t,children:a,...r}=e;return(0,s.jsx)(eH.Y9,{className:"flex",children:(0,s.jsxs)(eH.l9,{"data-slot":"accordion-trigger",className:i("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",t),...r,children:[a,(0,s.jsx)(eU.A,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function eX(e){let{className:t,children:a,...r}=e;return(0,s.jsx)(eH.UC,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...r,children:(0,s.jsx)("div",{className:i("pt-0 pb-4",t),children:a})})}var eQ=a(64261),e$=a(57434);function e0(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:i("w-full caption-bottom text-sm",t),...a})})}function e1(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:i("[&_tr]:border-b",t),...a})}function e2(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:i("[&_tr:last-child]:border-0",t),...a})}function e5(e){let{className:t,...a}=e;return(0,s.jsx)("tfoot",{"data-slot":"table-footer",className:i("bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",t),...a})}function e4(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:i("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function e6(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:i("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function e3(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:i("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}var e8=a(76118),e9=a(26597),e7=a(424);function te(e,t,a){if(null==e||isNaN(e))return"";let s=new Intl.NumberFormat(t,{minimumFractionDigits:a.decimalPlaces,maximumFractionDigits:a.decimalPlaces,useGrouping:!0}).format(e),r=t.startsWith("de")?".":",";return a.thousandsSeparator&&a.thousandsSeparator!==r&&(s=s.replace(RegExp("\\".concat(r),"g"),a.thousandsSeparator)),s}let tt=e=>{let{steps:t,settings:a}=e,{t:r,i18n:n}=(0,I.Bd)(),l=n.language;if(t.error)return(0,s.jsx)("p",{className:"text-destructive",children:t.error});let{yearSegments:o,amountCalculations:i}=t,d=e=>te(e,l,a);return(0,s.jsx)("div",{className:"text-sm space-y-6",children:(0,s.jsx)("section",{className:"bg-muted/40 rounded-lg p-4",children:(0,s.jsx)("div",{className:"space-y-6",children:i.map((e,t)=>(0,s.jsxs)("div",{className:"rounded-md border bg-background p-4 space-y-2 transition-shadow hover:shadow-md",children:[(0,s.jsxs)("div",{className:"font-bold text-[15px] text-primary mb-3 pb-1 border-b border-primary/20 bg-primary/[0.08] -mx-4 px-4 py-2 rounded-t-md",children:[r("ResultsDisplay.inputAmountLabel")," #",t+1,": ",d(e.originalAmount)]}),(0,s.jsx)("div",{className:"space-y-3",children:e.yearSplits.map((t,a)=>{var n;return(0,s.jsxs)("div",{className:"pl-2 text-xs space-y-0.5 ".concat(a<e.yearSplits.length-1?"border-b border-muted/30 pb-2":""),children:[(0,s.jsxs)("div",{className:"font-medium shrink-0 text-foreground",children:[t.year,":"]}),(0,s.jsxs)("div",{className:"text-muted-foreground ml-2",children:[(0,s.jsxs)("span",{children:[d(e.originalAmount)," * ",null==(n=o.find(e=>e.year===t.year))?void 0:n.proportion.toFixed(6)]}),(0,s.jsxs)("span",{className:"block sm:inline",children:[" = ",t.rawSplit.toFixed(6)]})]}),(0,s.jsxs)("div",{className:"ml-2 flex items-center gap-x-2",children:[(0,s.jsx)("span",{children:"→"}),(0,s.jsxs)("span",{className:"font-medium text-foreground",children:[r("ResultsDisplay.roundedLabel"),": ",d(t.roundedSplit)]}),0!==t.adjustment&&(0,s.jsxs)("span",{className:"text-muted-foreground text-xs",children:["(",r("ResultsDisplay.adjustmentLabel"),": ",d(t.adjustment),")"]})]})]},t.year)})}),(0,s.jsxs)("div",{className:"border-t pt-2 mt-2 space-y-1 text-xs",children:[(0,s.jsxs)("p",{children:[(0,s.jsxs)("span",{className:"font-medium text-foreground",children:[r("ResultsDisplay.discrepancyLabel"),":"]}),(0,s.jsxs)("span",{className:"".concat(Math.abs(e.discrepancy)>.001?"text-amber-600 dark:text-amber-500":"text-muted-foreground/70"),children:[" ",d(e.discrepancy)]}),e.adjustmentAppliedToYear&&(0,s.jsxs)("span",{className:"text-muted-foreground",children:["(",r("ResultsDisplay.adjustedInYearLabel")," ",e.adjustmentAppliedToYear,")"]})]}),(0,s.jsxs)("p",{className:"font-semibold text-sm text-foreground pt-1",children:[r("ResultsDisplay.finalSumLabel"),": ",(0,s.jsx)("span",{className:"text-primary",children:d(e.finalSum)})]})]})]},t))})})})};function ta(e){let{results:t,inputData:a}=e,{settings:n}=(0,e7.t)(),{t:l,i18n:o}=(0,I.Bd)(),i=o.language,{totalDays:d,originalTotalAmount:c,adjustedTotalAmount:u,resultsPerAmount:m,aggregatedSplits:x,calculationSteps:p}=t,[,g]=(0,r.useState)(0);(0,r.useEffect)(()=>{let e=()=>{g(e=>e+1)};return window.addEventListener("settingsChanged",e),()=>{window.removeEventListener("settingsChanged",e)}},[]);let f=e=>{var t;return te((t=n.roundingPrecision)&&!(t<=0)?Math.round(e/t)*t:e,i,n)},v=e=>null==e||isNaN(e)?"":new Intl.NumberFormat(i,{minimumFractionDigits:2,maximumFractionDigits:2}).format(100*e)+"%",j=e=>(0,en.GP)(e,"yyyy-MM-dd"),b=e=>(function(e,t){if(!e)return"";try{let a=new Date(e+"T00:00:00Z");if(isNaN(a.getTime()))return e;return new Intl.DateTimeFormat(t,{year:"numeric",month:"numeric",day:"numeric"}).format(a)}catch(t){return console.error("Error formatting date:",t),e}})((0,en.GP)(e,"yyyy-MM-dd"),i),y=Math.abs(c-u)>n.roundingPrecision/2+1e-5,N=[l("ResultsDisplay.yearHeader"),l("ResultsDisplay.daysHeader"),l("ResultsDisplay.proportionHeader")];a.amounts.forEach((e,t)=>{N.push("".concat(l("ResultsDisplay.amountHeader")," #").concat(t+1))}),N.push(l("ResultsDisplay.yearTotalHeader"));let w=x.map(e=>{let t=[e.year,e.daysInYear,v(e.proportion)];return m.forEach(a=>{var s;let r=(null==(s=a.splits[e.year])?void 0:s.splitAmount)||0;t.push(f(r))}),t.push(f(e.totalSplitAmount)),t}),S=[l("ResultsDisplay.totalHeader"),d,v(1)];return m.forEach(e=>{S.push(f(e.adjustedTotalAmount))}),S.push(f(u)),(0,s.jsxs)(eo,{className:"w-full",children:[(0,s.jsxs)(ei,{className:"space-y-6 pt-6 px-6",children:[(0,s.jsx)(()=>(0,s.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-md p-3 mb-6 flex items-center text-green-700 dark:text-green-400 animate-fadeIn",children:[(0,s.jsx)("span",{className:"mr-2 text-lg",children:"✅"}),(0,s.jsx)("span",{children:l("ResultsDisplay.successMessage",{defaultValue:"Split completed successfully! Your detailed allocation is ready."})})]}),{}),(0,s.jsxs)("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"font-medium text-lg mb-2",children:l("ResultsDisplay.summaryTitle",{defaultValue:"Summary"})}),(0,s.jsxs)("div",{className:"grid gap-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:l("ResultsDisplay.periodLabel")}),(0,s.jsxs)("span",{className:"font-medium",children:[b(a.startDate)," – ",b(a.endDate)]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:[l("ResultsDisplay.totalDays"),":"]}),(0,s.jsxs)("span",{className:"font-medium",children:[d," ",l("ResultsDisplay.daysLabel")]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:l("InvoiceForm.includeEndDateLabel")}),(0,s.jsx)("span",{className:"font-medium",children:a.includeEndDate?l("ResultsDisplay.yesLabel",{defaultValue:"Yes"}):l("ResultsDisplay.noLabel",{defaultValue:"No"})})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center border-t border-primary/10 pt-2 mt-1",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:l("ResultsDisplay.originalTotalLabel")}),(0,s.jsx)("span",{className:"font-semibold text-primary",children:f(u)})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:l("ResultsDisplay.aggregatedTitle")}),(0,s.jsxs)("div",{className:"block md:hidden space-y-3",children:[x.map(e=>(0,s.jsxs)("div",{className:"border rounded-md p-3 text-sm bg-muted/20",children:[(0,s.jsx)("div",{className:"font-semibold text-base mb-1",children:e.year}),(0,s.jsxs)("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-0.5",children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:[l("ResultsDisplay.daysHeader"),":"]}),(0,s.jsx)("span",{className:"text-right",children:e.daysInYear}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:[l("ResultsDisplay.proportionHeader"),":"]}),(0,s.jsx)("span",{className:"text-right",children:(0,s.jsxs)("div",{className:"relative inline-block min-w-[100px] px-2 py-0.5",children:[(0,s.jsx)("div",{className:"absolute left-0 top-0 bottom-0 bg-primary/20 rounded-sm",style:{width:"".concat(100*e.proportion,"%"),maxWidth:"100%"}}),(0,s.jsx)("span",{className:"relative z-10",children:v(e.proportion)})]})}),m.map((t,a)=>{var n;let o=(null==(n=t.splits[e.year])?void 0:n.splitAmount)||0;return(0,s.jsxs)(r.Fragment,{children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:["".concat(l("ResultsDisplay.amountHeader")," #").concat(a+1),":"]}),(0,s.jsx)("span",{className:"text-right",children:f(o)})]},a)}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:[l("ResultsDisplay.yearTotalHeader"),":"]}),(0,s.jsx)("span",{className:"text-right font-medium",children:f(e.totalSplitAmount)})]})]},e.year)),(0,s.jsx)("div",{className:"border-t pt-3 mt-3 text-sm",children:(0,s.jsxs)("div",{className:"border rounded-md p-3 bg-muted/20 font-semibold",children:[(0,s.jsx)("div",{className:"font-semibold text-base mb-1",children:l("ResultsDisplay.totalHeader")}),(0,s.jsxs)("div",{className:"grid grid-cols-[auto_1fr] gap-x-2 gap-y-0.5",children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:[l("ResultsDisplay.daysHeader"),":"]}),(0,s.jsx)("span",{className:"text-right",children:d}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:[l("ResultsDisplay.proportionHeader"),":"]}),(0,s.jsx)("span",{className:"text-right",children:(0,s.jsxs)("div",{className:"relative inline-block min-w-[100px] px-2 py-0.5",children:[(0,s.jsx)("div",{className:"absolute left-0 top-0 bottom-0 bg-primary/20 rounded-sm",style:{width:"100%",maxWidth:"100%"}}),(0,s.jsx)("span",{className:"relative z-10",children:v(1)})]})}),m.map((e,t)=>(0,s.jsxs)(r.Fragment,{children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:["".concat(l("ResultsDisplay.amountHeader")," #").concat(t+1),":"]}),(0,s.jsx)("span",{className:"text-right",children:f(e.adjustedTotalAmount)})]},t)),(0,s.jsxs)("span",{className:"text-muted-foreground",children:[l("ResultsDisplay.yearTotalHeader"),":"]}),(0,s.jsx)("span",{className:"text-right",children:f(u)})]})]})})]}),(0,s.jsx)("div",{className:"hidden md:block overflow-x-auto relative border rounded-md",children:(0,s.jsxs)(e0,{children:[(0,s.jsx)(e1,{children:(0,s.jsx)(e4,{children:N.map((e,t)=>(0,s.jsx)(e6,{className:t>0?"text-right":"text-left",children:e},e))})}),(0,s.jsx)(e2,{children:w.map((e,t)=>(0,s.jsx)(e4,{children:e.map((e,t)=>(0,s.jsx)(e3,{className:"".concat(t>0?"text-right":"text-left"),children:2===t?(0,s.jsxs)("div",{className:"relative px-3 py-1 h-8 flex items-center justify-end",children:[(0,s.jsx)("div",{className:"absolute left-0 top-0 bottom-0 bg-primary/20 rounded-sm",style:{width:"".concat("string"==typeof e?parseFloat(e.replace(/[^0-9.]/g,"")):0,"%"),maxWidth:"100%"}}),(0,s.jsx)("span",{className:"relative z-10",children:e})]}):e},t))},t))}),(0,s.jsx)(e5,{children:(0,s.jsx)(e4,{className:"bg-gray-50 dark:bg-gray-800/50",children:S.map((e,t)=>(0,s.jsx)(e3,{className:"font-bold ".concat(t>0?"text-right":""),children:2===t?(0,s.jsxs)("div",{className:"relative px-3 py-1 h-8 flex items-center justify-end",children:[(0,s.jsx)("div",{className:"absolute left-0 top-0 bottom-0 bg-primary/20 rounded-sm",style:{width:"100%",maxWidth:"100%"}}),(0,s.jsx)("span",{className:"relative z-10",children:e})]}):e},t))})})]})}),y&&(0,s.jsx)("p",{className:"text-xs text-amber-600 dark:text-amber-500 mt-1",children:l("ResultsDisplay.roundingNote")})]}),p&&(0,s.jsx)(eZ,{type:"single",collapsible:!0,className:"w-full",children:(0,s.jsxs)(eJ,{value:"item-1",children:[(0,s.jsx)(eK,{children:l("ResultsDisplay.calculationStepsTitle")}),(0,s.jsx)(eX,{children:(0,s.jsx)(tt,{steps:p,settings:n})})]})})]}),(0,s.jsxs)(ed,{className:"flex flex-col sm:flex-row justify-start gap-4 px-6 py-6",children:[(0,s.jsxs)(h,{variant:"outline",onClick:()=>{let e=eq.Wp.book_new(),t=a.amounts.map(e=>f(e)).join(", "),s=[[l("ResultsDisplay.inputSummary",{defaultValue:"Input Summary"})],[],[l("InvoiceForm.startDateLabel"),b(a.startDate)],[l("InvoiceForm.endDateLabel"),b(a.endDate)],[l("InvoiceForm.includeEndDateLabel"),a.includeEndDate?l("ResultsDisplay.yesLabel",{defaultValue:"Yes"}):l("ResultsDisplay.noLabel",{defaultValue:"No"})],[l("ResultsDisplay.totalDurationLabel",{defaultValue:"Total Duration (days)"}),d],[l("InvoiceForm.amountsLabel"),t],[l("ResultsDisplay.originalTotalAmountLabel",{defaultValue:"Original Total Amount"}),f(c)]],r=eq.Wp.aoa_to_sheet(s);r["!cols"]=[{wch:25},{wch:20}],eq.Wp.book_append_sheet(e,r,l("ResultsDisplay.inputSummarySheetName",{defaultValue:"Input Summary"}));let n=[[l("ResultsDisplay.aggregatedTitle")],[],N,...w,[],S],o=eq.Wp.aoa_to_sheet(n),i=[{wch:10},{wch:10},{wch:15},...a.amounts.map(()=>({wch:15})),{wch:15}];o["!cols"]=i,eq.Wp.book_append_sheet(e,o,l("ResultsDisplay.aggregatedSheetName",{defaultValue:"Allocation Results"})),eq._h(e,"invoice_split_".concat(j(new Date),".xlsx"))},className:"w-full sm:w-auto h-11 px-4",children:[(0,s.jsx)(eQ.A,{className:"mr-2 h-4 w-4"}),l("ResultsDisplay.exportExcelButton")]}),(0,s.jsxs)(h,{variant:"outline",onClick:()=>{let e=new e9.Ay,t=l("ResultsDisplay.pdfTitle",{defaultValue:"Invoice Split Calculation"}),s="".concat(l("ResultsDisplay.periodLabel")," ").concat(b(a.startDate)," to ").concat(b(a.endDate)," (").concat(a.includeEndDate?l("ResultsDisplay.inclusiveLabel"):l("ResultsDisplay.exclusiveLabel"),", ").concat(d," ").concat(l("ResultsDisplay.daysLabel"),")"),r="".concat(l("ResultsDisplay.originalTotalLabel")," ").concat(f(c));e.setFontSize(16),e.text(t,14,20),e.setFontSize(10),e.text(s,14,26),e.text(r,14,30),e.setFontSize(12),e.text(l("ResultsDisplay.aggregatedTitle"),14,40),(0,e8.Ay)(e,{startY:42,head:[N],body:w,foot:[S],theme:"grid",headStyles:{fillColor:[41,128,185],textColor:255},footStyles:{fillColor:[220,220,220],textColor:0,fontStyle:"bold"},styles:{fontSize:9,cellPadding:1.5},columnStyles:{2:{halign:"right"},...N.reduce((e,t,a)=>(a>2&&(e[a]={halign:"right"}),e),{})}}),e.save("invoice_split_".concat(j(new Date),".pdf"))},className:"w-full sm:w-auto h-11 px-4",children:[(0,s.jsx)(e$.A,{className:"mr-2 h-4 w-4"}),l("ResultsDisplay.exportPdfButton")]})]})]})}var ts=a(14582),tr=a(5196),tn=a(47863);function tl(e){let{...t}=e;return(0,s.jsx)(ts.bL,{"data-slot":"select",...t})}function to(e){let{...t}=e;return(0,s.jsx)(ts.WT,{"data-slot":"select-value",...t})}function ti(e){let{className:t,size:a="default",children:r,...n}=e;return(0,s.jsxs)(ts.l9,{"data-slot":"select-trigger","data-size":a,className:i("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[r,(0,s.jsx)(ts.In,{asChild:!0,children:(0,s.jsx)(eU.A,{className:"size-4 opacity-50"})})]})}function td(e){let{className:t,children:a,position:r="popper",...n}=e;return(0,s.jsx)(ts.ZL,{children:(0,s.jsxs)(ts.UC,{"data-slot":"select-content",className:i("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,s.jsx)(tu,{}),(0,s.jsx)(ts.LM,{className:i("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(tm,{})]})})}function tc(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(ts.q7,{"data-slot":"select-item",className:i("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(ts.VF,{children:(0,s.jsx)(tr.A,{className:"size-4"})})}),(0,s.jsx)(ts.p4,{children:a})]})}function tu(e){let{className:t,...a}=e;return(0,s.jsx)(ts.PP,{"data-slot":"select-scroll-up-button",className:i("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(tn.A,{className:"size-4"})})}function tm(e){let{className:t,...a}=e;return(0,s.jsx)(ts.wn,{"data-slot":"select-scroll-down-button",className:i("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(eU.A,{className:"size-4"})})}let tx=e=>{let{children:t,...a}=e;return(0,s.jsx)(K,{...a,style:{color:"var(--foreground)",fontWeight:500},children:t})},tp=e=>{let{className:t,...a}=e;return(0,s.jsx)($,{className:i("text-destructive text-sm",t),...a})},th=e=>{let{className:t,...a}=e,{error:r}=U();return r?null:(0,s.jsx)(Q,{className:t,...a})},tg=e=>{let{className:t,...a}=e;return(0,s.jsx)(J,{className:t,...a})},tf=eD.Ik({decimalPlaces:eD.Yj().nonempty("Decimal places is required"),roundingPrecision:eD.Yj().nonempty("Rounding precision is required"),thousandsSeparator:eD.Yj(),locale:eD.Yj()});function tv(e){var t,a;let{isOpen:n,onOpenChange:l}=e,{settings:o,saveSettings:i}=(0,e7.t)(),{t:d,i18n:c}=(0,I.Bd)(),[u,m]=(0,r.useState)(!0),x=(0,Y.mN)({resolver:(0,ek.u)(tf),defaultValues:{decimalPlaces:(null==(t=o.decimalPlaces)?void 0:t.toString())||"",roundingPrecision:(null==(a=o.roundingPrecision)?void 0:a.toString())||"0.01",thousandsSeparator:o.thousandsSeparator||",",locale:c.language||"en-US"},mode:"onChange"});(0,r.useEffect)(()=>{if(n){var e,t;x.reset({decimalPlaces:(null==(e=o.decimalPlaces)?void 0:e.toString())||"",roundingPrecision:(null==(t=o.roundingPrecision)?void 0:t.toString())||"0.01",thousandsSeparator:o.thousandsSeparator||",",locale:c.language||"en-US"})}},[n,o,c.language,x,","]),(0,r.useEffect)(()=>{let e=x.watch(()=>{let e=!!Object.keys(x.formState.errors).length,t=x.getValues(),a=!t.decimalPlaces||""===t.decimalPlaces;m(!e&&!a)});return()=>e.unsubscribe()},[x]);let p=x.watch("thousandsSeparator")||",";return(0,s.jsx)(j,{open:n,onOpenChange:e=>{if(!e){var t,a;x.reset({decimalPlaces:(null==(t=o.decimalPlaces)?void 0:t.toString())||"",roundingPrecision:(null==(a=o.roundingPrecision)?void 0:a.toString())||"0.01",thousandsSeparator:o.thousandsSeparator||",",locale:c.language||"en-US"})}l(e)},children:(0,s.jsxs)(w,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(S,{children:[(0,s.jsx)(k,{children:d("SettingsModal.settingsModalTitle")}),(0,s.jsx)(C,{children:d("SettingsModal.settingsModalDescription")})]}),(0,s.jsx)(W,{...x,children:(0,s.jsxs)("form",{onSubmit:x.handleSubmit(function(e){let t=Number(e.decimalPlaces);if(isNaN(t)||t<0||t>6)return void x.setError("decimalPlaces",{type:"manual",message:"Decimal places must be between 0 and 6"});let a=Number(e.roundingPrecision.replace(",","."));if(isNaN(a)||a<1e-4||a>100)return void x.setError("roundingPrecision",{type:"manual",message:"Rounding precision must be between 0.0001 and 100"});let s={decimalPlaces:t,roundingPrecision:a,thousandsSeparator:e.thousandsSeparator||",",locale:e.locale},r=e.locale;r&&c.language!==r&&c.changeLanguage(r),i(s),window.dispatchEvent(new CustomEvent("settingsChanged",{detail:{settings:s}})),l(!1)}),className:"space-y-6",children:[(0,s.jsx)(H,{control:x.control,name:"decimalPlaces",render:e=>{let{field:t}=e;return(0,s.jsxs)(tg,{children:[(0,s.jsx)(tx,{children:d("SettingsModal.decimalPlacesLabel")}),(0,s.jsx)(X,{children:(0,s.jsx)(eN,{required:!0,...t})}),(0,s.jsx)(th,{children:d("SettingsModal.decimalPlacesDescription")}),(0,s.jsx)(tp,{})]})}}),(0,s.jsx)(H,{control:x.control,name:"roundingPrecision",render:e=>{let{field:t}=e;return(0,s.jsxs)(tg,{children:[(0,s.jsx)(tx,{children:d("SettingsModal.roundingPrecisionLabel")}),(0,s.jsx)(X,{children:(0,s.jsx)(eN,{required:!0,...t})}),(0,s.jsx)(th,{children:d("SettingsModal.roundingPrecisionDescription")}),(0,s.jsx)(tp,{})]})}}),(0,s.jsx)(H,{control:x.control,name:"thousandsSeparator",render:e=>{let{field:t}=e;return(0,s.jsxs)(tg,{children:[(0,s.jsx)(tx,{children:d("SettingsModal.thousandsSeparatorLabel")}),(0,s.jsxs)(tl,{onValueChange:e=>{t.onChange(e||",")},value:p,children:[(0,s.jsx)(X,{children:(0,s.jsx)(ti,{children:(0,s.jsx)(to,{children:","===p?"".concat(d("SettingsModal.comma")," (1,234.56)"):"."===p?"".concat(d("SettingsModal.period")," (1.234,56)"):"'"===p?"".concat(d("SettingsModal.apostrophe")," (1&apos;234.56)"):" "===p?"".concat(d("SettingsModal.space")," (1 234.56)"):d("SettingsModal.comma")})})}),(0,s.jsxs)(td,{children:[(0,s.jsxs)(tc,{value:",",children:[d("SettingsModal.comma")," (1,234.56)"]}),(0,s.jsxs)(tc,{value:".",children:[d("SettingsModal.period")," (1.234,56)"]}),(0,s.jsxs)(tc,{value:"'",children:[d("SettingsModal.apostrophe")," (1'234.56)"]}),(0,s.jsxs)(tc,{value:" ",children:[d("SettingsModal.space")," (1 234.56)"]})]})]}),(0,s.jsx)(th,{children:d("SettingsModal.thousandsSeparatorDescription")}),(0,s.jsx)(tp,{})]})}}),(0,s.jsx)(D,{className:"pt-4",children:(0,s.jsx)(h,{type:"submit",disabled:!u||x.formState.isSubmitting||Object.keys(x.formState.errors).length>0,children:d("SettingsModal.saveButton")})})]})})]})})}var tj=a(41684),tb=a(62098),ty=a(93509),tN=a(51362);function tw(){let{setTheme:e,theme:t}=(0,tN.D)(),{t:a}=(0,I.Bd)(),[n,l]=r.useState(!1);return(r.useEffect(()=>{l(!0),localStorage.getItem("theme")||e("system");let t=document.documentElement;return t.style.transition="background-color 0.5s, color 0.5s",()=>{t.style.transition=""}},[e]),n)?(0,s.jsxs)(eT,{children:[(0,s.jsx)(eL,{asChild:!0,children:(0,s.jsxs)(h,{variant:"ghost",size:"icon","aria-label":a("ThemeToggle.toggleTheme"),className:"text-foreground hover:text-primary",children:[(0,s.jsx)(tb.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,s.jsx)(ty.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,s.jsx)("span",{className:"sr-only",children:a("ThemeToggle.toggleTheme")})]})}),(0,s.jsxs)(eM,{align:"end",className:"rounded-lg shadow-md",children:[(0,s.jsx)(eV,{onClick:()=>e("light"),className:"cursor-pointer hover:text-primary ".concat("light"===t?"font-medium":""),children:a("ThemeToggle.light")}),(0,s.jsx)(eV,{onClick:()=>e("dark"),className:"cursor-pointer hover:text-primary ".concat("dark"===t?"font-medium":""),children:a("ThemeToggle.dark")}),(0,s.jsx)(eV,{onClick:()=>e("system"),className:"cursor-pointer hover:text-primary ".concat("system"===t?"font-medium":""),children:a("ThemeToggle.system")})]})]}):(0,s.jsxs)(h,{variant:"ghost",size:"icon",disabled:!0,"aria-label":"Toggle theme",children:[(0,s.jsx)(tb.A,{className:"h-[1.2rem] w-[1.2rem]"}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}function tS(){let{t:e,i18n:t}=(0,I.Bd)(),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)(null),[i,d]=(0,r.useState)(null),[x,p]=(0,r.useState)(null),[f,v]=(0,r.useState)(!1),[j,b]=(0,r.useState)(!1),[y,N]=(0,r.useState)(""),[w,S]=(0,r.useState)(null),[D,k]=(0,r.useState)(!1),C=(0,r.useRef)(null),A=(0,r.useRef)(null),E="G-9H2KTHX5YK",F="siempiBillSplitterConsent",[P,L]=(0,r.useState)(!1);(0,r.useEffect)(()=>{n(!0),L("true"===g.A.get(F))},[]),(0,r.useEffect)(()=>{if(!a||!(window.innerWidth>=1024))return;let e=()=>{let e=window.scrollY;A.current&&(A.current.style.transform="translateY(".concat(.02*e,"px)"))};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[a]);let M=async t=>{try{let e=await fetch(t);if(!e.ok&&t.includes(".de.md")){let a=t.replace(".de.md",".md");console.log("Localized version not found, trying English version: ".concat(a)),e=await fetch(a)}if(!e.ok)throw Error("Failed to fetch ".concat(t,": ").concat(e.statusText));return await e.text()}catch(t){return console.error("Error fetching markdown:",t),e("Errors.unexpectedError")}},V=async a=>{k(!0),b(!0);let s="",r="",n="de"===(t.language||"en")?".de":"";"privacy"===a?(s=e("General.privacyPolicy"),r="/privacy-policy".concat(n,".md")):(s=e("General.termsOfUse"),r="/terms-of-use".concat(n,".md")),N(s),S(await M(r)),k(!1)};return(0,s.jsxs)("div",{className:"flex flex-col grow",children:[(0,s.jsx)("div",{ref:A,className:"parallax-background"}),P&&E&&(0,s.jsx)(R.GoogleAnalytics,{gaId:E}),(0,s.jsxs)("header",{className:"w-full max-w-4xl flex justify-between items-center space-x-2 mb-8 px-4",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(T.default,{src:"/images/logo.svg",alt:"BillSplitter Logo",width:100,height:30})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eG,{}),(0,s.jsx)(h,{variant:"ghost",size:"icon",onClick:()=>v(!0),"aria-label":a?e("SettingsModal.title"):"Number Formatting",children:(0,s.jsx)(_.A,{className:"h-5 w-5"})}),(0,s.jsx)(tw,{})]})]}),(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl grow",children:[(0,s.jsx)("h1",{className:"text-3xl md:text-[42px] font-bold text-center mb-8",children:a?e("App.title","Automated Invoice Split Calculator — Accurate. Effortless. Compliant."):"Loading..."}),(0,s.jsx)("div",{className:"text-center text-muted-foreground mb-2 text-sm",children:a?e("App.tagline","Built for Finance Professionals"):"..."}),(0,s.jsx)("div",{className:"text-center text-muted-foreground mb-12 max-w-xl mx-auto space-y-2",children:(0,s.jsx)("p",{children:a?e("App.description","Split invoices across fiscal years... Compliant..."):"Loading description..."})}),(0,s.jsx)("div",{className:"w-full flex justify-center mt-12",children:(0,s.jsx)("div",{className:"w-[95%] sm:w-[90%] mx-auto max-w-[800px] shadow-sm rounded-xl",children:(0,s.jsx)(eI,{onCalculateAction:(t,a,s)=>{o(a),s&&s.includes("At least one amount is required")?d(e("Errors.calculationErrorTitle")+": "+e("InvoiceForm.errorAmountRequired")):s&&s.includes("Start date must be before")?d(e("Errors.calculationErrorTitle")+": "+e("InvoiceForm.errorEndDateBeforeStart")):d(s?e("Errors.calculationErrorTitle")+": "+e("Errors.unexpectedError"):null),a&&!s?(p(t),setTimeout(()=>{var e;null==(e=C.current)||e.scrollIntoView({behavior:"smooth",block:"start"}),C.current&&(C.current.classList.add("pulse-highlight"),setTimeout(()=>{var e;null==(e=C.current)||e.classList.remove("pulse-highlight")},1e3))},400)):p(null)}})})}),(0,s.jsxs)("div",{ref:C,id:"results-section",className:"mt-12 w-full flex justify-center",children:[a&&i&&(0,s.jsxs)(c,{variant:"destructive",className:"w-[95%] sm:w-[90%] mx-auto max-w-[800px] animate-fadeIn",children:[(0,s.jsx)(tj.A,{className:"h-4 w-4"}),(0,s.jsx)(u,{children:e("Errors.calculationErrorTitle")}),(0,s.jsx)(m,{children:i})]}),a&&l&&x&&!i&&(0,s.jsx)("div",{className:"w-[95%] sm:w-[90%] mx-auto max-w-[800px] shadow-sm rounded-xl animate-result-glow transition-all duration-150 ease-in-out",children:(0,s.jsx)(ta,{results:l,inputData:x})})]})]}),a&&(0,s.jsx)(tv,{isOpen:f,onOpenChange:v}),a&&(0,s.jsx)(eW,{isOpen:j,onOpenChange:b,title:y,content:D?e("FeedbackDialog.messagePlaceholder"):w}),(0,s.jsx)("footer",{className:"w-full border-t text-muted-foreground mt-2",children:(0,s.jsxs)("div",{className:"max-w-[1200px] mx-auto px-8 py-6 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-6",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center sm:items-start text-center sm:text-left",children:[(0,s.jsx)(T.default,{src:"/images/logo.svg",alt:"BillSplitter Logo",width:120,height:30,className:"mb-1",priority:!0}),(0,s.jsx)("span",{className:"text-sm mt-2 text-muted-foreground font-normal",children:"by Siempi AG"})]}),(0,s.jsxs)("nav",{className:"flex flex-col sm:flex-row items-center gap-4 sm:gap-4",children:[(0,s.jsx)("button",{onClick:()=>V("privacy"),className:"text-sm font-medium text-foreground/80 hover:text-foreground hover:underline transition-colors duration-200 cursor-pointer",children:e("General.privacyPolicy")}),(0,s.jsx)("button",{onClick:()=>V("terms"),className:"text-sm font-medium text-foreground/80 hover:text-foreground hover:underline transition-colors duration-200 cursor-pointer",children:e("General.termsOfUse")})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center sm:items-end text-center sm:text-right",children:[(0,s.jsx)(z,{variant:"outline",size:"sm",className:"h-8 text-sm font-medium border border-muted-foreground/30 bg-transparent"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground/75 mt-2",children:["\xa9 ",new Date().getFullYear()," Siempi AG — All rights reserved."]})]})]})}),(0,s.jsx)(function(e){let{onAccept:t,onDecline:a,consentCookieName:n,onOpenPrivacy:l}=e,{t:o}=(0,I.Bd)(),[i,d]=(0,r.useState)(!1),c=(0,r.useRef)(null);return((0,r.useEffect)(()=>{let e=g.A.get(n);d("true"!==e&&"false"!==e)},[n]),(0,r.useEffect)(()=>{if(!i)return;let e=c.current;if(!e)return;let t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');function a(e){if("Tab"!==e.key)return;let a=t[0],s=t[t.length-1];e.shiftKey?document.activeElement===a&&(e.preventDefault(),s.focus()):document.activeElement===s&&(e.preventDefault(),a.focus())}return t.length&&t[0].focus(),e.addEventListener("keydown",a),()=>e.removeEventListener("keydown",a)},[i]),i)?(0,s.jsx)("div",{className:"fixed left-0 bottom-12 w-screen flex justify-center z-[2000] pointer-events-none md:left-auto md:right-6 md:w-auto md:justify-end transition-opacity duration-300",children:(0,s.jsx)("div",{className:"pointer-events-auto bg-muted text-foreground rounded-2xl shadow-2xl p-6 flex flex-col items-center space-y-6 outline-none border max-w-xs sm:max-w-sm w-full mx-4 md:mx-0",children:(0,s.jsxs)("div",{ref:c,role:"dialog","aria-modal":"true",tabIndex:-1,className:"w-full flex flex-col items-center space-y-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-center",children:o("ConsentBanner.headline",{defaultValue:"We use cookies"})}),(0,s.jsx)("p",{className:"text-sm text-center",children:o("ConsentBanner.message")}),(0,s.jsx)("button",{type:"button",onClick:l,className:"text-sm underline text-foreground hover:text-primary cursor-pointer bg-transparent border-0 p-0 focus:outline-none",children:o("ConsentBanner.learnMoreButton")}),(0,s.jsxs)("div",{className:"flex space-x-4 justify-center w-full mt-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{g.A.set(n,"true",{expires:365,sameSite:"strict"}),d(!1),t()},autoFocus:!0,className:"bg-[#2E5A8C] text-white border border-border rounded-md px-5 py-2 text-base font-medium cursor-pointer hover:bg-[#2E5A8C]/90 focus:outline-none focus:ring-2 focus:ring-primary transition-colors transition-transform duration-300 hover:scale-105",children:o("ConsentBanner.acceptButton")}),(0,s.jsx)("button",{type:"button",onClick:()=>{g.A.set(n,"false",{expires:365,sameSite:"strict"}),d(!1),a()},className:"bg-[#cccccc] text-secondary-foreground text-base font-medium px-5 py-2 rounded-md cursor-pointer hover:underline focus:outline-none focus:ring-2 focus:ring-primary transition-colors transition-transform duration-300 hover:scale-105",children:o("ConsentBanner.declineButton")})]})]})})}):null},{onAccept:()=>{L(!0)},onDecline:()=>{L(!1)},consentCookieName:F,onOpenPrivacy:()=>V("privacy")})]})}},32383:()=>{},83686:()=>{},89568:(e,t,a)=>{Promise.resolve().then(a.bind(a,28242))}},e=>{var t=t=>e(e.s=t);e.O(0,[524,930,149,917,441,684,358],()=>t(89568)),_N_E=e.O()}]);