{"version":3,"file":"static/chunks/8770.d3e58f0d438b37e5.js","mappings":"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","sources":["webpack://_N_E/./src/context/settings-context.tsx","webpack://_N_E/./src/components/ui/accordion.tsx","webpack://_N_E/./src/components/ui/form.tsx","webpack://_N_E/./src/components/ui/button.tsx","webpack://_N_E/./src/components/ui/visually-hidden.tsx","webpack://_N_E/./src/components/ui/accessible-icon.tsx","webpack://_N_E/./src/components/ui/alert.tsx","webpack://_N_E/./src/components/ui/card.tsx","webpack://_N_E/./src/components/ui/table.tsx","webpack://_N_E/./src/lib/formattingUtils.ts","webpack://_N_E/./src/components/settings-modal.tsx","webpack://_N_E/./src/components/results-display.tsx","webpack://_N_E/./src/components/invoice-calculator-client.tsx","webpack://_N_E/./src/components/ui/dialog.tsx","webpack://_N_E/./src/components/ui/select.tsx","webpack://_N_E/./src/components/ui/input.tsx","webpack://_N_E/./src/components/ui/label.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, {\r\n  ReactNode,\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n} from \"react\";\r\n\r\nexport type Locale = \"en\" | \"de\";\r\n\r\nexport type AppSettings = {\r\n  decimalPlaces: number; // 0-6\r\n  roundingPrecision: number; // e.g., 0.01, 0.05, 1\r\n  thousandsSeparator: string; // Values: ',', '.', \"'\", ' '\r\n};\r\n\r\ninterface SettingsContextProps {\r\n  settings: Omit<AppSettings, \"locale\">;\r\n  saveSettings: (newSettings: Partial<Omit<AppSettings, \"locale\">>) => void; // Allow partial updates\r\n}\r\n\r\nconst defaultSettings: Omit<AppSettings, \"locale\"> = {\r\n  decimalPlaces: 2, // Default decimal places\r\n  roundingPrecision: 0.01, // Default rounding\r\n  thousandsSeparator: \",\", // Default separator is comma\r\n};\r\n\r\nconst SettingsContext = createContext<SettingsContextProps | undefined>(\r\n  undefined,\r\n);\r\n\r\nexport const SettingsProvider = ({ children }: { children: ReactNode }) => {\r\n  const [settings, setSettings] = useState<Omit<AppSettings, \"locale\">>(() => {\r\n    const loadedSettings =\r\n      typeof window !== \"undefined\"\r\n        ? localStorage.getItem(\"appSettings\")\r\n        : null;\r\n    const initialSettings = loadedSettings ? JSON.parse(loadedSettings) : {};\r\n    // Remove locale if it exists in loaded settings\r\n    if (\"locale\" in initialSettings) {\r\n      delete initialSettings.locale;\r\n    }\r\n    return { ...defaultSettings, ...initialSettings }; // Merge defaults with loaded\r\n  });\r\n  const [isLoaded, setIsLoaded] = useState(false); // Flag to ensure localStorage is read only once\r\n\r\n  // Effect to load settings from localStorage on initial client mount\r\n  useEffect(() => {\r\n    if (typeof window !== \"undefined\" && !isLoaded) {\r\n      // Check if running on client and not already loaded\r\n      try {\r\n        const savedSettings = localStorage.getItem(\"appSettings\");\r\n        if (savedSettings) {\r\n          const parsed = JSON.parse(savedSettings);\r\n          // Remove locale before validation/setting\r\n          if (\"locale\" in parsed) {\r\n            delete parsed.locale;\r\n          }\r\n\r\n          if (\r\n            typeof parsed.decimalPlaces === \"number\" &&\r\n            typeof parsed.roundingPrecision === \"number\" &&\r\n            parsed.roundingPrecision > 0 &&\r\n            typeof parsed.thousandsSeparator === \"string\" &&\r\n            [\",\", \".\", \"'\", \" \"].includes(parsed.thousandsSeparator) // Accept all valid separators\r\n          ) {\r\n            setSettings((prev) => ({ ...defaultSettings, ...prev, ...parsed })); // Ensure defaults are applied\r\n          } else {\r\n            console.warn(\r\n              \"Loaded settings from localStorage are invalid or incomplete (excluding locale). Using defaults.\",\r\n            );\r\n            // Set merged defaults if loaded is bad\r\n            setSettings(defaultSettings);\r\n            localStorage.removeItem(\"appSettings\"); // Clear invalid storage\r\n          }\r\n        } else {\r\n          setSettings(defaultSettings); // Ensure defaults if nothing is loaded\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Failed to load settings from localStorage:\", error);\r\n        setSettings(defaultSettings); // Fallback to defaults on error\r\n      }\r\n      setIsLoaded(true); // Mark as loaded to prevent re-running\r\n    }\r\n  }, [isLoaded]); // Dependency array ensures it runs once after initial mount\r\n\r\n  // Save settings to localStorage whenever they change\r\n  const saveSettings = (newSettings: Partial<Omit<AppSettings, \"locale\">>) => {\r\n    if (typeof window !== \"undefined\") {\r\n      // Ensure running on client\r\n      try {\r\n        // Create a clean copy without any potential 'locale' property\r\n        const cleanSettings = {\r\n          ...(newSettings.decimalPlaces !== undefined && {\r\n            decimalPlaces: newSettings.decimalPlaces,\r\n          }),\r\n          ...(newSettings.roundingPrecision !== undefined && {\r\n            roundingPrecision: newSettings.roundingPrecision,\r\n          }),\r\n          ...(newSettings.thousandsSeparator !== undefined && {\r\n            thousandsSeparator: newSettings.thousandsSeparator,\r\n          }),\r\n        };\r\n\r\n        const updatedSettings = { ...settings, ...cleanSettings };\r\n        setSettings(updatedSettings);\r\n\r\n        // Save to localStorage\r\n        localStorage.setItem(\"appSettings\", JSON.stringify(updatedSettings));\r\n      } catch (error) {\r\n        console.error(\"Failed to save settings to localStorage:\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  // The direct useEffect sync might cause issues with initial load, rely on saveSettings\r\n  // useEffect(() => { ... }, [settings]); // Remove this redundant effect\r\n\r\n  return (\r\n    // Pass down saveSettings instead of raw setSettings\r\n    <SettingsContext.Provider value={{ settings, saveSettings }}>\r\n      {children}\r\n    </SettingsContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useSettings = (): SettingsContextProps => {\r\n  const context = useContext(SettingsContext);\r\n  if (!context) {\r\n    throw new Error(\"useSettings must be used within a SettingsProvider\");\r\n  }\r\n  return context;\r\n};\r\n","\"use client\";\r\n\r\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\";\r\nimport * as React from \"react\";\r\n\r\nimport { ChevronDownIcon } from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nfunction Accordion({\r\n  ...props\r\n}: React.ComponentProps<typeof AccordionPrimitive.Root>) {\r\n  return <AccordionPrimitive.Root data-slot=\"accordion\" {...props} />;\r\n}\r\n\r\nfunction AccordionItem({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof AccordionPrimitive.Item>) {\r\n  return (\r\n    <AccordionPrimitive.Item\r\n      data-slot=\"accordion-item\"\r\n      className={cn(\"\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction AccordionTrigger({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof AccordionPrimitive.Trigger>) {\r\n  return (\r\n    <AccordionPrimitive.Header className=\"flex\">\r\n      <AccordionPrimitive.Trigger\r\n        data-slot=\"accordion-trigger\"\r\n        className={cn(\r\n          \"focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180\",\r\n          className,\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n        <ChevronDownIcon className=\"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200\" />\r\n      </AccordionPrimitive.Trigger>\r\n    </AccordionPrimitive.Header>\r\n  );\r\n}\r\n\r\nfunction AccordionContent({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof AccordionPrimitive.Content>) {\r\n  return (\r\n    <AccordionPrimitive.Content\r\n      data-slot=\"accordion-content\"\r\n      className=\"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm\"\r\n      {...props}\r\n    >\r\n      <div className={cn(\"pt-0 pb-4\", className)}>{children}</div>\r\n    </AccordionPrimitive.Content>\r\n  );\r\n}\r\n\r\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent };\r\n","\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\";\r\nimport { Slot } from \"@radix-ui/react-slot\";\r\nimport {\r\n  Controller,\r\n  FormProvider,\r\n  useFormContext,\r\n  useFormState,\r\n  type ControllerProps,\r\n  type FieldPath,\r\n  type FieldValues,\r\n} from \"react-hook-form\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Label } from \"@/components/ui/label\";\r\n\r\nconst Form = FormProvider;\r\n\r\ntype FormFieldContextValue<\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\r\n> = {\r\n  name: TName;\r\n};\r\n\r\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\r\n  {} as FormFieldContextValue,\r\n);\r\n\r\nconst FormField = <\r\n  TFieldValues extends FieldValues = FieldValues,\r\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,\r\n>({\r\n  ...props\r\n}: ControllerProps<TFieldValues, TName>) => {\r\n  return (\r\n    <FormFieldContext.Provider value={{ name: props.name }}>\r\n      <Controller {...props} />\r\n    </FormFieldContext.Provider>\r\n  );\r\n};\r\n\r\nconst useFormField = () => {\r\n  const fieldContext = React.useContext(FormFieldContext);\r\n  const itemContext = React.useContext(FormItemContext);\r\n  const { getFieldState } = useFormContext();\r\n  const formState = useFormState({ name: fieldContext.name });\r\n  const fieldState = getFieldState(fieldContext.name, formState);\r\n\r\n  if (!fieldContext) {\r\n    throw new Error(\"useFormField should be used within <FormField>\");\r\n  }\r\n\r\n  const { id } = itemContext;\r\n\r\n  return {\r\n    id,\r\n    name: fieldContext.name,\r\n    formItemId: `${id}-form-item`,\r\n    formDescriptionId: `${id}-form-item-description`,\r\n    formMessageId: `${id}-form-item-message`,\r\n    ...fieldState,\r\n  };\r\n};\r\n\r\ntype FormItemContextValue = {\r\n  id: string;\r\n};\r\n\r\nconst FormItemContext = React.createContext<FormItemContextValue>(\r\n  {} as FormItemContextValue,\r\n);\r\n\r\nfunction FormItem({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  const id = React.useId();\r\n\r\n  return (\r\n    <FormItemContext.Provider value={{ id }}>\r\n      <div\r\n        data-slot=\"form-item\"\r\n        className={cn(\"grid gap-2\", className)}\r\n        {...props}\r\n      />\r\n    </FormItemContext.Provider>\r\n  );\r\n}\r\n\r\n// Helper component that assumes context is available\r\nfunction FormLabelInternal({ \r\n  fieldContext,\r\n  itemContext,\r\n  className,\r\n  htmlFor: explicitHtmlFor, // Rename explicit prop\r\n  ...props\r\n}: React.ComponentProps<typeof LabelPrimitive.Root> & {\r\n  fieldContext: FormFieldContextValue;\r\n  itemContext: FormItemContextValue;\r\n  htmlFor?: string;\r\n}) {\r\n  // Hooks are safe to call unconditionally here\r\n  const { getFieldState } = useFormContext();\r\n  const formState = useFormState({ name: fieldContext.name });\r\n  const fieldState = getFieldState(fieldContext.name, formState);\r\n\r\n  const formItemId = `${itemContext.id}-form-item`;\r\n  const hasError = !!fieldState.error;\r\n  // Prioritize explicit htmlFor prop if provided\r\n  const derivedHtmlFor = explicitHtmlFor || formItemId;\r\n\r\n  return (\r\n    <Label\r\n      data-slot=\"form-label\"\r\n      data-error={hasError}\r\n      className={cn(\"data-[error=true]:text-destructive\", className)}\r\n      htmlFor={derivedHtmlFor}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction FormLabel({\r\n  className,\r\n  htmlFor,\r\n  ...props\r\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\r\n  // Get contexts unconditionally\r\n  const fieldContext = React.useContext(FormFieldContext);\r\n  const itemContext = React.useContext(FormItemContext);\r\n\r\n  // Check if contexts are valid (simple non-empty check for fieldContext)\r\n  const hasContext = fieldContext && Object.keys(fieldContext).length > 0 && itemContext && itemContext.id;\r\n\r\n  if (hasContext) {\r\n    // Render internal component only when context is available\r\n    return (\r\n      <FormLabelInternal \r\n        fieldContext={fieldContext}\r\n        itemContext={itemContext}\r\n        className={className}\r\n        htmlFor={htmlFor} // Pass explicit htmlFor\r\n        {...props} \r\n      />\r\n    );\r\n  }\r\n\r\n  // Render basic label if no context\r\n  return (\r\n    <Label\r\n      data-slot=\"form-label\"\r\n      data-error={false} // No context means no error state derived from it\r\n      className={cn(\"data-[error=true]:text-destructive\", className)} // Keep class for consistency if needed\r\n      htmlFor={htmlFor} // Use explicit htmlFor\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction FormControl({ ...props }: React.ComponentProps<typeof Slot>) {\r\n  const { error, formItemId, formDescriptionId, formMessageId } =\r\n    useFormField();\r\n\r\n  return (\r\n    <Slot\r\n      data-slot=\"form-control\"\r\n      id={formItemId}\r\n      aria-describedby={\r\n        !error\r\n          ? `${formDescriptionId}`\r\n          : `${formDescriptionId} ${formMessageId}`\r\n      }\r\n      aria-invalid={!!error}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction FormDescription({ className, ...props }: React.ComponentProps<\"p\">) {\r\n  const { formDescriptionId } = useFormField();\r\n\r\n  return (\r\n    <p\r\n      data-slot=\"form-description\"\r\n      id={formDescriptionId}\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction FormMessage({ className, ...props }: React.ComponentProps<\"p\">) {\r\n  const { error, formMessageId } = useFormField();\r\n  const body = error ? String(error?.message ?? \"\") : props.children;\r\n\r\n  if (!body) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <p\r\n      data-slot=\"form-message\"\r\n      id={formMessageId}\r\n      className={cn(\"text-destructive text-sm pl-3\", className)}\r\n      {...props}\r\n    >\r\n      {body}\r\n    </p>\r\n  );\r\n}\r\n\r\nexport {\r\n  useFormField,\r\n  Form,\r\n  FormItem,\r\n  FormLabel,\r\n  FormControl,\r\n  FormDescription,\r\n  FormMessage,\r\n  FormField,\r\n};\r\n","import * as React from \"react\";\r\nimport { Slot } from \"@radix-ui/react-slot\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-2 aria-[invalid=true]:ring-destructive/20 dark:aria-[invalid=true]:ring-destructive/40 aria-[invalid=true]:border-destructive cursor-pointer hover:transform hover:translate-y-[-2px] hover:scale-[1.015]\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"bg-primary text-primary-foreground shadow-md hover:bg-primary/90 hover:shadow-md\",\r\n        destructive:\r\n          \"bg-destructive text-destructive-foreground shadow-md hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 hover:shadow-md\",\r\n        outline:\r\n          \"border bg-background shadow-md hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 hover:shadow-md\",\r\n        secondary:\r\n          \"bg-secondary text-secondary-foreground shadow-md hover:bg-secondary/80 hover:shadow-md\",\r\n        ghost:\r\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-10 px-4 py-2\",\r\n        sm: \"h-8 rounded-md px-3 py-1\",\r\n        lg: \"h-12 px-6 py-3\",\r\n        icon: \"size-10\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  },\r\n);\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean;\r\n  }) {\r\n  const Comp = asChild ? Slot : \"button\";\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport { Button, buttonVariants };\r\n","import * as React from \"react\";\r\n\r\n/**\r\n * VisuallyHidden component hides its children visually but keeps them accessible to screen readers.\r\n */\r\nfunction VisuallyHidden({ children }: { children: React.ReactNode }) {\r\n  return (\r\n    <span\r\n      className=\"absolute w-px h-px p-0 -m-px overflow-hidden whitespace-nowrap border-0\"\r\n      style={{ clip: \"rect(0, 0, 0, 0)\" }}\r\n    >\r\n      {children}\r\n    </span>\r\n  );\r\n}\r\n\r\nexport { VisuallyHidden };\r\n","import * as React from \"react\";\r\n\r\nimport { VisuallyHidden } from \"@/components/ui/visually-hidden\";\r\n\r\ninterface AccessibleIconProps {\r\n  label: string;\r\n  children: React.ReactNode;\r\n}\r\n\r\n/**\r\n * AccessibleIcon component wraps an icon and provides a visually hidden label for screen readers.\r\n */\r\nfunction AccessibleIcon({ label, children }: AccessibleIconProps) {\r\n  return (\r\n    <span className=\"inline-flex items-center justify-center\">\r\n      {children}\r\n      <VisuallyHidden>{label}</VisuallyHidden>\r\n    </span>\r\n  );\r\n}\r\n\r\nexport { AccessibleIcon };\r\n","import * as React from \"react\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst alertVariants = cva(\r\n  \"relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-card text-card-foreground\",\r\n        destructive:\r\n          \"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  },\r\n);\r\n\r\nfunction Alert({\r\n  className,\r\n  variant,\r\n  ...props\r\n}: React.ComponentProps<\"div\"> & VariantProps<typeof alertVariants>) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert\"\r\n      role=\"alert\"\r\n      className={cn(alertVariants({ variant }), className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction AlertTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-title\"\r\n      className={cn(\r\n        \"col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction AlertDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"alert-description\"\r\n      className={cn(\r\n        \"text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport { Alert, AlertTitle, AlertDescription };\r\n","import * as React from \"react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-lg border py-6 shadow-sm\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn(\"leading-none font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn(\"px-6\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n};\r\n","\"use client\";\r\n\r\nimport * as React from \"react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nfunction Table({ className, ...props }: React.ComponentProps<\"table\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"table-container\"\r\n      className=\"relative w-full overflow-x-auto\"\r\n    >\r\n      <table\r\n        data-slot=\"table\"\r\n        className={cn(\"w-full caption-bottom text-sm\", className)}\r\n        {...props}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction TableHeader({ className, ...props }: React.ComponentProps<\"thead\">) {\r\n  return (\r\n    <thead\r\n      data-slot=\"table-header\"\r\n      className={cn(\"[&_tr]:border-b\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction TableBody({ className, ...props }: React.ComponentProps<\"tbody\">) {\r\n  return (\r\n    <tbody\r\n      data-slot=\"table-body\"\r\n      className={cn(\"[&_tr:last-child]:border-0\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction TableFooter({ className, ...props }: React.ComponentProps<\"tfoot\">) {\r\n  return (\r\n    <tfoot\r\n      data-slot=\"table-footer\"\r\n      className={cn(\r\n        \"bg-muted/50 border-t font-medium [&>tr]:last:border-b-0\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction TableRow({ className, ...props }: React.ComponentProps<\"tr\">) {\r\n  return (\r\n    <tr\r\n      data-slot=\"table-row\"\r\n      className={cn(\r\n        \"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction TableHead({ className, ...props }: React.ComponentProps<\"th\">) {\r\n  return (\r\n    <th\r\n      data-slot=\"table-head\"\r\n      className={cn(\r\n        \"text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction TableCell({ className, ...props }: React.ComponentProps<\"td\">) {\r\n  return (\r\n    <td\r\n      data-slot=\"table-cell\"\r\n      className={cn(\r\n        \"p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction TableCaption({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<\"caption\">) {\r\n  return (\r\n    <caption\r\n      data-slot=\"table-caption\"\r\n      className={cn(\"text-muted-foreground mt-4 text-sm\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport {\r\n  Table,\r\n  TableHeader,\r\n  TableBody,\r\n  TableFooter,\r\n  TableHead,\r\n  TableRow,\r\n  TableCell,\r\n  TableCaption,\r\n};\r\n","import { AppSettings } from \"@/context/settings-context\";\r\n\r\n/**\r\n * Formats a number according to the application settings using Intl.NumberFormat.\r\n * @param value The number to format.\r\n * @param locale The locale string.\r\n * @param settings The current application settings.\r\n * @returns Formatted number string.\r\n */\r\nexport function formatNumber(\r\n  value: number,\r\n  locale: string,\r\n  settings: Omit<AppSettings, \"locale\">,\r\n): string {\r\n  try {\r\n    return new Intl.NumberFormat(locale, {\r\n      minimumFractionDigits: settings.decimalPlaces,\r\n      maximumFractionDigits: settings.decimalPlaces,\r\n    }).format(value);\r\n  } catch (error) {\r\n    console.error(\"Error formatting number:\", error);\r\n    // Fallback to simple formatting\r\n    return value.toFixed(settings.decimalPlaces);\r\n  }\r\n}\r\n\r\n/**\r\n * Rounds a number based on the specified rounding precision factor.\r\n * @param value The number to round.\r\n * @param precision The rounding factor (e.g., 0.01, 0.05, 1). Must be > 0.\r\n * @returns Rounded number.\r\n */\r\nexport function roundValue(value: number, precision: number): number {\r\n  if (precision <= 0) {\r\n    console.warn(`Invalid rounding precision: ${precision}. Using 0.01.`);\r\n    precision = 0.01;\r\n  }\r\n  const multiplier = 1 / precision;\r\n  return Math.round(value * multiplier) / multiplier;\r\n}\r\n\r\n/**\r\n * Formats a date according to locale. Accepts either a Date object or a string in YYYY-MM-DD format.\r\n * @param dateInput Date as a string in 'yyyy-MM-dd' format or as a Date object.\r\n * @param locale Locale string (e.g., 'en', 'de').\r\n * @returns Formatted date string.\r\n */\r\nexport function formatDateLocale(dateInput: string | Date | undefined, locale: string): string {\r\n  if (!dateInput) return 'N/A';\r\n  \r\n  try {\r\n    let date: Date;\r\n    \r\n    if (typeof dateInput === 'string') {\r\n      // If it's already in ISO format with time, use it directly\r\n      if (dateInput.includes('T')) {\r\n        date = new Date(dateInput);\r\n      } else {\r\n        // Add UTC time for date-only strings\r\n        date = new Date(dateInput + 'T00:00:00Z');\r\n      }\r\n    } else {\r\n      // It's already a Date\r\n      date = dateInput;\r\n    }\r\n    \r\n    return new Intl.DateTimeFormat(locale, {\r\n      year: \"numeric\",\r\n      month: \"short\",\r\n      day: \"numeric\",\r\n    }).format(date);\r\n  } catch (error) {\r\n    console.error(\"Error formatting date:\", error);\r\n    return typeof dateInput === 'string' ? dateInput : dateInput.toISOString().split('T')[0]; // Fallback\r\n  }\r\n}\r\n\r\n/**\r\n * Formats a percentage value according to locale.\r\n * @param value The percentage value (0 to 1).\r\n * @param locale The locale string.\r\n * @returns Formatted percentage string.\r\n */\r\nexport function formatPercent(value: number, locale: string): string {\r\n  try {\r\n    return new Intl.NumberFormat(locale, {\r\n      style: \"percent\",\r\n      minimumFractionDigits: 2, // Usually keep 2 decimals for percentages\r\n      maximumFractionDigits: 2,\r\n    }).format(value);\r\n  } catch (error) {\r\n    console.error(\"Error formatting percent:\", error);\r\n    // Fallback\r\n    return (value * 100).toFixed(2) + \"%\";\r\n  }\r\n}\r\n","\"use client\";\r\n\r\nimport * as z from \"zod\";\r\n\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogDescription as UiDialogDescription,\r\n} from \"@/components/ui/dialog\";\r\nimport {\r\n  Form,\r\n  FormControl,\r\n  FormDescription,\r\n  FormField,\r\n  FormItem,\r\n  FormLabel,\r\n  FormMessage,\r\n} from \"@/components/ui/form\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport React from \"react\";\r\nimport { Settings } from \"lucide-react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useSettings } from \"@/context/settings-context\";\r\nimport { useTranslation } from \"@/translations\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\n\r\n// Define a simpler form schema without transforms to avoid type issues\r\nconst FormSchema = z.object({\r\n  decimalPlaces: z.string().nonempty(\"Decimal places is required\"),\r\n  roundingPrecision: z.string().nonempty(\"Rounding precision is required\"),\r\n  thousandsSeparator: z.string(),\r\n  locale: z.string(),\r\n});\r\n\r\n// Our form is typed based on this schema\r\ntype FormValues = z.infer<typeof FormSchema>;\r\n\r\ninterface SettingsModalProps {\r\n  isOpen?: boolean;\r\n  onOpenChange?: (isOpen: boolean) => void;\r\n  variant?: React.ComponentProps<typeof Button>[\"variant\"];\r\n  size?: React.ComponentProps<typeof Button>[\"size\"];\r\n  className?: string;\r\n}\r\n\r\nexport function SettingsModal({ \r\n  isOpen: externalIsOpen, \r\n  onOpenChange: externalOnOpenChange,\r\n  variant = \"ghost\",\r\n  size = \"icon\",\r\n  className\r\n}: SettingsModalProps) {\r\n  const { settings, saveSettings } = useSettings();\r\n  const { t } = useTranslation();\r\n  const [internalIsOpen, setInternalIsOpen] = useState(false);\r\n  const [isMounted, setIsMounted] = useState(false);\r\n\r\n  // Use either the external state or internal state\r\n  const isOpen = externalIsOpen !== undefined ? externalIsOpen : internalIsOpen;\r\n  const onOpenChange = externalOnOpenChange || setInternalIsOpen;\r\n\r\n  // Always ensure there's a default separator\r\n  const defaultSeparator = \",\";\r\n\r\n  // Track form validity state\r\n  const [isValid, setIsValid] = useState(true);\r\n\r\n  // Fix the form type to match form values\r\n  const form = useForm<FormValues>({\r\n    resolver: zodResolver(FormSchema),\r\n    defaultValues: {\r\n      decimalPlaces: settings.decimalPlaces?.toString() || \"\",\r\n      roundingPrecision: settings.roundingPrecision?.toString() || \"0.01\",\r\n      thousandsSeparator: settings.thousandsSeparator || defaultSeparator,\r\n      locale: \"en-US\",\r\n    },\r\n    mode: \"onChange\", // Validate on every change\r\n  });\r\n\r\n  // Reset form when dialog opens or settings change\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      // Ensure we're using the latest settings from context\r\n      form.reset({\r\n        decimalPlaces: settings.decimalPlaces?.toString() || \"\",\r\n        roundingPrecision: settings.roundingPrecision?.toString() || \"0.01\",\r\n        thousandsSeparator: settings.thousandsSeparator || defaultSeparator,\r\n        locale: \"en-US\",\r\n      });\r\n    }\r\n  }, [isOpen, settings, form, defaultSeparator]);\r\n\r\n  // Update isValid when form state changes\r\n  useEffect(() => {\r\n    const subscription = form.watch(() => {\r\n      const hasErrors = !!Object.keys(form.formState.errors).length;\r\n      const formValues = form.getValues();\r\n      const isDecimalEmpty =\r\n        !formValues.decimalPlaces || formValues.decimalPlaces === \"\";\r\n\r\n      setIsValid(!hasErrors && !isDecimalEmpty);\r\n    });\r\n    return () => subscription.unsubscribe();\r\n  }, [form]);\r\n\r\n  useEffect(() => {\r\n    setIsMounted(true);\r\n  }, [settings]);\r\n\r\n  // Handle dialog close - ensure unsaved changes are discarded\r\n  const handleOpenChange = (open: boolean) => {\r\n    if (!open) {\r\n      // Reset form when dialog is closed without saving\r\n      form.reset({\r\n        decimalPlaces: settings.decimalPlaces?.toString() || \"\",\r\n        roundingPrecision: settings.roundingPrecision?.toString() || \"0.01\",\r\n        thousandsSeparator: settings.thousandsSeparator || defaultSeparator,\r\n        locale: \"en-US\",\r\n      });\r\n    }\r\n    onOpenChange(open);\r\n  };\r\n\r\n  function onSubmit(data: FormValues) {\r\n    // Validate decimal places\r\n    const decimalPlaces = Number(data.decimalPlaces);\r\n    if (isNaN(decimalPlaces) || decimalPlaces < 0 || decimalPlaces > 6) {\r\n      form.setError(\"decimalPlaces\", {\r\n        type: \"manual\",\r\n        message: \"Decimal places must be between 0 and 6\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Validate rounding precision\r\n    const normalized = data.roundingPrecision.replace(\",\", \".\");\r\n    const roundingPrecision = Number(normalized);\r\n    if (\r\n      isNaN(roundingPrecision) ||\r\n      roundingPrecision < 0.0001 ||\r\n      roundingPrecision > 100\r\n    ) {\r\n      form.setError(\"roundingPrecision\", {\r\n        type: \"manual\",\r\n        message: \"Rounding precision must be between 0.0001 and 100\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Only save settings when user submits the form and all validations pass\r\n    const updatedSettings = {\r\n      decimalPlaces: decimalPlaces,\r\n      roundingPrecision: roundingPrecision,\r\n      thousandsSeparator: data.thousandsSeparator || defaultSeparator,\r\n      locale: data.locale,\r\n    };\r\n\r\n    // Handle the locale/language change\r\n    const newLocale = data.locale;\r\n    if (newLocale && \"en-US\" !== newLocale) {\r\n      // Implement language change logic here\r\n    }\r\n\r\n    // Save all settings at once after form submission\r\n    saveSettings(updatedSettings);\r\n\r\n    // Dispatch a custom event to notify the application that settings have changed\r\n    if (typeof window !== \"undefined\") {\r\n      window.dispatchEvent(\r\n        new CustomEvent(\"settingsChanged\", {\r\n          detail: { settings: updatedSettings },\r\n        }),\r\n      );\r\n    }\r\n\r\n    onOpenChange(false);\r\n  }\r\n\r\n  // Always ensure we have a valid separator value for the dropdown\r\n  const currentSeparator = form.watch(\"thousandsSeparator\") || defaultSeparator;\r\n\r\n  // Determine labels based on mounted state\r\n  const triggerLabel = isMounted ? t(\"SettingsModal.settingsModalTitle\") : \"Number Formatting Settings\";\r\n  const dialogTitle = isMounted ? t(\"SettingsModal.settingsModalTitle\") : \"Number Formatting Settings\";\r\n  const dialogDescription = isMounted ? t(\"SettingsModal.settingsModalDescription\") : \"Adjust your preferred number formatting for allocations and reports.\";\r\n  const saveLabel = isMounted ? t(\"SettingsModal.saveButton\") : \"Save Settings\";\r\n\r\n  return (\r\n    <>\r\n      {!externalIsOpen && !externalOnOpenChange && (\r\n        <Button\r\n          variant={variant}\r\n          size={size}\r\n          onClick={() => setInternalIsOpen(true)}\r\n          className={className}\r\n          aria-label={triggerLabel}\r\n        >\r\n          <Settings className=\"size-4\" />\r\n          {size !== \"icon\" && t(\"SettingsModal.settingsButtonText\", \"Settings\")}\r\n        </Button>\r\n      )}\r\n\r\n      <Dialog open={isOpen} onOpenChange={handleOpenChange}>\r\n        <DialogContent className=\"sm:max-w-[425px]\">\r\n          <DialogHeader>\r\n            <DialogTitle>{dialogTitle}</DialogTitle>\r\n            <UiDialogDescription>{dialogDescription}</UiDialogDescription>\r\n          </DialogHeader>\r\n          <Form {...form}>\r\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\r\n              <FormField\r\n                control={form.control}\r\n                name=\"decimalPlaces\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>{t(\"SettingsModal.decimalPlacesLabel\")}</FormLabel>\r\n                    <FormControl>\r\n                      <Input required {...field} />\r\n                    </FormControl>\r\n                    <FormDescription>\r\n                      {t(\"SettingsModal.decimalPlacesDescription\")}\r\n                    </FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n              <FormField\r\n                control={form.control}\r\n                name=\"roundingPrecision\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>\r\n                      {t(\"SettingsModal.roundingPrecisionLabel\")}\r\n                    </FormLabel>\r\n                    <FormControl>\r\n                      <Input required {...field} />\r\n                    </FormControl>\r\n                    <FormDescription>\r\n                      {t(\"SettingsModal.roundingPrecisionDescription\")}\r\n                    </FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n              <FormField\r\n                control={form.control}\r\n                name=\"thousandsSeparator\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>\r\n                      {t(\"SettingsModal.thousandsSeparatorLabel\")}\r\n                    </FormLabel>\r\n                    <Select\r\n                      onValueChange={(value) => {\r\n                        field.onChange(value || defaultSeparator);\r\n                      }}\r\n                      value={currentSeparator}\r\n                    >\r\n                      <FormControl>\r\n                        <SelectTrigger>\r\n                          <SelectValue>\r\n                            {currentSeparator === \",\"\r\n                              ? `${t(\"SettingsModal.comma\")} (1,234.56)`\r\n                              : currentSeparator === \".\"\r\n                                ? `${t(\"SettingsModal.period\")} (1.234,56)`\r\n                                : currentSeparator === \"'\"\r\n                                  ? `${t(\"SettingsModal.apostrophe\")} (1&apos;234.56)`\r\n                                  : currentSeparator === \" \"\r\n                                    ? `${t(\"SettingsModal.space\")} (1 234.56)`\r\n                                    : t(\"SettingsModal.comma\")}\r\n                          </SelectValue>\r\n                        </SelectTrigger>\r\n                      </FormControl>\r\n                      <SelectContent>\r\n                        <SelectItem key=\",\" value=\",\">\r\n                          {`${t(\"SettingsModal.comma\")} (1,234.56)`}\r\n                        </SelectItem>\r\n                        <SelectItem key=\".\" value=\".\">\r\n                          {`${t(\"SettingsModal.period\")} (1.234,56)`}\r\n                        </SelectItem>\r\n                        <SelectItem key=\"'\" value=\"'\">\r\n                          {`${t(\"SettingsModal.apostrophe\")} (1&apos;234.56)`}\r\n                        </SelectItem>\r\n                        <SelectItem key=\"space\" value=\" \">\r\n                          {`${t(\"SettingsModal.space\")} (1 234.56)`}\r\n                        </SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <FormDescription>\r\n                      {t(\"SettingsModal.thousandsSeparatorDescription\")}\r\n                    </FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n              <DialogFooter className=\"pt-4\">\r\n                <Button\r\n                  type=\"submit\"\r\n                  disabled={\r\n                    !isValid ||\r\n                    form.formState.isSubmitting ||\r\n                    Object.keys(form.formState.errors).length > 0\r\n                  }\r\n                >\r\n                  {saveLabel}\r\n                </Button>\r\n              </DialogFooter>\r\n            </form>\r\n          </Form>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n}\r\n","\"use client\";\n\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"@/components/ui/accordion\";\nimport {\n  CalculationInput,\n  CalculationResult,\n  CalculationStepDetails,\n} from \"@/lib/calculations\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport React, { useState } from \"react\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableFooter,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { de, enUS } from 'date-fns/locale';\nimport {\n  formatDateLocale as utilFormatDateLocale,\n  formatNumber as utilFormatNumber,\n  formatPercent as utilFormatPercent,\n} from \"@/lib/formattingUtils\";\n\nimport { AppSettings } from \"@/context/settings-context\";\nimport { Button } from \"@/components/ui/button\";\nimport type { CellHookData } from 'jspdf-autotable';\nimport { SettingsModal } from \"@/components/settings-modal\";\nimport { format } from \"date-fns\";\nimport type { jsPDF } from 'jspdf';\nimport { useSettings } from \"@/context/settings-context\";\nimport { useTranslation } from \"@/translations\";\n\n// Define a type for the jsPDF internal object with just the properties we need\ntype JsPDFWithInternal = jsPDF & {\n  internal: {\n    getNumberOfPages: () => number;\n    pageSize: {\n      width: number;\n      height: number;\n    }\n  };\n  // Add lastAutoTable property for autoTable plugin\n  lastAutoTable?: {\n    finalY: number;\n  };\n};\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type -- Interface inherits members via Pick\ninterface InputDataForDisplay\n  extends Pick<\n    CalculationInput,\n    \"startDate\" | \"endDate\" | \"includeEndDate\" | \"amounts\" | \"splitPeriod\"\n  > {}\n\ninterface ResultsDisplayProps {\n  results: CalculationResult;\n  inputData: InputDataForDisplay;\n}\n\n// --- Period Formatting Helper ---\nfunction formatPeriodIdentifier(\n  identifier: string,\n  periodType: 'yearly' | 'quarterly' | 'monthly',\n  locale: string\n): string {\n  switch (periodType) {\n    case 'monthly':\n      try {\n        const [year, month] = identifier.split('-');\n        const date = new Date(parseInt(year), parseInt(month) - 1, 1);\n        return format(date, 'MMMM yyyy', { locale: locale === 'de' ? de : enUS });\n      } catch { \n        return identifier; \n      }\n    case 'quarterly':\n      return identifier;\n    case 'yearly':\n    default:\n      return identifier;\n  }\n}\n\n// --- Calculation Steps Renderer Component ---\nconst CalculationStepsDisplay = ({\n  steps,\n  settings,\n  splitPeriodUsed,\n}: {\n  steps: CalculationStepDetails;\n  settings: Omit<AppSettings, \"locale\">;\n  splitPeriodUsed: 'yearly' | 'quarterly' | 'monthly';\n}) => {\n  const { t, i18n } = useTranslation();\n  const currentLocale = i18n.language;\n\n  if (steps.error) {\n    return <p className=\"text-destructive\">{steps.error}</p>;\n  }\n\n  const { periodSegments, amountCalculations } = steps;\n\n  const fmtNum = (num: number) => utilFormatNumber(num, currentLocale, settings);\n  const fmtPeriod = (id: string) => formatPeriodIdentifier(id, splitPeriodUsed, currentLocale);\n  const fmtDate = (dateStr: string) => utilFormatDateLocale(dateStr, currentLocale);\n  const fmtPct = (val: number) => utilFormatPercent(val, currentLocale);\n\n  return (\n    <div className=\"text-sm space-y-6\">\n       {/* Total Duration and Period Breakdown Section */}\n      <section className=\"bg-muted/40 rounded-lg p-4 space-y-4\">\n        <h4 className=\"font-semibold text-foreground\">{t('ResultsDisplay.totalDuration')}</h4>\n        <div className=\"grid grid-cols-2 gap-2 text-xs border-b pb-2 mb-2\">\n          <div>{t('ResultsDisplay.periodLabel')}</div> <div className=\"text-right\">{fmtDate(steps.totalDuration.start)} - {fmtDate(steps.totalDuration.end)}</div>\n          <div>{t('ResultsDisplay.totalDays')}</div> <div className=\"text-right\">{steps.totalDuration.days} ({steps.totalDuration.included ? t('ResultsDisplay.inclusiveLabel') : t('ResultsDisplay.exclusiveLabel')})</div>\n        </div>\n        <h4 className=\"font-semibold text-foreground\">{t('ResultsDisplay.proportionCalculation')}</h4>\n        <div className=\"space-y-1\">\n          {periodSegments.map((seg) => (\n            <div key={seg.periodIdentifier} className=\"grid grid-cols-3 gap-2 text-xs\">\n              <div className=\"font-medium\">{fmtPeriod(seg.periodIdentifier)}:</div>\n              <div className=\"text-muted-foreground text-center\">{seg.days} / {steps.totalDuration.days} {t('ResultsDisplay.daysLabel')}</div>\n              <div className=\"text-muted-foreground text-right\">{fmtPct(seg.proportion)}</div>\n            </div>\n          ))}\n        </div>\n      </section>\n\n      {/* Split Calculation per Input Amount Section */}\n      <section className=\"bg-muted/40 rounded-lg p-4\">\n        <h4 className=\"font-semibold text-foreground mb-4\">{t('ResultsDisplay.splitCalculation')}</h4>\n        <div className=\"space-y-6\">\n          {amountCalculations.map((amtCalc, index) => (\n            <div\n              key={index}\n              className=\"rounded-md border bg-background p-4 space-y-2 transition-shadow hover:shadow-md\"\n            >\n              <div className=\"font-bold text-[15px] text-primary mb-3 pb-1 border-b border-primary/20 bg-primary/[0.08] -mx-4 px-4 py-2 rounded-t-md\">\n                {t(\"ResultsDisplay.inputAmountLabel\")} #{index + 1}:{\" \"}\n                {fmtNum(amtCalc.originalAmount)}\n              </div>\n              <div className=\"space-y-3\">\n                {amtCalc.periodSplits.map((ps, periodIndex) => (\n                  <div\n                    key={ps.periodIdentifier}\n                    className={`pl-2 text-xs space-y-0.5 ${periodIndex < amtCalc.periodSplits.length - 1 ? \"border-b border-muted/30 pb-2\" : \"\"}`}\n                  >\n                    <div className=\"font-medium shrink-0 text-foreground\">\n                      {fmtPeriod(ps.periodIdentifier)}:\n                    </div>\n                    <div className=\"text-muted-foreground ml-2\">\n                      <span>\n                        {fmtNum(amtCalc.originalAmount)} *{\" \"}\n                        {periodSegments\n                          .find((s) => s.periodIdentifier === ps.periodIdentifier)\n                          ?.proportion.toFixed(6)}\n                      </span>\n                      <span className=\"block sm:inline\">\n                        {\" \"}\n                        = {ps.rawSplit.toFixed(6)}\n                      </span>\n                    </div>\n                    <div className=\"ml-2 flex items-center gap-x-2\">\n                      <span></span>\n                      <span className=\"font-medium text-foreground\">\n                        {t(\"ResultsDisplay.roundedLabel\")}:{\" \"}\n                        {fmtNum(ps.roundedSplit)}\n                      </span>\n                      {ps.adjustment !== 0 && (\n                        <span className=\"text-muted-foreground text-xs\">\n                          ({t(\"ResultsDisplay.adjustmentLabel\")}:{\" \"}\n                          {fmtNum(ps.adjustment)})\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n              <div className=\"border-t pt-2 mt-2 space-y-1 text-xs\">\n                <p>\n                  <span className=\"font-medium text-foreground\">\n                    {t(\"ResultsDisplay.discrepancyLabel\")}:\n                  </span>\n                  <span\n                    className={`${Math.abs(amtCalc.discrepancy) > 0.001 ? \"text-amber-600 dark:text-amber-500\" : \"text-muted-foreground/70\"}`}\n                  >\n                    {\" \"}\n                    {fmtNum(amtCalc.discrepancy)}\n                  </span>\n                  {amtCalc.adjustmentAppliedToPeriod && (\n                    <span className=\"text-muted-foreground\">\n                      ({t(\"ResultsDisplay.adjustedInYearLabel\", { defaultValue: \"Applied in Year\" })}{\" \"}\n                      {fmtPeriod(amtCalc.adjustmentAppliedToPeriod)})\n                    </span>\n                  )}\n                </p>\n                <p className=\"font-semibold text-sm text-foreground pt-1\">\n                  {t(\"ResultsDisplay.finalSumLabel\")}:{\" \"}\n                  <span className=\"text-primary\">\n                    {fmtNum(amtCalc.finalSum)}\n                  </span>\n                </p>\n              </div>\n            </div>\n          ))}\n        </div>\n      </section>\n    </div>\n  );\n};\n// --- End Calculation Steps Renderer ---\n\n// Original component function\nfunction ResultsDisplayComponent({ results, inputData }: ResultsDisplayProps) {\n  const { t, i18n } = useTranslation();\n  const { settings } = useSettings();\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n  const currentLocale = i18n.language;\n\n  // Ensure we use the splitPeriod from the inputData if available\n  const splitPeriodUsed = inputData.splitPeriod || 'yearly';\n\n  // Memoized formatting functions based on current settings and locale\n  const formatNumForDisplay = (value: number | undefined) =>\n    value !== undefined ? utilFormatNumber(value, currentLocale, settings) : \"\";\n  const formatPctForDisplay = (value: number | undefined) => \n    value !== undefined ? utilFormatPercent(value, currentLocale) : \"\";\n  const formatDateForDisplay = (dateObj: Date | string | undefined) =>\n    dateObj ? utilFormatDateLocale(dateObj, currentLocale) : \"\";\n  const formatPeriodIdForDisplay = (id: string) => formatPeriodIdentifier(id, splitPeriodUsed, currentLocale);\n\n  // Function to get appropriate header for the allocation table\n  const getPeriodHeader = () => {\n      switch (splitPeriodUsed) {\n        case 'monthly': return t('ResultsDisplay.monthHeader');\n          case 'quarterly': return t('ResultsDisplay.quarterHeader');\n          case 'yearly':\n          default: return t('ResultsDisplay.yearHeader');\n      }\n  };\n\n  // Calculate derived values with checks\n  const totalDurationDays = results.calculationSteps?.totalDuration?.days ?? 0;\n  const totalInputAmount = inputData.amounts.reduce((sum, val) => sum + (isNaN(val) ? 0 : val), 0);\n  // Assuming AggregatedPeriodSplit has totalSplitAmount based on previous potential structure\n  const totalAggregatedAmount = results.aggregatedSplits?.reduce((sum, s) => sum + (s.totalSplitAmount ?? 0), 0) ?? 0;\n\n  // Export functions (keep implementations as they were)\n  function handleExportExcel() { \n      import('xlsx').then(XLSX => {\n          // Create a single consolidated sheet for all data\n          const workbook = XLSX.utils.book_new();\n          \n          // Prepare all data for a single sheet\n          const consolidatedData = [];\n          \n          // 1. Title and Summary Section\n          consolidatedData.push([t(\"ResultsDisplay.summaryTitle\", { defaultValue: \"Summary\" })]);\n          consolidatedData.push([]);\n          consolidatedData.push([t(\"ResultsDisplay.periodLabel\"), `${formatDateForDisplay(inputData.startDate)} - ${formatDateForDisplay(inputData.endDate)}`]);\n          consolidatedData.push([t(\"ResultsDisplay.totalDurationLabel\", { defaultValue: \"Total Duration (days)\" }), `${totalDurationDays} ${t(\"ResultsDisplay.daysLabel\")}`]);\n          consolidatedData.push([t(\"InvoiceForm.includeEndDateLabel\", { defaultValue: \"Include Final Day in Service Period?\" }), inputData.includeEndDate ? t(\"ResultsDisplay.yesLabel\", { defaultValue: \"Yes\" }) : t(\"ResultsDisplay.noLabel\", { defaultValue: \"No\" })]);\n          consolidatedData.push([t(\"InvoiceForm.splitPeriodLabel\", { defaultValue: \"Split Period\" }), splitPeriodUsed === 'yearly' ? t('InvoiceForm.periodYearly') : splitPeriodUsed === 'quarterly' ? t('InvoiceForm.periodQuarterly') : t('InvoiceForm.periodMonthly')]);\n          consolidatedData.push([t(\"ResultsDisplay.originalTotalLabel\", { defaultValue: \"Total Input Amount:\" }), formatNumForDisplay(totalInputAmount)]);\n          consolidatedData.push([]);\n          \n          // 2. Allocation Results Section\n          consolidatedData.push([t(\"ResultsDisplay.aggregatedTitle\", { defaultValue: \"Allocation per Period\" })]);\n          consolidatedData.push([]);\n          consolidatedData.push([getPeriodHeader(), t(\"ResultsDisplay.daysHeader\"), t(\"ResultsDisplay.proportionHeader\"), t(\"ResultsDisplay.amountHeader\")]);\n          \n          results.aggregatedSplits?.forEach(split => {\n              consolidatedData.push([\n                  formatPeriodIdForDisplay(split.periodIdentifier),\n                  split.daysInPeriod,\n                  split.proportion,\n                  split.totalSplitAmount\n              ]);\n          });\n          \n          consolidatedData.push([t(\"ResultsDisplay.totalLabel\", { defaultValue: \"Total\" }), totalDurationDays, 1, totalAggregatedAmount]);\n          consolidatedData.push([]);\n          consolidatedData.push([]);\n          \n          // 3. Detailed Calculation Section\n          if (results.calculationSteps) {\n              const steps = results.calculationSteps;\n              const { periodSegments, amountCalculations } = steps;\n              \n              // a. Add title\n              consolidatedData.push([t('ResultsDisplay.calculationStepsTitle', { defaultValue: \"View Full Split Calculation\" })]);\n              consolidatedData.push([]);\n              \n              // b. Add total duration section\n              consolidatedData.push([t('ResultsDisplay.totalDuration')]);\n              consolidatedData.push([\n                  t('ResultsDisplay.periodLabel'), \n                  `${formatDateForDisplay(typeof steps.totalDuration.start === 'string' ? new Date(steps.totalDuration.start) : steps.totalDuration.start)} - ${formatDateForDisplay(typeof steps.totalDuration.end === 'string' ? new Date(steps.totalDuration.end) : steps.totalDuration.end)}`\n              ]);\n              consolidatedData.push([\n                  t('ResultsDisplay.totalDays'),\n                  `${steps.totalDuration.days} ${steps.totalDuration.included ? t('ResultsDisplay.inclusiveLabel') : t('ResultsDisplay.exclusiveLabel')}`\n              ]);\n              consolidatedData.push([]);\n\n              // c. Add proportion calculation\n              consolidatedData.push([t('ResultsDisplay.proportionCalculation')]);\n              for (const segment of periodSegments) {\n                  consolidatedData.push([\n                      formatPeriodIdForDisplay(segment.periodIdentifier),\n                      `${segment.days} / ${steps.totalDuration.days} = ${utilFormatPercent(segment.proportion, currentLocale)}`\n                  ]);\n              }\n              consolidatedData.push([]);\n              \n              // d. Add amount calculations\n              consolidatedData.push([t('ResultsDisplay.splitCalculation')]);\n              consolidatedData.push([]);\n              \n              for (let i = 0; i < amountCalculations.length; i++) {\n                  const amtCalc = amountCalculations[i];\n                  consolidatedData.push([`${t(\"ResultsDisplay.inputAmountLabel\")} #${i + 1}:`, formatNumForDisplay(amtCalc.originalAmount)]);\n                  \n                  for (const split of amtCalc.periodSplits) {\n                      const periodSeg = periodSegments.find(s => s.periodIdentifier === split.periodIdentifier);\n                      consolidatedData.push([\n                          formatPeriodIdForDisplay(split.periodIdentifier),\n                          `${formatNumForDisplay(amtCalc.originalAmount)}  ${periodSeg?.proportion.toFixed(6)} = ${split.rawSplit.toFixed(6)}  ${formatNumForDisplay(split.roundedSplit)}`\n                      ]);\n                      \n                      if (split.adjustment !== 0) {\n                          consolidatedData.push([\n                              `  ${t(\"ResultsDisplay.adjustmentLabel\")}:`,\n                              formatNumForDisplay(split.adjustment)\n                          ]);\n                      }\n                  }\n                  \n                  consolidatedData.push([\n                      t(\"ResultsDisplay.discrepancyLabel\"),\n                      formatNumForDisplay(amtCalc.discrepancy)\n                  ]);\n                  \n                  if (amtCalc.adjustmentAppliedToPeriod) {\n                      consolidatedData.push([\n                          t(\"ResultsDisplay.adjustedInYearLabel\", { defaultValue: \"Applied in Year\" }),\n                          formatPeriodIdForDisplay(amtCalc.adjustmentAppliedToPeriod)\n                      ]);\n                  }\n                  \n                  consolidatedData.push([\n                      t(\"ResultsDisplay.finalSumLabel\"),\n                      formatNumForDisplay(amtCalc.finalSum)\n                  ]);\n                  \n                  consolidatedData.push([]);\n              }\n          }\n          \n          // Create the consolidated worksheet with all data\n          const consolidatedSheet = XLSX.utils.aoa_to_sheet(consolidatedData);\n          \n          // Apply cell formatting for numbers and percentages\n          // Find the row range for the allocation results table (skip headers)\n          const allocationTableStartRow = 12; // 0-based index for the first data row after headers\n          const allocationTableEndRow = allocationTableStartRow + (results.aggregatedSplits?.length || 0);\n          \n          // Format proportion column (index 2) as percentage\n          for (let R = allocationTableStartRow; R < allocationTableEndRow; R++) {\n              const propCellRef = XLSX.utils.encode_cell({ c: 2, r: R });\n              if (consolidatedSheet[propCellRef]) {\n                  consolidatedSheet[propCellRef].t = 'n';\n                  consolidatedSheet[propCellRef].z = '0.00%';\n              }\n          }\n          \n          // Format amount column (index 3) with proper decimal places\n          for (let R = allocationTableStartRow; R < allocationTableEndRow + 1; R++) { // +1 to include total row\n              const amtCellRef = XLSX.utils.encode_cell({ c: 3, r: R });\n              if (consolidatedSheet[amtCellRef]) {\n                  consolidatedSheet[amtCellRef].t = 'n';\n                  consolidatedSheet[amtCellRef].z = `#,##0.${'0'.repeat(settings.decimalPlaces || 2)}`;\n              }\n          }\n          \n          // Add the consolidated sheet to the workbook with a meaningful name\n          XLSX.utils.book_append_sheet(\n              workbook, \n              consolidatedSheet, \n              t(\"ResultsDisplay.consolidatedSheetName\", { defaultValue: \"Invoice Split Report\" })\n          );\n          \n          const filename = `InvoiceSplit_${format(new Date(), 'yyyyMMdd')}.xlsx`;\n          XLSX.writeFile(workbook, filename);\n      }).catch(error => {\n          console.error(\"Failed to load xlsx library or export Excel:\", error);\n          alert(\"Failed to export Excel. Please try again.\");\n      });\n  }\n\n  function handleExportPdf() {\n      Promise.all([import('jspdf'), import('jspdf-autotable')]).then(([{ jsPDF }, { default: autoTable }]) => {\n          try {\n              const doc = new jsPDF() as JsPDFWithInternal;\n              let yPos = 20;\n              const filename = `InvoiceSplit_${format(new Date(), 'yyyyMMdd')}.pdf`;\n\n              // Summary Section\n              doc.text(`${t(\"ResultsDisplay.periodLabel\")}: ${utilFormatDateLocale(inputData.startDate, currentLocale)} - ${utilFormatDateLocale(inputData.endDate, currentLocale)}`, 14, yPos); yPos += 5;\n              doc.text(`${t(\"ResultsDisplay.originalTotalLabel\", { defaultValue: \"Total Input Amount:\" })}: ${utilFormatNumber(totalInputAmount, currentLocale, settings)}`, 14, yPos); yPos += 15;\n              doc.text(`${t(\"ResultsDisplay.totalDurationLabel\", { defaultValue: \"Total Duration (days)\" })}: ${totalDurationDays} ${t(\"ResultsDisplay.daysLabel\")}`, 14, yPos); yPos += 5;\n              doc.text(`${t(\"InvoiceForm.includeEndDateLabel\", { defaultValue: \"Include Final Day in Service Period?\" })}: ${inputData.includeEndDate ? t(\"ResultsDisplay.yesLabel\", { defaultValue: \"Yes\" }) : t(\"ResultsDisplay.noLabel\", { defaultValue: \"No\" })}`, 14, yPos); yPos += 5;\n              doc.text(`${t(\"InvoiceForm.splitPeriodLabel\", { defaultValue: \"Split Period\" })}: ${splitPeriodUsed === 'yearly' ? t('InvoiceForm.periodYearly') : splitPeriodUsed === 'quarterly' ? t('InvoiceForm.periodQuarterly') : t('InvoiceForm.periodMonthly')}`, 14, yPos); yPos += 5;\n\n              // Allocation Table\n              const tableRowsData = results.aggregatedSplits?.map(split => [\n                  formatPeriodIdentifier(split.periodIdentifier, splitPeriodUsed, currentLocale),\n                  split.daysInPeriod,\n                  utilFormatPercent(split.proportion, currentLocale),\n                  utilFormatNumber(split.totalSplitAmount, currentLocale, settings)\n              ]) || [];\n              autoTable(doc, {\n                  head: [[getPeriodHeader(), t(\"ResultsDisplay.daysHeader\"), t(\"ResultsDisplay.proportionHeader\"), t(\"ResultsDisplay.amountHeader\")]],\n                  body: tableRowsData,\n                  foot: [[t(\"ResultsDisplay.totalLabel\", { defaultValue: \"Total\" }), totalDurationDays, utilFormatPercent(1, currentLocale), utilFormatNumber(totalAggregatedAmount, currentLocale, settings)]],\n                  startY: yPos, \n                  theme: 'grid', \n                  headStyles: { fillColor: [46, 90, 140] }, \n                  footStyles: { fillColor: [240, 240, 240], textColor: 40, fontStyle: 'bold' },\n                  didParseCell: function (data: CellHookData) { \n                      if (data.column.index !== undefined && [1, 2, 3].includes(data.column.index)) {\n                          data.cell.styles.halign = 'right';\n                      }\n                  }\n              });\n              \n              // Calculation Steps Section\n              if (results.calculationSteps) {\n                  const steps = results.calculationSteps;\n                  const { periodSegments, amountCalculations } = steps;\n                  yPos = doc.lastAutoTable?.finalY ? doc.lastAutoTable.finalY + 15 : yPos + 50;\n                  \n                  doc.text(t('ResultsDisplay.calculationStepsTitle', { defaultValue: \"View Full Split Calculation\" }), 14, yPos);\n                  yPos += 10;\n                  \n                  doc.text(t('ResultsDisplay.totalDuration'), 14, yPos);\n                  yPos += 7;\n                  \n                  // Use type assertions to handle the string dates from the API\n                  const startDate = steps.totalDuration.start as string;\n                  const endDate = steps.totalDuration.end as string;\n                  \n                  doc.text(`${t('ResultsDisplay.periodLabel')}: ${utilFormatDateLocale(startDate, currentLocale)} - ${utilFormatDateLocale(endDate, currentLocale)}`, 20, yPos);\n                  yPos += 5;\n                  doc.text(`${t('ResultsDisplay.totalDays')}: ${steps.totalDuration.days} ${steps.totalDuration.included ? t('ResultsDisplay.inclusiveLabel') : t('ResultsDisplay.exclusiveLabel')}`, 20, yPos);\n                  yPos += 10;\n                  \n                  doc.text(t('ResultsDisplay.proportionCalculation'), 14, yPos);\n                  yPos += 7;\n                  doc.setFontSize(10);\n                  \n                  if (yPos > doc.internal.pageSize.height - 50) { doc.addPage(); yPos = 20; }\n                  \n                  for (const segment of periodSegments) {\n                      doc.text(`${formatPeriodIdentifier(segment.periodIdentifier, splitPeriodUsed, currentLocale)}: ${segment.days} / ${steps.totalDuration.days} = ${utilFormatPercent(segment.proportion, currentLocale)}`, 20, yPos);\n                      yPos += 5;\n                      if (yPos > doc.internal.pageSize.height - 30) { doc.addPage(); yPos = 20; }\n                  }\n                  yPos += 5;\n                  \n                  doc.text(t('ResultsDisplay.splitCalculation'), 14, yPos);\n                  yPos += 7;\n                  \n                  for (let i = 0; i < amountCalculations.length; i++) {\n                      const amtCalc = amountCalculations[i];\n                      if (yPos > doc.internal.pageSize.height - 70) { doc.addPage(); yPos = 20; }\n                      doc.setFontSize(11);\n                      doc.text(`${t(\"ResultsDisplay.inputAmountLabel\")} #${i + 1}: ${utilFormatNumber(amtCalc.originalAmount, currentLocale, settings)}`, 20, yPos);\n                      yPos += 7;\n                      doc.setFontSize(10);\n                      \n                      for (const split of amtCalc.periodSplits) {\n                          const periodSeg = periodSegments.find(s => s.periodIdentifier === split.periodIdentifier);\n                          doc.text(`${formatPeriodIdentifier(split.periodIdentifier, splitPeriodUsed, currentLocale)}:`, 25, yPos);\n                          yPos += 5;\n                          doc.text(`${utilFormatNumber(amtCalc.originalAmount, currentLocale, settings)}  ${periodSeg?.proportion.toFixed(6)} = ${split.rawSplit.toFixed(6)}`, 30, yPos);\n                          yPos += 5;\n                          doc.text(` ${t(\"ResultsDisplay.roundedLabel\")}: ${utilFormatNumber(split.roundedSplit, currentLocale, settings)}`, 30, yPos);\n                          yPos += 5;\n                          if (split.adjustment !== 0) { doc.text(`${t(\"ResultsDisplay.adjustmentLabel\")}: ${utilFormatNumber(split.adjustment, currentLocale, settings)}`, 30, yPos); yPos += 5; }\n                          if (yPos > doc.internal.pageSize.height - 40) { doc.addPage(); yPos = 20; }\n                      }\n                      doc.text(`${t(\"ResultsDisplay.discrepancyLabel\")}: ${utilFormatNumber(amtCalc.discrepancy, currentLocale, settings)}`, 25, yPos);\n                      yPos += 5;\n                      if (amtCalc.adjustmentAppliedToPeriod) {\n                          doc.text(`${t(\"ResultsDisplay.adjustedInYearLabel\", { defaultValue: \"Applied in Year\" })}: ${formatPeriodIdentifier(amtCalc.adjustmentAppliedToPeriod, splitPeriodUsed, currentLocale)}`, 25, yPos);\n                          yPos += 5;\n                      }\n                      doc.text(`${t(\"ResultsDisplay.finalSumLabel\")}: ${utilFormatNumber(amtCalc.finalSum, currentLocale, settings)}`, 25, yPos);\n                      yPos += 10;\n                      if (yPos > doc.internal.pageSize.height - 50 && i < amountCalculations.length - 1) { doc.addPage(); yPos = 20; }\n                  }\n              }\n              \n              const pageCount = doc.internal.getNumberOfPages();\n              doc.setFontSize(8);\n              for (let i = 1; i <= pageCount; i++) {\n                  doc.setPage(i);\n                  doc.text(`Generated by BillSplitter - ${format(new Date(), 'PPpp', { locale: currentLocale === 'de' ? de : enUS })}`, 14, doc.internal.pageSize.height - 10);\n                  doc.text(`Page ${i} of ${pageCount}`, doc.internal.pageSize.width - 35, doc.internal.pageSize.height - 10);\n              }\n              doc.save(filename);\n          } catch (error) {\n              console.error(\"Error generating PDF:\", error);\n              alert(\"Failed to generate PDF. Please try again.\");\n          }\n      }).catch(error => {\n          console.error(\"Failed to load PDF generation libraries:\", error);\n          alert(\"Failed to load PDF generation libraries. Please try again.\");\n      });\n  }\n\n                  return (\n    <div className=\"w-full animate-fadeIn\">\n      {/* Wrap everything except the modal in a single card */}\n      <Card className=\"shadow-lg border border-border/50\">\n        <CardContent className=\"p-6 space-y-8\">\n          <Card className=\"shadow-md border border-border/40 overflow-hidden\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex justify-between items-center mb-6 pb-4 border-b\">\n                <h3 className=\"text-xl font-semibold text-primary\">\n                  {t(\"ResultsDisplay.summaryTitle\")}\n                </h3>\n                <button\n                  onClick={() => setIsSettingsOpen(true)}\n                  className=\"p-1.5 rounded-md text-muted-foreground hover:text-foreground hover:bg-muted transition-colors\"\n                  aria-label={t(\"ResultsDisplay.settingsLabel\")}\n                >\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                    <path d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"/>\n                    <circle cx=\"12\" cy=\"12\" r=\"3\"/>\n                  </svg>\n                </button>\n              </div>\n              <div className=\"space-y-2 text-sm text-muted-foreground\">\n                <div className=\"flex justify-between\">\n                  <span>{t(\"ResultsDisplay.periodLabel\")}</span>\n                  <span className=\"font-medium text-foreground\">\n                    {formatDateForDisplay(inputData.startDate)} - {\" \"}\n                    {formatDateForDisplay(inputData.endDate)}\n                  </span>\n            </div>\n                <div className=\"flex justify-between\">\n                  <span>{t(\"ResultsDisplay.totalDurationLabel\", { defaultValue: \"Total Duration (days)\" })}</span>\n                  <span className=\"font-medium text-foreground\">\n                    {totalDurationDays} {t(\"ResultsDisplay.daysLabel\")}\n                  </span>\n              </div>\n                <div className=\"flex justify-between\">\n                  <span>{t(\"InvoiceForm.includeEndDateLabel\", { defaultValue: \"Include Final Day in Service Period?\" })}</span>\n                  <span className=\"font-medium text-foreground\">\n                    {inputData.includeEndDate ? t(\"ResultsDisplay.yesLabel\", { defaultValue: \"Yes\" }) : t(\"ResultsDisplay.noLabel\", { defaultValue: \"No\" })}\n                </span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span>{t(\"InvoiceForm.splitPeriodLabel\", { defaultValue: \"Split Period\" })}</span>\n                  <span className=\"font-medium text-foreground\">\n                     {splitPeriodUsed === 'yearly' && t('InvoiceForm.periodYearly')}\n                     {splitPeriodUsed === 'quarterly' && t('InvoiceForm.periodQuarterly')}\n                     {splitPeriodUsed === 'monthly' && t('InvoiceForm.periodMonthly')}\n                </span>\n                  </div>\n                 <div className=\"flex justify-between pt-2 border-t border-border/30\">\n                  <span className=\"font-semibold text-foreground\">{t(\"ResultsDisplay.originalTotalLabel\", { defaultValue: \"Total Input Amount:\" })}</span>\n                  <span className=\"font-semibold text-foreground\">\n                    {formatNumForDisplay(totalInputAmount)}\n                </span>\n              </div>\n            </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"shadow-md border border-border/40 overflow-hidden\">\n            <CardContent className=\"p-6\">\n              <h3 className=\"text-xl font-semibold mb-6 pb-4 border-b text-primary\">\n                {t(\"ResultsDisplay.aggregatedTitle\", { defaultValue: \"Allocation per Period\" })}\n              </h3>\n          <Table>\n            <TableHeader>\n              <TableRow>\n                    <TableHead>{getPeriodHeader()}</TableHead>\n                <TableHead className=\"text-right\">{t(\"ResultsDisplay.daysHeader\")}</TableHead>\n                <TableHead className=\"text-right\">{t(\"ResultsDisplay.proportionHeader\")}</TableHead>\n                    <TableHead className=\"text-right\">{t(\"ResultsDisplay.amountHeader\")}</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n                  {results.aggregatedSplits?.map((split, index) => (\n                    <TableRow key={index}>\n                      <TableCell className=\"font-medium text-foreground whitespace-nowrap\">\n                        {formatPeriodIdForDisplay(split.periodIdentifier)}\n                  </TableCell>\n                      {/* Assuming AggregatedPeriodSplit has daysInPeriod */}\n                      <TableCell className=\"text-right text-muted-foreground\">{split.daysInPeriod}</TableCell>\n                      <TableCell className=\"text-right text-muted-foreground\">{formatPctForDisplay(split.proportion)}</TableCell>\n                      {/* Assuming AggregatedPeriodSplit has totalSplitAmount */}\n                      <TableCell className=\"text-right font-medium text-foreground\">{formatNumForDisplay(split.totalSplitAmount)}</TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n            <TableFooter>\n                  <TableRow>\n                    <TableCell>{t(\"ResultsDisplay.totalLabel\", { defaultValue: \"Total\" })}</TableCell>\n                    <TableCell className=\"text-right font-semibold text-foreground\">{totalDurationDays}</TableCell>\n                    <TableCell className=\"text-right font-semibold text-foreground\">{formatPctForDisplay(1)}</TableCell>\n                    <TableCell className=\"text-right font-semibold text-foreground\">{formatNumForDisplay(totalAggregatedAmount)}</TableCell>\n              </TableRow>\n            </TableFooter>\n          </Table>\n            </CardContent>\n          </Card>\n\n          {/* Calculation Details Accordion */}\n          <Accordion type=\"single\" collapsible className=\"w-full\">\n              <AccordionItem value=\"item-1\" className=\"border rounded-lg shadow-md bg-card\">\n                  <AccordionTrigger className=\"px-6 py-4 text-lg font-semibold text-primary hover:bg-muted/40\">\n                      {t('ResultsDisplay.calculationStepsTitle', { defaultValue: \"View Full Split Calculation\" })}\n            </AccordionTrigger>\n                  <AccordionContent className=\"px-6 py-4 bg-background border-t\">\n                      {results.calculationSteps ? (\n                          <CalculationStepsDisplay steps={results.calculationSteps} settings={settings} splitPeriodUsed={splitPeriodUsed}/>\n                      ) : (\n                          <p>{t('ResultsDisplay.noStepsAvailable')}</p>\n                      )}\n            </AccordionContent>\n          </AccordionItem>\n        </Accordion>\n\n          {/* Export Buttons Section */}\n          <div className=\"flex flex-col sm:flex-row justify-center gap-4 pt-4 border-t border-border/30\">\n            <Button\n                variant=\"outline\"\n                onClick={handleExportExcel}\n                className=\"w-full sm:w-auto\"\n            >\n                 <svg className=\"mr-2 h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                    <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/>\n                    <polyline points=\"14 2 14 8 20 8\"/>\n                    <line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\"/>\n                    <line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\"/>\n                    <polyline points=\"10 9 9 9 8 9\"/>\n                </svg>\n                {t('ResultsDisplay.exportExcelButton')}\n            </Button>\n            <Button\n                variant=\"outline\"\n                onClick={handleExportPdf}\n                className=\"w-full sm:w-auto\"\n            >\n                <svg className=\"mr-2 h-4 w-4\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                    <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/>\n                    <polyline points=\"14 2 14 8 20 8\"/>\n                    <line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\"/>\n                    <line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\"/>\n                    <polyline points=\"10 9 9 9 8 9\"/>\n                </svg>\n                {t('ResultsDisplay.exportPdfButton')}\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Settings Modal remains outside the main card */}\n      <SettingsModal isOpen={isSettingsOpen} onOpenChange={setIsSettingsOpen} />\n    </div>\n  );\n}\n\n// Wrapper component to provide context\nexport function ResultsDisplay(props: ResultsDisplayProps) {\n  return <ResultsDisplayComponent {...props} />;\n}\n","\"use client\";\n\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { CalculationInput, CalculationResult } from \"@/lib/calculations\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Suspense, useCallback, useEffect, useRef, useState } from \"react\";\n\n// Import the CalculationCallbackData type from InvoiceForm\nimport { CalculationCallbackData } from \"@/components/invoice-form\";\nimport Cookies from 'js-cookie';\nimport { GoogleAnalytics } from '@next/third-parties/google';\nimport { Loader2 } from \"lucide-react\";\nimport { ResultsDisplay } from \"@/components/results-display\";\nimport { SettingsModal } from \"@/components/settings-modal\";\nimport { Terminal } from \"lucide-react\";\nimport dynamic from 'next/dynamic';\nimport { safeText } from \"@/lib/utils\";\nimport { useTranslation } from '@/translations';\n\n// Define a type for the demo data that matches the one in InvoiceForm\ntype DemoDataType = {\n  startDateString?: string;\n  endDateString?: string;\n  amount?: string;\n  includeEndDate?: boolean;\n  splitPeriod?: 'yearly' | 'quarterly' | 'monthly';\n  isDemo?: boolean;\n} | null;\n\n// Dynamic import of the InvoiceForm component with SSR disabled for faster loading\nconst InvoiceForm = dynamic(\n  () => import('@/components/invoice-form').then(mod => ({ default: mod.InvoiceForm })),\n  { \n    ssr: false,\n    loading: () => (\n      <div className=\"space-y-6 animate-pulse\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"h-24 bg-muted/60 rounded-lg\"></div>\n          <div className=\"h-24 bg-muted/60 rounded-lg\"></div>\n        </div>\n        <div className=\"h-20 bg-muted/60 rounded-lg\"></div>\n        <div className=\"h-48 bg-muted/60 rounded-lg\"></div>\n        <div className=\"h-10 bg-muted/60 rounded-lg\"></div>\n      </div>\n    )\n  }\n);\n\n// Define a type alias that matches ResultsDisplay's expected inputData type\ntype InputDataForDisplay = Pick<\n  CalculationInput,\n  \"startDate\" | \"endDate\" | \"includeEndDate\" | \"amounts\" | \"splitPeriod\"\n>;\n\n// Define a more specific type for the error parameter\ntype CalculationErrorType = string | Error | { message?: string; [key: string]: unknown } | null | undefined;\n\nexport default function InvoiceCalculatorClient() {\n  const { t } = useTranslation();\n  const [mounted, setMounted] = useState(false);\n  const [dynamicTitle, setDynamicTitle] = useState<string>('');\n  const [calculationResult, setCalculationResult] = useState<CalculationResult | null>(null);\n  const [calculationError, setCalculationError] = useState<string | null>(null);\n  const [storedInputData, setStoredInputData] = useState<CalculationCallbackData>(null);\n  const [isSettingsOpen, setIsSettingsOpen] = useState(false);\n  const resultsSectionRef = useRef<HTMLDivElement>(null);\n  // State for holding demo data to pass as prop\n  const [initialDemoData, setInitialDemoData] = useState<DemoDataType>(null);\n  // Ref to track if we've already processed demo data to avoid duplicate processing\n  const demoDataProcessedRef = useRef(false);\n\n  // --- Consent Management State and Logic --- \n  const gaMeasurementId = \"G-9H2KTHX5YK\"; \n  const consentCookieName = \"siempiBillSplitterConsent\";\n  const [hasConsent, setHasConsent] = useState(false);\n\n  // Add cleanup effect that runs on component unmount\n  useEffect(() => {\n    // This cleanup will run when the component unmounts\n    return () => {\n      if (typeof window !== 'undefined') {\n        // Safely capture current values for logging (useful for debugging)\n        const hasDemoData = sessionStorage.getItem('billSplitterDemoData') !== null;\n        const hasFormCache = sessionStorage.getItem('invoiceFormDataCache') !== null;\n        \n        // Safely remove only the form cache on unmount.\n        // Let InvoiceForm handle clearing billSplitterDemoData after processing.\n        try {\n          // sessionStorage.removeItem('billSplitterDemoData'); // REMOVED\n          sessionStorage.removeItem('invoiceFormDataCache');\n          console.log('[InvoiceCalculatorClient] Cleaned up sessionStorage on unmount', { \n            hadDemoData: hasDemoData, \n            hadFormCache: hasFormCache, \n            // Note: billSplitterDemoData is no longer removed here.\n          });\n        } catch (error) {\n          console.error('[InvoiceCalculatorClient] Error clearing sessionStorage on unmount:', error);\n        }\n      }\n    };\n  }, []); // Empty dependency array means this runs only on mount/unmount\n\n  // Effect just for setting mounted state and title\n  useEffect(() => {\n    setMounted(true);\n    setDynamicTitle(t('InvoiceForm.title'));\n\n    // Check consent cookie\n    const consentGiven = Cookies.get(consentCookieName) === \"true\";\n    setHasConsent(consentGiven);\n  }, [t, consentCookieName]);\n\n  // Separate effect ONLY for reading demo data\n  useEffect(() => {\n    // Only process sessionStorage once per component lifecycle\n    if (demoDataProcessedRef.current) {\n      return;\n    }\n\n    // Read demo data from sessionStorage\n    if (typeof window !== 'undefined') {\n      const demoDataString = sessionStorage.getItem('billSplitterDemoData');\n      console.log(\"[InvoiceCalculatorClient] Reading sessionStorage billSplitterDemoData:\", demoDataString);\n      \n      if (demoDataString) {\n        try {\n          const parsedDemoData = JSON.parse(demoDataString);\n          if (parsedDemoData && parsedDemoData.isDemo) {\n            // Clear localStorage cache first to ensure it doesn't override demo data\n            localStorage.removeItem('invoiceFormDataCache');\n            console.log(\"[InvoiceCalculatorClient] Cleared localStorage cache to ensure demo data is used\");\n            \n            console.log(\"[InvoiceCalculatorClient] Setting initialDemoData state:\", parsedDemoData);\n            setInitialDemoData(parsedDemoData);\n            \n            // Clear sessionStorage immediately\n            sessionStorage.removeItem('billSplitterDemoData');\n            console.log(\"[InvoiceCalculatorClient] Removed billSplitterDemoData from sessionStorage\");\n            \n            // Mark as processed to prevent re-reading\n            demoDataProcessedRef.current = true;\n          } else {\n            sessionStorage.removeItem('billSplitterDemoData');\n          }\n        } catch (error) {\n          console.error(\"[InvoiceCalculatorClient] Error parsing demo data:\", error);\n          sessionStorage.removeItem('billSplitterDemoData');\n        }\n      }\n    }\n  }, []); // No dependencies - runs once on mount\n\n  // Callback for InvoiceForm to signal demo data has been processed\n  const handleDemoDataApplied = useCallback(() => {\n    console.log(\"[InvoiceCalculatorClient] Demo data processed by InvoiceForm, clearing state\");\n    setInitialDemoData(null);\n  }, []);\n\n  const handleCalculation = (\n    formData: CalculationCallbackData,\n    results: CalculationResult | null,\n    error?: CalculationErrorType // Use the more specific type\n   ) => {\n    setCalculationResult(results);\n    let displayError: string | null = null;\n    if (error) {\n        const baseErrorTitle = t('Errors.calculationErrorTitle');\n        if (typeof error === 'string') {\n            if (error.includes(\"At least one amount is required\")) {\n                displayError = baseErrorTitle + \": \" + t('InvoiceForm.errorAmountRequired');\n            } else if (error.includes(\"Start date must be before\")) {\n                displayError = baseErrorTitle + \": \" + t('InvoiceForm.errorEndDateBeforeStart');\n            } else {\n                displayError = baseErrorTitle + \": \" + error;\n            }\n        } else if (error instanceof Error) {\n            // Handle standard Error objects\n            displayError = baseErrorTitle + \": \" + error.message;\n            console.error(\"[InvoiceCalculatorClient] Error object received:\", error);\n        } else if (error && typeof error === 'object') {\n            // Improved handling for object errors\n            if ('message' in error && typeof error.message === 'string') {\n                displayError = baseErrorTitle + \": \" + error.message;\n            } else {\n                // For objects without a message property, convert to JSON string or use generic message\n                try {\n                    const stringifiedError = JSON.stringify(error);\n                    displayError = baseErrorTitle + \": \" + (stringifiedError !== \"{}\" ? stringifiedError : t('Errors.unexpectedError'));\n                } catch {\n                    // If JSON stringification fails\n                    displayError = baseErrorTitle + \": \" + t('Errors.unexpectedError');\n                }\n            }\n            console.error(\"[InvoiceCalculatorClient] Error object received:\", error);\n        } else {\n            // For other non-string errors or null/undefined that somehow made it here\n            displayError = baseErrorTitle + \": \" + t('Errors.unexpectedError');\n            console.error(\"[InvoiceCalculatorClient] An unexpected or non-standard error was received:\", error);\n        }\n    }\n    setCalculationError(displayError);\n\n    // If there was any kind of error, we should ensure results are not processed as successful\n    if (formData && results && !displayError) { // Check against displayError now\n        setStoredInputData(formData);\n        // Use requestAnimationFrame + timeout to ensure the layout is stable before scrolling\n        setTimeout(() => {\n          requestAnimationFrame(() => {\n            if (resultsSectionRef.current) {\n              resultsSectionRef.current.scrollIntoView({ \n                behavior: 'smooth', \n                block: 'start' \n              });\n            }\n          });\n        }, 200); // Slightly longer delay to ensure layout is fully settled\n    } else {\n        setStoredInputData(null);\n        // If there was an error, but results were somehow passed, clear them too\n        if (displayError) {\n            setCalculationResult(null);\n        }\n    }\n  };\n\n  return (\n    <>\n      {/* Conditionally render Google Analytics only if consent is given */}\n      {hasConsent && gaMeasurementId && <GoogleAnalytics gaId={gaMeasurementId} />}\n\n      <div className=\"container mx-auto px-4 py-8 max-w-4xl grow overflow-hidden w-full\">\n        {/* Title and description moved outside the card */}\n        <div className=\"text-center mb-8\">\n          {!mounted ? (\n            <>\n              <div className=\"h-9 bg-muted/60 rounded-md animate-pulse w-1/3 mx-auto mb-4\" />\n              <div className=\"h-4 bg-muted/60 rounded-sm animate-pulse w-2/3 mx-auto mb-2\" />\n              <div className=\"h-4 bg-muted/60 rounded-sm animate-pulse w-1/2 mx-auto\" />\n            </>\n          ) : (\n            <>\n              <h1 className=\"text-3xl font-bold mb-4\">\n                {dynamicTitle}\n              </h1>\n              <div className=\"max-w-2xl mx-auto space-y-2 px-4\">\n                <p>{t('InvoiceForm.description_p1')}</p>\n                <p>{t('InvoiceForm.description_p2')}</p>\n              </div>\n            </>\n          )}\n        </div>\n        \n        {/* Only show loading indicator when component is not mounted */}\n        {!mounted && (\n          <div className=\"flex items-center gap-2 justify-center text-muted-foreground text-sm mb-6\">\n            <Loader2 className=\"animate-spin h-4 w-4 text-primary\" />\n            <span>Loading calculator...</span>\n          </div>\n        )}\n        \n        {/* Fixed-width container for consistent card sizes */}\n        <div className=\"mx-auto\" style={{ maxWidth: \"768px\" }}>\n          {/* Form Card */}\n          <Card className=\"mb-12 shadow-md w-full transition-opacity duration-300 ease-in-out\" \n                data-loaded={mounted ? \"true\" : \"false\"}\n                style={{ opacity: mounted ? 1 : 0.85 }}>\n            <CardContent className=\"pt-6\">\n              <div className=\"w-full\">\n                <Suspense fallback={\n                  <div className=\"space-y-6 animate-pulse\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                      <div className=\"h-24 bg-muted/60 rounded-lg\"></div>\n                      <div className=\"h-24 bg-muted/60 rounded-lg\"></div>\n                    </div>\n                    <div className=\"h-20 bg-muted/60 rounded-lg\"></div>\n                    <div className=\"h-48 bg-muted/60 rounded-lg\"></div>\n                    <div className=\"h-10 bg-muted/60 rounded-lg\"></div>\n                  </div>\n                }>\n                  <InvoiceForm \n                    onCalculateAction={handleCalculation} \n                    initialDemoData={initialDemoData} // Pass state as prop\n                    onDemoDataApplied={handleDemoDataApplied} // Pass callback prop\n                  />\n                </Suspense>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Results Section */}\n          <div ref={resultsSectionRef} className=\"mt-12 w-full\">\n            {mounted && calculationError && (\n              <Alert variant=\"destructive\" className=\"w-full\">\n                <Terminal className=\"h-4 w-4\" />\n                <AlertTitle>{t('Errors.calculationErrorTitle')}</AlertTitle>\n                <AlertDescription>{safeText(calculationError)}</AlertDescription>\n              </Alert>\n            )}\n            {mounted && calculationResult && storedInputData && !calculationError && (\n              <ResultsDisplay \n                results={calculationResult} \n                inputData={storedInputData as InputDataForDisplay}\n              />\n            )}\n            {!mounted && calculationResult === null && (\n              <Card className=\"shadow-md w-full h-64 flex items-center justify-center\">\n                <div className=\"space-y-4 p-6 w-full\">\n                  <div className=\"h-6 bg-muted/60 rounded-md animate-pulse w-3/4 mx-auto mb-8\" />\n                  <div className=\"grid grid-cols-4 gap-4 mb-6\">\n                    <div className=\"h-4 bg-muted/60 rounded-sm animate-pulse\" />\n                    <div className=\"h-4 bg-muted/60 rounded-sm animate-pulse\" />\n                    <div className=\"h-4 bg-muted/60 rounded-sm animate-pulse\" />\n                    <div className=\"h-4 bg-muted/60 rounded-sm animate-pulse\" />\n                  </div>\n                  <div className=\"h-24 bg-muted/60 rounded-md animate-pulse\" />\n                </div>\n              </Card>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {mounted && <SettingsModal isOpen={isSettingsOpen} onOpenChange={setIsSettingsOpen} />}\n    </>\n  );\n}\n","\"use client\";\r\n\r\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\";\r\nimport * as React from \"react\";\r\n\r\nimport { AccessibleIcon } from \"@/components/ui/accessible-icon\";\r\nimport { XIcon } from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nfunction Dialog({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\r\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />;\r\n}\r\n\r\nfunction DialogTrigger({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\r\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />;\r\n}\r\n\r\nfunction DialogPortal({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\r\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />;\r\n}\r\n\r\nfunction DialogClose({\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\r\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />;\r\n}\r\n\r\nfunction DialogOverlay({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\r\n  return (\r\n    <DialogPrimitive.Overlay\r\n      data-slot=\"dialog-overlay\"\r\n      className={cn(\r\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 backdrop-blur-sm bg-black/30\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction DialogContent({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Content>) {\r\n  const [isMounted, setIsMounted] = React.useState(false);\r\n  const isMountedRef = React.useRef(true);\r\n\r\n  React.useEffect(() => {\r\n    isMountedRef.current = true;\r\n    const mountTimer = setTimeout(() => {\r\n      if (isMountedRef.current) {\r\n        setIsMounted(true);\r\n      }\r\n    }, 10); // Small delay to ensure DOM is ready for animations\r\n\r\n    return () => {\r\n      isMountedRef.current = false;\r\n      clearTimeout(mountTimer);\r\n      // No need to call setIsMounted(false) here.\r\n      // React will unmount the component and its contents naturally.\r\n      // The isMounted state is primarily for the initial mount animation.\r\n    };\r\n  }, []);\r\n\r\n  if (!isMounted) {\r\n    return null; // Render nothing until mounted (for entry animation)\r\n  }\r\n\r\n  return (\r\n    <DialogPortal data-slot=\"dialog-portal\">\r\n      <DialogOverlay />\r\n      <DialogPrimitive.Content\r\n        data-slot=\"dialog-content\"\r\n        className={cn(\r\n          \"bg-card data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-xl duration-200 sm:max-w-lg mx-auto\",\r\n          className,\r\n        )}\r\n        {...props}\r\n      >\r\n        {children}\r\n        <DialogPrimitive.Close\r\n          aria-label=\"Close dialog\"\r\n          className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-none disabled:pointer-events-none cursor-pointer\"\r\n        >\r\n          <AccessibleIcon label=\"Close\">\r\n            <XIcon className=\"size-4\" />\r\n          </AccessibleIcon>\r\n        </DialogPrimitive.Close>\r\n      </DialogPrimitive.Content>\r\n    </DialogPortal>\r\n  );\r\n}\r\n\r\nfunction DialogHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"dialog-header\"\r\n      className={cn(\"flex flex-col gap-2 text-center sm:text-left\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction DialogFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"dialog-footer\"\r\n      className={cn(\r\n        \"flex flex-col-reverse gap-2 sm:flex-row sm:justify-end\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction DialogTitle({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\r\n  return (\r\n    <DialogPrimitive.Title\r\n      data-slot=\"dialog-title\"\r\n      className={cn(\"text-lg leading-none font-semibold\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction DialogDescription({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\r\n  return (\r\n    <DialogPrimitive.Description\r\n      data-slot=\"dialog-description\"\r\n      className={cn(\"text-muted-foreground text-sm\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport {\r\n  Dialog,\r\n  DialogClose,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogOverlay,\r\n  DialogPortal,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n};\r\n","\"use client\";\n\nimport * as React from \"react\";\nimport * as SelectPrimitive from \"@radix-ui/react-select\";\n\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\nfunction Select({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />;\n}\n\nfunction SelectGroup({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />;\n}\n\nfunction SelectValue({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />;\n}\n\nfunction SelectTrigger({\n  className,\n  size = \"default\",\n  children,\n  id,\n  name,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\n  size?: \"sm\" | \"default\";\n  id?: string;\n  name?: string;\n}) {\n  return (\n    <SelectPrimitive.Trigger\n      data-slot=\"select-trigger\"\n      data-size={size}\n      id={id}\n      name={name}\n      className={cn(\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className,\n      )}\n      {...props}\n    >\n      {children}\n      <SelectPrimitive.Icon asChild>\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\n      </SelectPrimitive.Icon>\n    </SelectPrimitive.Trigger>\n  );\n}\n\nfunction SelectContent({\n  className,\n  children,\n  position = \"popper\",\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\n  return (\n    <SelectPrimitive.Portal>\n      <SelectPrimitive.Content\n        data-slot=\"select-content\"\n        className={cn(\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-40 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md\",\n          position === \"popper\" &&\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n          className,\n        )}\n        position={position}\n        {...props}\n      >\n        <SelectScrollUpButton />\n        <SelectPrimitive.Viewport\n          className={cn(\n            \"p-1\",\n            position === \"popper\" &&\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1\",\n          )}\n        >\n          {children}\n        </SelectPrimitive.Viewport>\n        <SelectScrollDownButton />\n      </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n  );\n}\n\nfunction SelectLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\n  return (\n    <SelectPrimitive.Label\n      data-slot=\"select-label\"\n      className={cn(\"text-muted-foreground px-2 py-1.5 text-xs\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction SelectItem({\n  className,\n  children,\n  id,\n  value,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Item> & { key?: React.Key }) {\n  const { key, ...restProps } = props;\n\n  return (\n    <SelectPrimitive.Item\n      key={key}\n      data-slot=\"select-item\"\n      id={id || (value ? `select-item-${value}` : undefined)}\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\n        className,\n      )}\n      value={value}\n      {...restProps}\n    >\n      <span className=\"absolute right-2 flex size-3.5 items-center justify-center\">\n        <SelectPrimitive.ItemIndicator>\n          <CheckIcon className=\"size-4\" />\n        </SelectPrimitive.ItemIndicator>\n      </span>\n      <SelectPrimitive.ItemText>\n        {children}\n      </SelectPrimitive.ItemText>\n    </SelectPrimitive.Item>\n  );\n}\n\nfunction SelectSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\n  return (\n    <SelectPrimitive.Separator\n      data-slot=\"select-separator\"\n      className={cn(\"bg-border pointer-events-none -mx-1 my-1 h-px\", className)}\n      {...props}\n    />\n  );\n}\n\nfunction SelectScrollUpButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\n  return (\n    <SelectPrimitive.ScrollUpButton\n      data-slot=\"select-scroll-up-button\"\n      className={cn(\n        \"flex cursor-default items-center justify-center py-1\",\n        className,\n      )}\n      {...props}\n    >\n      <ChevronUpIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollUpButton>\n  );\n}\n\nfunction SelectScrollDownButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\n  return (\n    <SelectPrimitive.ScrollDownButton\n      data-slot=\"select-scroll-down-button\"\n      className={cn(\n        \"flex cursor-default items-center justify-center py-1\",\n        className,\n      )}\n      {...props}\n    >\n      <ChevronDownIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollDownButton>\n  );\n}\n\nexport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectScrollDownButton,\n  SelectScrollUpButton,\n  SelectSeparator,\n  SelectTrigger,\n  SelectValue,\n};\n","import * as React from \"react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface InputProps extends React.ComponentProps<\"input\"> {\r\n  helperText?: string;\r\n  error?: string;\r\n  id?: string;\r\n}\r\n\r\nfunction Input(\r\n  { className, type, helperText, error, id, ...props }: InputProps,\r\n  ref: React.Ref<HTMLInputElement>,\r\n) {\r\n  const errorId = error ? `${id}-error` : undefined;\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      <input\r\n        id={id}\r\n        ref={ref}\r\n        type={type}\r\n        data-slot=\"input\"\r\n        aria-invalid={!!error}\r\n        aria-describedby={errorId}\r\n        className={cn(\r\n          \"flex h-10 w-full rounded-lg border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n          \"shadow-sm\",\r\n          \"selection:bg-primary selection:text-primary-foreground\",\r\n          error\r\n            ? \"border-destructive ring-destructive/40 focus-visible:ring-destructive\"\r\n            : \"\",\r\n          className,\r\n        )}\r\n        {...props}\r\n      />\r\n      {helperText && (\r\n        <p className=\"text-xs text-gray-500 mt-1 mb-3 pl-3\">{helperText}</p>\r\n      )}\r\n      {error && (\r\n        <p\r\n          id={errorId}\r\n          role=\"alert\"\r\n          className=\"text-sm font-medium text-destructive mt-1\"\r\n        >\r\n          {error}\r\n        </p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst ForwardedInput = React.forwardRef(Input);\r\n\r\nexport { ForwardedInput as Input };\r\n","\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nfunction Label({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\r\n  return (\r\n    <LabelPrimitive.Root\r\n      data-slot=\"label\"\r\n      className={cn(\r\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport { Label };\r\n"],"names":["defaultSettings","decimalPlaces","roundingPrecision","thousandsSeparator","SettingsContext","createContext","undefined","SettingsProvider","children","settings","setSettings","useState","loadedSettings","localStorage","getItem","initialSettings","JSON","parse","locale","isLoaded","setIsLoaded","useEffect","savedSettings","parsed","includes","prev","console","warn","removeItem","error","Provider","value","saveSettings","cleanSettings","newSettings","updatedSettings","setItem","stringify","useSettings","context","useContext","Accordion","props","AccordionPrimitive","data-slot","AccordionItem","className","cn","AccordionTrigger","ChevronDownIcon","AccordionContent","div","Form","FormProvider","FormFieldContext","React","FormField","name","Controller","useFormField","fieldContext","itemContext","FormItemContext","getFieldState","useFormContext","formState","useFormState","fieldState","id","formItemId","formDescriptionId","formMessageId","FormItem","FormLabelInternal","htmlFor","explicitHtmlFor","hasError","Label","data-error","derivedHtmlFor","FormLabel","Object","hasContext","keys","length","FormControl","Slot","aria-describedby","aria-invalid","FormDescription","p","FormMessage","body","String","message","buttonVariants","cva","variants","variant","default","destructive","outline","secondary","ghost","link","size","sm","lg","icon","defaultVariants","Button","asChild","Comp","VisuallyHidden","span","style","clip","AccessibleIcon","label","alertVariants","Alert","role","AlertTitle","AlertDescription","Card","CardContent","Table","table","TableHeader","thead","TableBody","tbody","TableFooter","tfoot","TableRow","tr","TableHead","th","TableCell","td","formatNumber","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","format","toFixed","formatDateLocale","dateInput","date","Date","DateTimeFormat","year","month","day","toISOString","split","formatPercent","FormSchema","z","nonempty","SettingsModal","isOpen","externalIsOpen","onOpenChange","externalOnOpenChange","t","useTranslation","internalIsOpen","setInternalIsOpen","isMounted","setIsMounted","isValid","setIsValid","form","useForm","resolver","zodResolver","defaultValues","toString","defaultSeparator","mode","reset","subscription","watch","hasErrors","errors","formValues","getValues","isDecimalEmpty","unsubscribe","currentSeparator","triggerLabel","dialogTitle","dialogDescription","saveLabel","onClick","aria-label","Settings","Dialog","open","handleOpenChange","DialogContent","DialogHeader","DialogTitle","UiDialogDescription","onSubmit","handleSubmit","Number","data","isNaN","setError","type","replace","newLocale","window","dispatchEvent","CustomEvent","detail","control","render","field","Input","required","Select","onValueChange","onChange","SelectTrigger","SelectValue","SelectContent","SelectItem","DialogFooter","disabled","isSubmitting","formatPeriodIdentifier","identifier","periodType","parseInt","de","enUS","CalculationStepsDisplay","steps","splitPeriodUsed","i18n","currentLocale","language","periodSegments","amountCalculations","fmtNum","utilFormatNumber","num","fmtPeriod","fmtDate","utilFormatDateLocale","dateStr","fmtPct","utilFormatPercent","val","section","h4","totalDuration","start","end","days","included","map","seg","periodIdentifier","proportion","amtCalc","index","originalAmount","periodSplits","ps","periodIndex","find","s","rawSplit","roundedSplit","adjustment","Math","abs","discrepancy","adjustmentAppliedToPeriod","defaultValue","finalSum","ResultsDisplayComponent","results","inputData","isSettingsOpen","setIsSettingsOpen","splitPeriod","formatNumForDisplay","formatPctForDisplay","formatDateForDisplay","dateObj","formatPeriodIdForDisplay","getPeriodHeader","totalDurationDays","calculationSteps","totalInputAmount","amounts","reduce","sum","totalAggregatedAmount","aggregatedSplits","totalSplitAmount","h3","button","svg","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","path","d","circle","cx","cy","r","startDate","endDate","includeEndDate","daysInPeriod","collapsible","handleExportExcel","then","XLSX","workbook","utils","book_new","consolidatedData","push","forEach","segment","i","periodSeg","consolidatedSheet","aoa_to_sheet","allocationTableEndRow","allocationTableStartRow","R","propCellRef","encode_cell","c","amtCellRef","repeat","book_append_sheet","filename","writeFile","catch","alert","polyline","points","line","x1","y1","x2","y2","handleExportPdf","Promise","all","jsPDF","autoTable","doc","yPos","text","tableRowsData","head","foot","startY","theme","headStyles","fillColor","footStyles","textColor","fontStyle","didParseCell","column","cell","styles","halign","lastAutoTable","finalY","setFontSize","internal","pageSize","addPage","pageCount","getNumberOfPages","setPage","save","ResultsDisplay","InvoiceForm","dynamic","mod","ssr","loading","InvoiceCalculatorClient","mounted","setMounted","dynamicTitle","setDynamicTitle","calculationResult","setCalculationResult","calculationError","setCalculationError","storedInputData","setStoredInputData","resultsSectionRef","useRef","initialDemoData","setInitialDemoData","demoDataProcessedRef","gaMeasurementId","consentCookieName","hasConsent","setHasConsent","hasDemoData","sessionStorage","hasFormCache","log","hadDemoData","hadFormCache","Cookies","get","current","demoDataString","parsedDemoData","isDemo","handleDemoDataApplied","useCallback","GoogleAnalytics","gaId","h1","Loader2","maxWidth","data-loaded","opacity","Suspense","fallback","onCalculateAction","formData","displayError","baseErrorTitle","Error","stringifiedError","setTimeout","requestAnimationFrame","scrollIntoView","behavior","block","onDemoDataApplied","ref","Terminal","safeText","DialogPrimitive","DialogPortal","DialogClose","DialogOverlay","isMountedRef","mountTimer","clearTimeout","XIcon","DialogDescription","SelectPrimitive","data-size","position","SelectScrollUpButton","SelectScrollDownButton","key","restProps","CheckIcon","ChevronUpIcon","ForwardedInput","helperText","errorId","input","LabelPrimitive"],"sourceRoot":""}