@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

/* Updated color palette based on the branding guide */
:root {
  --radius: 0.5rem; /* 8px border-radius as per design style */
  --background: 0 0% 100%;
  --foreground: 222.2 84% 4.9%;
  --card: 0 0% 100%;
  --card-foreground: 222.2 84% 4.9%;
  --popover: 0 0% 100%;
  --popover-foreground: 222.2 84% 4.9%;
  --primary: 222.2 47.4% 11.2%;
  --primary-foreground: 210 40% 98%;
  --secondary: 210 40% 96.1%;
  --secondary-foreground: 222.2 47.4% 11.2%;
  --muted: 210 40% 96.1%;
  --muted-foreground: 215.4 16.3% 46.9%;
  --accent: #2e5a8c; /* Primary Blue with reduced opacity for accents */
  --accent-foreground: #111827;
  --destructive: #ef4444; /* Error Red */
  --destructive-foreground: #ffffff;
  --border: #e5e7eb; /* Border/Divider */
  --input: #f3f4f6; /* Input Field Background */
  --ring: #2e5a8c; /* Primary Blue for focus rings */

  /* Base Chart Colors */
  --chart-1: #2e5a8c;
  --chart-2: #f5a623;
  --chart-3: #22c55e;
  --chart-4: #5a6271; /* Adjusted */
  --chart-5: #ef4444;

  /* Colorblind-Safe Chart Colors */
  --colorblind-1: #1b9e77;
  --colorblind-2: #d95f02;
  --colorblind-3: #7570b3;
  --colorblind-4: #e7298a;
  --colorblind-5: #66a61e;
  --colorblind-6: #e6ab02;
  --colorblind-7: #a6761d;

  /* Sidebar Colors */
  --sidebar: #ffffff;
  --sidebar-foreground: #374151;
  --sidebar-primary: #2e5a8c;
  --sidebar-primary-foreground: #ffffff;
  --sidebar-accent: #f9fafb;
  --sidebar-accent-foreground: #2e5a8c;
  --sidebar-border: #e5e7eb;
  --sidebar-ring: #2e5a8c;

  --pulse-highlight-color: rgba(74, 144, 226, 0.12);

  /* Added scrollbar width variable */
  --scrollbar-width: 0px;

  /* Custom primary color for legal pages */
  --legal-primary: 201 98% 39%; /* #0284C7 */
}

/* Prevent layout shifts due to scrollbar appearing/disappearing */
html {
  scrollbar-gutter: stable;
  overflow-y: scroll !important; /* Force consistent scrollbar with !important */
  overflow-x: hidden !important; /* Prevent horizontal scrolling with !important */
  overflow-anchor: none; /* Prevent scroll jumps during content updates */
  width: 100%; /* Fix width to prevent layout shifts */
}

/* Style for when the scrollbar needs to be preserved during modals */
html.prevent-scrollbar-shift {
  overflow-y: scroll !important;
  padding-right: 0 !important; /* Prevent automatic padding */
  margin-right: calc(var(--scrollbar-width) * -1) !important; /* Negative margin to compensate */
}

/* For browsers that don't support scrollbar-gutter */
@supports not (scrollbar-gutter: stable) {
html {
  overflow-y: scroll;
    overflow-x: hidden; /* Added to prevent horizontal scrolling */
  }
  
  /* When modal is open, prevent layout shifts */
  html.prevent-scrollbar-shift body {
    position: relative;
  }
}

/* Dark mode colors updated to match the branding */
.dark {
  --background: #121212;
  --foreground: #f9fafb;
  --card: #1e1e1e;
  --card-foreground: #d1d5db;
  --popover: #1e1e1e;
  --popover-foreground: #d1d5db;
  --primary: #4a90e2;
  --primary-foreground: #ffffff;
  --secondary: #f5a623;
  --secondary-foreground: #121212;
  --muted: #2a2a2a;
  --muted-foreground: #9ca3af; /* Original dark mode value is fine */
  --accent: #4a90e2;
  --accent-foreground: #ffffff;
  --destructive: #f87171;
  --destructive-foreground: #ffffff;
  --border: #3a3a3a;
  --input: #2a2a2a;
  --ring: #4a90e2;

  /* Base Chart Colors (Dark) */
  --chart-1: #4a90e2;
  --chart-2: #f5a623;
  --chart-3: #22c55e;
  --chart-4: #9ca3af;
  --chart-5: #f87171;

  /* Colorblind-Safe Chart Colors (Can be same as light if contrast is sufficient) */
  --colorblind-1: #1b9e77;
  --colorblind-2: #d95f02;
  --colorblind-3: #7570b3;
  --colorblind-4: #e7298a;
  --colorblind-5: #66a61e;
  --colorblind-6: #e6ab02;
  --colorblind-7: #a6761d;

  /* Sidebar Colors (Dark) */
  --sidebar: #1e1e1e;
  --sidebar-foreground: #d1d5db;
  --sidebar-primary: #4a90e2;
  --sidebar-primary-foreground: #ffffff;
  --sidebar-accent: #2a2a2a;
  --sidebar-accent-foreground: #ffffff;
  --sidebar-border: #3a3a3a;
  --sidebar-ring: #4a90e2;

  --pulse-highlight-color: rgba(74, 144, 226, 0.12);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
    max-width: 100%; /* Ensure no element exceeds its container width */
  }
  body {
    @apply bg-background text-foreground font-sans antialiased;
    font-family: "Roboto", sans-serif;
    font-size: 16px;
    line-height: 1.4;
    overflow-x: hidden; /* Prevent horizontal scrolling at body level */
    width: 100%; /* Ensure body takes exactly viewport width */
    isolation: isolate; /* Create a new stacking context */
  }

  h1 {
    font-size: clamp(2.25rem, 1.5rem + 2vw, 2.5rem); /* Fluid typography */
    font-weight: 700;
    line-height: 1.2;
  }

  h2 {
    font-size: clamp(1.75rem, 1.25rem + 1.5vw, 2rem); /* Fluid typography */
    font-weight: 600;
    line-height: 1.25;
  }

  h3 {
    font-size: clamp(1.25rem, 1rem + 0.75vw, 1.5rem); /* Fluid typography */
    font-weight: 500;
    line-height: 1.3;
  }

  /* Hide arrows from number inputs */
  /* Chrome, Safari, Edge, Opera */
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  /* Firefox */
  input[type="number"] {
    -moz-appearance: textfield;
  }
}

/* Global input styles */
input,
select,
textarea {
  @apply w-full rounded-lg border-input py-2 px-3 shadow-sm;
  background-color: var(--input);
  color: var(--foreground);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
}

input:focus,
select:focus,
textarea:focus {
  @apply border-primary ring-2 ring-primary/20 outline-none;
}

.input-helper-text {
  @apply text-xs text-muted-foreground mt-1;
}

/* Animation for user interface elements */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fadeIn {
  animation: fadeIn 0.5s ease-out forwards;
}

/* Add a pulse-highlight animation for results section */
@keyframes pulseHighlight {
  0% {
    background-color: transparent;
  }
  30% {
    background-color: rgba(46, 90, 140, 0.08);
  } /* Light mode primary with opacity */
  100% {
    background-color: transparent;
  }
}

.pulse-highlight {
  animation: pulseHighlight 1.2s ease-out;
  border-radius: 0.5rem;
  background-color: transparent;
}

.dark .pulse-highlight {
  animation-name: darkPulseHighlight;
}

@keyframes darkPulseHighlight {
  0% {
    background-color: transparent;
  }
  30% {
    background-color: rgba(74, 144, 226, 0.12);
  } /* Dark mode primary with opacity */
  100% {
    background-color: transparent;
  }
}

/* Add proportilon highlight styles as specified in the branding guide */
.proportion-highlight {
  background-color: rgba(
    46,
    90,
    140,
    0.1
  ); /* Proportion Highlight Background in light mode */
  color: #2e5a8c; /* Proportion Text in light mode */
  border-radius: 0.25rem;
  padding: 0.25rem 0.5rem;
}

.dark .proportion-highlight {
  background-color: rgba(
    74,
    144,
    226,
    0.2
  ); /* Proportion Highlight Background in dark mode */
  color: #ffffff; /* Proportion Text in dark mode */
}

/* Result reveal animation */
@keyframes resultReveal {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Success glow animation for the submit button */
@keyframes successGlow {
  0% {
    box-shadow: 0 0 0 rgba(34, 197, 94, 0);
  } /* Success Green with 0 opacity */
  50% {
    box-shadow: 0 0 12px rgba(34, 197, 94, 0.8);
  } /* Success Green with high opacity */
  100% {
    box-shadow: 0 0 0 rgba(34, 197, 94, 0);
  } /* Success Green with 0 opacity */
}

/* Success glow animation for the result card */
@keyframes resultSuccessGlow {
  0% {
    box-shadow: 0 0 2px rgba(46, 90, 140, 0.1);
  } /* Primary Blue with low opacity */
  40% {
    box-shadow: 0 0 15px rgba(46, 90, 140, 0.3);
  } /* Primary Blue with medium opacity */
  100% {
    box-shadow: 0 0 2px rgba(46, 90, 140, 0.1);
  } /* Primary Blue with low opacity */
}

@keyframes darkResultSuccessGlow {
  0% {
    box-shadow: 0 0 2px rgba(74, 144, 226, 0.1);
  } /* Dark mode Primary Blue with low opacity */
  40% {
    box-shadow: 0 0 15px rgba(74, 144, 226, 0.3);
  } /* Dark mode Primary Blue with medium opacity */
  100% {
    box-shadow: 0 0 2px rgba(74, 144, 226, 0.1);
  } /* Dark mode Primary Blue with low opacity */
}

.animate-success-glow {
  animation: successGlow 1.5s ease-in-out;
}

.animate-result-reveal {
  animation: resultReveal 0.4s ease-in-out;
  animation-fill-mode: backwards;
  animation-delay: 200ms; /* Small delay before showing results */
}

.animate-result-glow {
  animation: resultSuccessGlow 3s ease-out forwards;
}

.dark .animate-result-glow {
  animation-name: darkResultSuccessGlow;
}

/* Premium button hover effects */
button:not(:disabled),
.button:not(:disabled) {
  transition:
    transform 0.2s ease,
    box-shadow 0.2s ease,
    background-color 0.2s ease,
    opacity 0.2s ease;
}

button:not(:disabled):hover,
.button:not(:disabled):hover,
[role="button"]:not(:disabled):hover,
input[type="submit"]:not(:disabled):hover,
input[type="button"]:not(:disabled):hover {
  transform: none !important;
}

/* Premium button gradient for special actions */
.premium-button {
  background: linear-gradient(
    to right,
    var(--primary),
    color-mix(in srgb, var(--primary) 80%, var(--secondary))
  );
  color: white;
  border: none;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.premium-button:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.dark .premium-button {
  background: linear-gradient(
    to right,
    var(--primary),
    color-mix(in srgb, var(--primary) 70%, var(--secondary))
  );
}

/* Custom tooltip styles */
.premium-tooltip {
  position: relative;
}

.premium-tooltip::before {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  padding: 6px 12px;
  border-radius: 6px;
  background-color: var(--popover);
  color: var(--popover-foreground);
  text-align: center;
  font-size: 0.875rem;
  white-space: nowrap;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  opacity: 0;
  visibility: hidden;
  transition:
    opacity 0.2s,
    visibility 0.2s;
  z-index: 1000;
  pointer-events: none;
  border: 1px solid var(--border);
}

.premium-tooltip::after {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  border-width: 5px;
  border-style: solid;
  border-color: #333 transparent transparent transparent;
  opacity: 0;
  visibility: hidden;
  transition:
    opacity 0.3s ease,
    visibility 0s linear 0.3s;
  z-index: 100;
  pointer-events: none;
}

.premium-tooltip:hover::before,
.premium-tooltip:hover::after {
  opacity: 1;
  visibility: visible;
  transition-delay: 200ms; /* Small delay before showing tooltip */
  transform: translateX(-50%) translateY(0);
}

/* Parallax background effect for desktop */
@media (min-width: 1024px) {
  .parallax-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    z-index: -1;
    background: linear-gradient(
      to bottom,
      rgba(46, 90, 140, 0.05),
      rgba(255, 255, 255, 0)
    );
    transform: translateY(0);
    will-change: transform;
  }
}

/* Add scale animation for buttons and inputs */
@keyframes scaleIn {
  from {
    transform: scale(1);
  }
  to {
    transform: scale(1.03);
  }
}

/* Add transitions for smooth theme switching */
html {
  transition:
    background-color 0.5s,
    color 0.5s;
}

body * {
  transition-property:
    /* background-color, */ border-color, color, fill, stroke, opacity, box-shadow,
    /* transform, */ filter, backdrop-filter;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 0.15s;
}

/* Overrides for react-cookie-consent buttons */
#rcc-confirm-button {
  background-color: #2e5a8c !important; /* Primary Blue */
  color: white !important;
  border: 1px solid hsl(var(--border)) !important;
  padding: 0.5rem 0.75rem !important;
  border-radius: var(--radius) !important;
  font-size: 13px !important;
  margin: 0 !important;
  cursor: pointer !important;
  transition: none !important;
}

#rcc-confirm-button:hover {
  background-color: rgba(
    46,
    90,
    140,
    0.9
  ) !important; /* Slightly lighter Primary Blue */
}

#rcc-decline-button {
  background-color: transparent !important;
  color: hsl(var(--secondary-foreground)) !important;
  border: none !important;
  padding: 0 !important;
  margin: 0 0 0 0.5rem !important;
  font-size: 13px !important;
  text-decoration: none !important;
  cursor: pointer !important;
}

#rcc-decline-button:hover {
  text-decoration: underline !important;
}

/* Reduced Motion Helper */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 1ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 1ms !important;
    scroll-behavior: auto !important;
    transition-delay: 0ms !important;
  }
}

/* PrivacyBee Widget Light Mode Overrides REMOVED - Trying data-theme attribute instead */
/*
html:not(.dark) privacybee-widget {
    // ... removed overrides ...
}
*/

/* Add smoother transitions globally */
* {
  transition-property: background-color, border-color, color, fill, stroke, opacity, box-shadow, transform;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

/* Add fade-in animation */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fadeIn {
  animation: fadeIn 0.4s ease-out forwards;
}

/* Add staggered fade-in for lists */
@keyframes staggeredFadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.staggered-item {
  animation: staggeredFadeIn 0.4s ease-out forwards;
  opacity: 0;
}

/* Prevent flashing during theme changes */
html.transitioning * {
  transition: none !important;
}

/* Add padding to account for fixed header - Handled by inner div padding */
body {
  /* padding-top: 4rem; */ /* Remove, will be added to inner div */
  overflow-x: hidden; /* Restore to prevent potential layout shifts during scroll/interaction */
  /* overflow-y: scroll; */ /* Add scroll rule here - MOVED TO @layer base */
}

/* Prevent layout shifts during theme changes */
html.transitioning {
  overflow-y: scroll !important; /* Force scrollbar to remain visible */
}

/* Ensure fixed elements stay in place during transitions */
.fixed {
  transform: translateZ(0); /* Force GPU acceleration for fixed elements */
  will-change: transform; /* Hint to browser about upcoming changes */
  backface-visibility: hidden; /* Prevent flickering in some browsers */
}

/* Improve header appearance during scrolling */
header.fixed {
  transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
}

/* Ensure text elements don't display text editor cursor */
p, h1, h2, h3, h4, h5, h6, span, div:not([contenteditable="true"]), li, a:not([href]), section, header, footer {
  cursor: default !important;
}
/* Interactive elements should maintain their appropriate cursor */
a[href], button, [role="button"], input[type="submit"], input[type="button"], .cursor-pointer {
  cursor: pointer !important;
}
/* Input elements should show text cursor */
input[type="text"], input[type="number"], input[type="email"], input[type="password"], textarea, [contenteditable="true"] {
  cursor: text !important;
}

/* Ensure sticky header works consistently - REMOVED as Tailwind class is sufficient */
/*
header.sticky {
  position: sticky;
  top: 0;
  z-index: 9999;
  will-change: transform; 
}
*/

/* Add dropdown menu containment to prevent scrollbar issues */
[data-radix-popper-content-wrapper] {
  overflow: hidden !important;
  contain: content !important;
  overscroll-behavior: contain !important;
  max-height: 100vh !important;
  pointer-events: auto !important;
  z-index: 1000 !important;
}

/* Ensure all dropdown menus have proper overflow behavior */
.dropdown-menu-content,
[role="menu"],
[data-state="open"],
[data-radix-popper-content] {
  max-height: calc(100vh - 10px) !important;
  overscroll-behavior: contain !important;
  pointer-events: auto !important;
  z-index: 1000 !important;
}

/* Prevent any portals from affecting document flow */
[data-radix-portal] {
  overflow: visible !important;
  z-index: 1000 !important;
}

/* Force dropdown positioning to fixed to prevent reflow */
.dropdown-menu-content[data-state="open"],
.dropdown-content[data-state="open"],
[role="dialog"],
[role="menu"] {
}

/* Reset overflow on body and html to ensure no double scrollbars */
html, body {
  max-width: 100vw !important;
  overscroll-behavior: none !important;
}

/* Ensure fixed/absolute positioned elements follow proper stacking */
.fixed,
.absolute,
[data-radix-popper-content-wrapper] {
  z-index: 100; /* Higher z-index for popups/dropdowns */
  transform: translateZ(0);
  will-change: transform; /* Hint to browser about upcoming changes */
}

/* Attempt to hide the duplicated title and last updated text from PrivacyBee widget */
/* This assumes the widget renders an h1 followed immediately by a p for these elements, possibly nested within a div. */
privacybee-widget div > h1,
privacybee-widget div > h1 + p {
  display: none !important;
}
